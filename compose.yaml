services:
  # Outlet Application (self-contained with SQLite)
  app:
    build:
      context: .
      dockerfile: Dockerfile
      target: development
    container_name: outlet_app
    restart: unless-stopped
    ports:
      - "20202:8888"
    env_file:
      - .env
    volumes:
      - .:/app
      - /app/tmp
      - /app/app/node_modules
      # External mount for SQLite database (outside Docker network)
      - ./data:/app/data
    environment:
      NODE_ENV: development
      BODY_SIZE_LIMIT: 0
      ORIGIN: ${ORIGIN:-http://localhost:8888}
    healthcheck:
      test:
        ["CMD", "wget", "-q", "-O", "/dev/null", "http://localhost:8888/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s
