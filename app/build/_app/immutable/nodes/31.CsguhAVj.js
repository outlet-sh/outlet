import"../chunks/Bzak7iHL.js";import{f as P,c as o,r,p as pt,d as T,j as Le,u as mt,b as i,a as _t,s as l,g as e,n as C,e as ne,t as N,a9 as ht}from"../chunks/Ip2DykXx.js";import{s as k}from"../chunks/DhOIAuLg.js";import{c as H,a as s,f as u,t as O}from"../chunks/BPgbRZ5o.js";import{l as De,s as Te,i as z}from"../chunks/BeCi3WIf.js";import{e as fe,i as pe}from"../chunks/-0-Kn73z.js";import{s as $t}from"../chunks/CmyOW3uE.js";import{U as gt,V as bt,W as yt,X as xt,Y as kt,Z as Pt}from"../chunks/CtwFYI68.js";import{B as j,M as Fe,I as Ve,b as Xe,A as Me,C as Ye}from"../chunks/Bphptf_a.js";import{L as qe}from"../chunks/sFH_xjRy.js";import{s as Ct}from"../chunks/BCZnC23Z.js";import{B as me}from"../chunks/CK6k7lQK.js";import{P as Ze}from"../chunks/C0D2ZjIj.js";import{C as wt}from"../chunks/C65kbecp.js";import{C as Wt}from"../chunks/Dx9qyz7C.js";import{I as Ae,X as St}from"../chunks/CYeJYM_Q.js";import"../chunks/hUurZXsg.js";import{s as Ne}from"../chunks/Df8mRDld.js";import{R as zt}from"../chunks/CQK8yWuM.js";import{T as Et}from"../chunks/Boqopfmd.js";function Lt(Y,A){const E=De(A,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.522.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const $=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143"}],["path",{d:"m2 2 20 20"}]];Ae(Y,Te({name:"eye-off"},()=>E,{get iconNode(){return $},children:(R,q)=>{var L=H(),B=P(L);Ne(B,A,"default",{}),s(R,L)},$$slots:{default:!0}}))}function Ge(Y,A){const E=De(A,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.522.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const $=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["circle",{cx:"12",cy:"12",r:"3"}]];Ae(Y,Te({name:"eye"},()=>E,{get iconNode(){return $},children:(R,q)=>{var L=H(),B=P(L);Ne(B,A,"default",{}),s(R,L)},$$slots:{default:!0}}))}function Ft(Y,A){const E=De(A,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.522.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const $=[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2"}],["path",{d:"M8.5 2h7"}],["path",{d:"M14.5 16h-5"}]];Ae(Y,Te({name:"test-tube"},()=>E,{get iconNode(){return $},children:(R,q)=>{var L=H(),B=P(L);Ne(B,A,"default",{}),s(R,L)},$$slots:{default:!0}}))}var Mt=u('<div class="table-container svelte-1i9hzo7"><table class="table svelte-1i9hzo7"><!></table></div>');function He(Y,A){var E=Mt(),$=o(E),R=o($);Ct(R,()=>A.children),r($),r(E),s(Y,E)}var Dt=u("<!> Add Webhook",1),Tt=u('<div class="flex justify-center py-12"><!></div>'),At=u("<!> Add Your First Webhook",1),Nt=u('<p class="text-text-muted">No webhooks configured yet.</p> <!>',1),Ot=u('<tr><td class="font-mono text-sm max-w-xs truncate"> </td><td><div class="flex flex-wrap gap-1"><!> <!></div></td><td><!></td><td><div class="text-sm"><span class="text-green-600"> </span> <span class="text-text-muted">/</span> <span class="text-red-600"> </span></div></td><td class="text-sm text-text-muted"> </td><td><div class="flex items-center justify-end gap-2"><!> <!> <!> <!></div></td></tr>'),Rt=u('<thead><tr><th>URL</th><th>Events</th><th>Status</th><th>Deliveries</th><th>Last Delivery</th><th class="text-right">Actions</th></tr></thead> <tbody></tbody>',1),Ut=u('<p class="mt-1 text-sm"> </p>'),jt=u("<strong> </strong> <!> <!>",1),Bt=u('<div class="flex justify-end gap-3"><!> <!></div>'),It=u('<div><h4 class="text-sm font-medium text-text-muted mb-2"> </h4> <div class="space-y-2 pl-2"></div></div>'),Vt=u('<div class="space-y-4"><div><label class="form-label" for="webhook-url">Endpoint URL</label> <!></div> <div><label class="form-label">Events to Subscribe</label> <div class="mt-2 space-y-4 max-h-64 overflow-y-auto"></div></div> <div><!></div></div>'),Xt=u('<div class="space-y-4"><!> <div><label class="form-label">Signing Secret</label> <div class="flex gap-2"><!> <!></div> <p class="mt-2 text-sm text-text-muted">Use this secret to verify that webhook payloads are from Outlet. Check the <code>X-Webhook-Signature</code> header.</p></div></div>'),Yt=u('<div class="flex justify-center py-8"><!></div>'),qt=u('<p class="text-center text-text-muted py-8">No delivery logs yet.</p>'),Zt=u('<span class="flex items-center gap-1 text-green-600"><!> </span>'),Gt=u('<span class="flex items-center gap-1 text-red-600"><!> Error</span>'),Ht=u('<span class="text-red-600"> </span>'),Jt=u('<tr><td><!></td><td><!></td><td class="text-sm text-text-muted"> </td><td class="text-sm text-text-muted"> </td></tr>'),Kt=u("<thead><tr><th>Event</th><th>Status</th><th>Duration</th><th>Time</th></tr></thead> <tbody></tbody>",1),Qt=u('<div class="max-h-96 overflow-y-auto"><!></div>'),ea=u('<div class="space-y-6"><div class="flex items-center justify-between"><div><h2 class="text-lg font-medium text-text">Webhooks</h2> <p class="mt-1 text-sm text-text-muted">Receive real-time notifications when events happen in your account.</p></div> <!></div> <!> <!> <!></div> <!> <!> <!>',1);function ya(Y,A){pt(A,!0);let E=T(!0),$=T(""),R=T(Le([])),q=T(!1),L=T(!1),B=T(!1),b=T(Le({url:"",events:[],active:!0})),ye=T(""),Je=T(""),_e=T(Le([])),xe=T(!1),he=T(null),U=T(null);const Ke=[{value:"checkout.completed",label:"Checkout Completed",category:"Orders"},{value:"order.created",label:"Order Created",category:"Orders"},{value:"order.completed",label:"Order Completed",category:"Orders"},{value:"payment.succeeded",label:"Payment Succeeded",category:"Payments"},{value:"payment.failed",label:"Payment Failed",category:"Payments"},{value:"refund.created",label:"Refund Created",category:"Payments"},{value:"subscription.created",label:"Subscription Created",category:"Subscriptions"},{value:"subscription.updated",label:"Subscription Updated",category:"Subscriptions"},{value:"subscription.canceled",label:"Subscription Canceled",category:"Subscriptions"},{value:"subscription.renewed",label:"Subscription Renewed",category:"Subscriptions"},{value:"customer.created",label:"Customer Created",category:"Customers"},{value:"customer.updated",label:"Customer Updated",category:"Customers"},{value:"contact.created",label:"Contact Created",category:"Contacts"},{value:"contact.unsubscribed",label:"Contact Unsubscribed",category:"Contacts"},{value:"email.sent",label:"Email Sent",category:"Email"},{value:"email.bounced",label:"Email Bounced",category:"Email"},{value:"email.opened",label:"Email Opened",category:"Email"},{value:"email.clicked",label:"Email Clicked",category:"Email"}];let Qe=ne(()=>()=>{const t={};for(const a of Ke)t[a.category]||(t[a.category]=[]),t[a.category].push(a);return t});mt(()=>{$e()});async function $e(){i(E,!0),i($,"");try{const t=await gt();i(R,t.webhooks||[],!0)}catch(t){console.error("Failed to load webhooks:",t),i($,t.message||"Failed to load webhooks",!0)}finally{i(E,!1)}}async function et(){if(!e(b).url||e(b).events.length===0){i($,"URL and at least one event are required");return}try{const t=await bt({url:e(b).url,events:e(b).events,active:e(b).active});i(ye,t.secret,!0),i(q,!1),i(B,!0),i(b,{url:"",events:[],active:!0},!0),await $e()}catch(t){console.error("Failed to create webhook:",t),i($,t.message||"Failed to create webhook",!0)}}async function tt(t){try{await kt({},{active:!t.active},t.id),await $e()}catch(a){console.error("Failed to update webhook:",a),i($,a.message||"Failed to update webhook",!0)}}async function at(t){if(confirm("Are you sure you want to delete this webhook?"))try{await Pt({},t),await $e()}catch(a){console.error("Failed to delete webhook:",a),i($,a.message||"Failed to delete webhook",!0)}}async function rt(t){i(he,t,!0),i(U,null);try{i(U,await xt({},t),!0)}catch(a){console.error("Failed to test webhook:",a),i(U,{success:!1,status_code:0,error:a.message||"Test failed"},!0)}finally{i(he,null)}}async function st(t){i(Je,t,!0),i(xe,!0),i(L,!0),i(_e,[],!0);try{const a=await yt({limit:50},t);i(_e,a.logs||[],!0)}catch(a){console.error("Failed to load webhook logs:",a)}finally{i(xe,!1)}}function ot(t){e(b).events.indexOf(t)===-1?e(b).events=[...e(b).events,t]:e(b).events=e(b).events.filter(c=>c!==t)}function lt(){navigator.clipboard.writeText(e(ye))}function Oe(t){return t?new Date(t).toLocaleString():"Never"}var Re=ea(),ke=P(Re),Pe=o(ke),it=l(o(Pe),2);j(it,{onclick:()=>i(q,!0),children:(t,a)=>{var c=Dt(),d=P(c);Ze(d,{size:16,class:"mr-2"}),C(),s(t,c)},$$slots:{default:!0}}),r(Pe);var Ue=l(Pe,2);{var nt=t=>{Me(t,{variant:"error",children:(a,c)=>{C();var d=O();N(()=>k(d,e($))),s(a,d)},$$slots:{default:!0}})};z(Ue,t=>{e($)&&t(nt)})}var je=l(Ue,2);{var dt=t=>{var a=Tt(),c=o(a);qe(c,{size:"lg"}),r(a),s(t,a)},ct=t=>{var a=H(),c=P(a);{var d=f=>{Ye(f,{class:"py-12 text-center",children:(y,p)=>{var h=Nt(),w=l(P(h),2);j(w,{class:"mt-4",onclick:()=>i(q,!0),children:(x,g)=>{var m=At(),n=P(m);Ze(n,{size:16,class:"mr-2"}),C(),s(x,m)},$$slots:{default:!0}}),s(y,h)},$$slots:{default:!0}})},_=f=>{Ye(f,{children:(y,p)=>{He(y,{children:(h,w)=>{var x=Rt(),g=l(P(x),2);fe(g,21,()=>e(R),pe,(m,n)=>{var Q=Ot(),I=o(Q),re=o(I,!0);r(I);var J=l(I),K=o(J),se=o(K);fe(se,17,()=>e(n).events.slice(0,2),pe,(v,F)=>{me(v,{variant:"secondary",class:"text-xs",children:(le,M)=>{C();var ie=O();N(()=>k(ie,e(F))),s(le,ie)},$$slots:{default:!0}})});var W=l(se,2);{var ee=v=>{me(v,{variant:"secondary",class:"text-xs",children:(F,le)=>{C();var M=O();N(()=>k(M,`+${e(n).events.length-2} more`)),s(F,M)},$$slots:{default:!0}})};z(W,v=>{e(n).events.length>2&&v(ee)})}r(K),r(J);var te=l(J),Ce=o(te);{var de=v=>{me(v,{variant:"success",children:(F,le)=>{C();var M=O("Active");s(F,M)},$$slots:{default:!0}})},we=v=>{me(v,{variant:"secondary",children:(F,le)=>{C();var M=O("Inactive");s(F,M)},$$slots:{default:!0}})};z(Ce,v=>{e(n).active?v(de):v(we,!1)})}r(te);var ce=l(te),ge=o(ce),ae=o(ge),We=o(ae,!0);r(ae);var ve=l(ae,4),Se=o(ve,!0);r(ve),r(ge),r(ce);var S=l(ce),Z=o(S,!0);r(S);var V=l(S),oe=o(V),be=o(oe);j(be,{variant:"ghost",size:"sm",onclick:()=>st(e(n).id),title:"View Logs",children:(v,F)=>{Ge(v,{size:16})},$$slots:{default:!0}});var G=l(be,2);{let v=ne(()=>e(he)===e(n).id);j(G,{variant:"ghost",size:"sm",onclick:()=>rt(e(n).id),get disabled(){return e(v)},title:"Test Webhook",children:(F,le)=>{var M=H(),ie=P(M);{var ze=D=>{zt(D,{size:16,class:"animate-spin"})},Ee=D=>{Ft(D,{size:16})};z(ie,D=>{e(he)===e(n).id?D(ze):D(Ee,!1)})}s(F,M)},$$slots:{default:!0}})}var X=l(G,2);{let v=ne(()=>e(n).active?"Disable":"Enable");j(X,{variant:"ghost",size:"sm",onclick:()=>tt(e(n)),get title(){return e(v)},children:(F,le)=>{var M=H(),ie=P(M);{var ze=D=>{Lt(D,{size:16})},Ee=D=>{Ge(D,{size:16})};z(ie,D=>{e(n).active?D(ze):D(Ee,!1)})}s(F,M)},$$slots:{default:!0}})}var ue=l(X,2);j(ue,{variant:"ghost",size:"sm",class:"text-red-600 hover:text-red-700",onclick:()=>at(e(n).id),title:"Delete",children:(v,F)=>{Et(v,{size:16})},$$slots:{default:!0}}),r(oe),r(V),r(Q),N(v=>{$t(I,"title",e(n).url),k(re,e(n).url),k(We,e(n).deliveries_success||0),k(Se,e(n).deliveries_failed||0),k(Z,v)},[()=>Oe(e(n).last_delivery_at)]),s(m,Q)}),r(g),s(h,x)}})},$$slots:{default:!0}})};z(c,f=>{e(R).length===0?f(d):f(_,!1)},!0)}s(t,a)};z(je,t=>{e(E)?t(dt):t(ct,!1)})}var vt=l(je,2);{var ut=t=>{{let a=ne(()=>e(U).success?"success":"error");Me(t,{get variant(){return e(a)},dismissable:!0,onclose:()=>i(U,null),children:(c,d)=>{var _=jt(),f=P(_),y=o(f);r(f);var p=l(f,2);{var h=g=>{var m=O();N(()=>k(m,`- Status: ${e(U).status_code??""}`)),s(g,m)};z(p,g=>{e(U).status_code&&g(h)})}var w=l(p,2);{var x=g=>{var m=Ut(),n=o(m,!0);r(m),N(()=>k(n,e(U).error)),s(g,m)};z(w,g=>{e(U).error&&g(x)})}N(()=>k(y,`Test ${e(U).success?"Successful":"Failed"}`)),s(c,_)},$$slots:{default:!0}})}};z(vt,t=>{e(U)&&t(ut)})}r(ke);var Be=l(ke,2);Fe(Be,{title:"Add Webhook",get open(){return e(q)},set open(a){i(q,a,!0)},footer:a=>{var c=Bt(),d=o(c);j(d,{variant:"secondary",onclick:()=>i(q,!1),children:(f,y)=>{C();var p=O("Cancel");s(f,p)},$$slots:{default:!0}});var _=l(d,2);j(_,{onclick:et,children:(f,y)=>{C();var p=O("Create Webhook");s(f,p)},$$slots:{default:!0}}),r(c),s(a,c)},children:(a,c)=>{var d=Vt(),_=o(d),f=l(o(_),2);Ve(f,{id:"webhook-url",type:"url",placeholder:"https://your-server.com/webhook",get value(){return e(b).url},set value(x){e(b).url=x}}),r(_);var y=l(_,2),p=l(o(y),2);fe(p,21,()=>Object.entries(e(Qe)()),pe,(x,g)=>{var m=ne(()=>ht(e(g),2));let n=()=>e(m)[0],Q=()=>e(m)[1];var I=It(),re=o(I),J=o(re,!0);r(re);var K=l(re,2);fe(K,21,Q,pe,(se,W)=>{{let ee=ne(()=>e(b).events.includes(e(W).value));Xe(se,{get label(){return e(W).label},get checked(){return e(ee)},onchange:()=>ot(e(W).value)})}}),r(K),r(I),N(()=>k(J,n())),s(x,I)}),r(p),r(y);var h=l(y,2),w=o(h);Xe(w,{label:"Active",get checked(){return e(b).active},set checked(x){e(b).active=x}}),r(h),r(d),s(a,d)},$$slots:{footer:!0,default:!0}});var Ie=l(Be,2);Fe(Ie,{title:"Webhook Created",get open(){return e(B)},set open(a){i(B,a,!0)},footer:a=>{j(a,{onclick:()=>i(B,!1),children:(c,d)=>{C();var _=O("Done");s(c,_)},$$slots:{default:!0}})},children:(a,c)=>{var d=Xt(),_=o(d);Me(_,{variant:"warning",children:(w,x)=>{C();var g=O("Save this secret now. You won't be able to see it again.");s(w,g)},$$slots:{default:!0}});var f=l(_,2),y=l(o(f),2),p=o(y);Ve(p,{get value(){return e(ye)},readonly:!0,class:"font-mono text-sm"});var h=l(p,2);j(h,{variant:"secondary",onclick:lt,children:(w,x)=>{wt(w,{size:16})},$$slots:{default:!0}}),r(y),C(2),r(f),r(d),s(a,d)},$$slots:{footer:!0,default:!0}});var ft=l(Ie,2);Fe(ft,{title:"Webhook Delivery Logs",size:"lg",get open(){return e(L)},set open(a){i(L,a,!0)},footer:a=>{j(a,{variant:"secondary",onclick:()=>i(L,!1),children:(c,d)=>{C();var _=O("Close");s(c,_)},$$slots:{default:!0}})},children:(a,c)=>{var d=H(),_=P(d);{var f=p=>{var h=Yt(),w=o(h);qe(w,{}),r(h),s(p,h)},y=p=>{var h=H(),w=P(h);{var x=m=>{var n=qt();s(m,n)},g=m=>{var n=Qt(),Q=o(n);He(Q,{children:(I,re)=>{var J=Kt(),K=l(P(J),2);fe(K,21,()=>e(_e),pe,(se,W)=>{var ee=Jt(),te=o(ee),Ce=o(te);me(Ce,{variant:"secondary",children:(S,Z)=>{C();var V=O();N(()=>k(V,e(W).event)),s(S,V)},$$slots:{default:!0}}),r(te);var de=l(te),we=o(de);{var ce=S=>{var Z=Zt(),V=o(Z);Wt(V,{size:14});var oe=l(V);r(Z),N(()=>k(oe,` ${e(W).status_code??""}`)),s(S,Z)},ge=S=>{var Z=H(),V=P(Z);{var oe=G=>{var X=Gt(),ue=o(X);St(ue,{size:14}),C(),r(X),s(G,X)},be=G=>{var X=Ht(),ue=o(X,!0);r(X),N(()=>k(ue,e(W).status_code)),s(G,X)};z(V,G=>{e(W).error?G(oe):G(be,!1)},!0)}s(S,Z)};z(we,S=>{e(W).status_code>=200&&e(W).status_code<300?S(ce):S(ge,!1)})}r(de);var ae=l(de),We=o(ae);r(ae);var ve=l(ae),Se=o(ve,!0);r(ve),r(ee),N(S=>{k(We,`${(e(W).duration||0)??""}ms`),k(Se,S)},[()=>Oe(e(W).delivered_at)]),s(se,ee)}),r(K),s(I,J)}}),r(n),s(m,n)};z(w,m=>{e(_e).length===0?m(x):m(g,!1)},!0)}s(p,h)};z(_,p=>{e(xe)?p(f):p(y,!1)})}s(a,d)},$$slots:{footer:!0,default:!0}}),s(Y,Re),_t()}export{ya as component};
