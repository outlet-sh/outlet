import"../chunks/DsnmJJEf.js";import{p as We,s as _,a as ke,u as Xe,i as e,b as r,d as Ye,e as Ze,c as o,g as et,h as l,r as a,t as J,f as w,n as se,j as oe}from"../chunks/odI--4Kw.js";import{d as tt,s as C}from"../chunks/BNMK9zrr.js";import{a as s,f as d,c as Q,t as le}from"../chunks/CCInJaqd.js";import{i as $,c as at}from"../chunks/COaB7F5h.js";import{e as xe,i as be,a as rt}from"../chunks/BohEjZuL.js";import{h as st}from"../chunks/hUjpWz_l.js";import{s as ot}from"../chunks/DL1yFSKa.js";import"../chunks/B6-rkydZ.js";import{m as lt,n as it,o as dt,p as nt,q as mt,s as ct}from"../chunks/G69xwvxa.js";import{A as vt,C as De,I as ie,B as de,i as Le}from"../chunks/e1pqODLP.js";import{E as Be}from"../chunks/B8XsTm7D.js";import{L as Ee}from"../chunks/D716f0vp.js";import{B as Se}from"../chunks/BD7k7D4N.js";import{M as Ae}from"../chunks/Kinv-oUV.js";import{G as Ce}from"../chunks/Btx-t-vA.js";import{P as Pe}from"../chunks/CjSDCnDk.js";import{T as Re}from"../chunks/CKvKoo0F.js";var ut=d("<p> </p>"),ft=d("<button><!> </button>"),pt=d("<!> Add",1),_t=d('<h2 class="text-lg font-medium text-text mb-4">Add Email to Suppression List</h2> <div class="flex gap-3"><!> <!> <!></div>',1),ht=d('<div class="flex justify-center py-12"><!></div>'),xt=d('<div class="mb-4"><!></div>'),bt=d('<tr><td class="font-medium text-text"> </td><td class="text-text-muted"> </td><td><!></td><td class="text-text-muted text-sm"> </td><td class="text-right"><!></td></tr>'),gt=d('<!> <div class="data-table"><table class="w-full"><thead><tr><th class="text-left">Email</th><th class="text-left">Reason</th><th class="text-left">Source</th><th class="text-left">Added</th><th class="text-right w-10"></th></tr></thead><tbody></tbody></table></div>',1),yt=d("<!> <!>",1),wt=d("<!> Block",1),$t=d('<h2 class="text-lg font-medium text-text mb-4">Block a Domain</h2> <p class="text-sm text-text-muted mb-4">All emails from blocked domains will be rejected. Use this to block spam or competitor domains.</p> <div class="flex gap-3"><!> <!> <!></div>',1),kt=d('<div class="flex justify-center py-12"><!></div>'),Dt=d('<div class="mb-4"><!></div>'),Lt=d('<span class="text-text-muted">0</span>'),Bt=d('<tr><td class="font-medium text-text"> </td><td class="text-text-muted"> </td><td><!></td><td class="text-text-muted text-sm"> </td><td class="text-right"><!></td></tr>'),Et=d('<!> <div class="data-table"><table class="w-full"><thead><tr><th class="text-left">Domain</th><th class="text-left">Reason</th><th class="text-left">Block Attempts</th><th class="text-left">Added</th><th class="text-right w-10"></th></tr></thead><tbody></tbody></table></div>',1),St=d("<!> <!>",1),At=d(`<div class="p-6 max-w-5xl mx-auto"><div class="mb-6"><h1 class="text-2xl font-semibold text-text">Blocklist</h1> <p class="mt-1 text-sm text-text-muted">Manage suppressed emails and blocked domains. Blocked addresses won't receive any emails.</p></div> <!> <div class="border-b border-border mb-6"><nav class="-mb-px flex space-x-8"></nav></div> <!></div>`);function Xt(Fe,ze){We(ze,!0);const[Ct,Me]=ot();let T=_("emails"),V=_(ke([])),ne=_(!0),W=_(""),G=_(""),X=_(""),Y=_(!1),Z=_(ke([])),me=_(!0),ee=_(""),N=_(""),te=_(""),ae=_(!1),F=_(""),je=oe(()=>e(V).filter(t=>t.email.toLowerCase().includes(e(W).toLowerCase())||(t.reason||"").toLowerCase().includes(e(W).toLowerCase()))),Ie=oe(()=>e(Z).filter(t=>t.domain.toLowerCase().includes(e(ee).toLowerCase())||(t.reason||"").toLowerCase().includes(e(ee).toLowerCase())));Xe(()=>{e(T)==="emails"?ce():e(T)==="domains"&&ve()});async function ce(){r(ne,!0);try{const t=await lt({});r(V,t.emails||[],!0)}catch(t){console.error("Failed to load suppressed emails:",t)}finally{r(ne,!1)}}async function ve(){r(me,!0);try{const t=await it({});r(Z,t.domains||[],!0)}catch(t){console.error("Failed to load blocked domains:",t)}finally{r(me,!1)}}async function Te(){if(e(G).trim()){r(Y,!0),r(F,"");try{await dt({email:e(G).trim().toLowerCase(),reason:e(X).trim()||"Manual suppression"}),r(G,""),r(X,""),await ce()}catch(t){r(F,t.message||"Failed to add email to suppression list",!0)}finally{r(Y,!1)}}}async function Ge(t){if(confirm(`Remove ${t.email} from the suppression list?`))try{await mt({},t.id),await ce()}catch(m){r(F,m.message||"Failed to remove email",!0)}}async function Ne(){if(e(N).trim()){r(ae,!0),r(F,"");try{await nt({domain:e(N).trim().toLowerCase(),reason:e(te).trim()||"Manual block"}),r(N,""),r(te,""),await ve()}catch(t){r(F,t.message||"Failed to block domain",!0)}finally{r(ae,!1)}}}async function Ue(t){if(confirm(`Unblock domain ${t.domain}?`))try{await ct({},t.id),await ve()}catch(m){r(F,m.message||"Failed to unblock domain",!0)}}const qe=[{id:"emails",label:"Suppressed Emails",icon:Ae},{id:"domains",label:"Blocked Domains",icon:Ce}];var ue=At();st("1rbsnzh",t=>{Ze(()=>{et.title="Blocklist | Outlet"})});var ge=l(o(ue),2);{var Oe=t=>{vt(t,{type:"error",title:"Error",class:"mb-4",children:(m,k)=>{var E=ut(),P=o(E,!0);a(E),J(()=>C(P,e(F))),s(m,E)},$$slots:{default:!0}})};$(ge,t=>{e(F)&&t(Oe)})}var fe=l(ge,2),ye=o(fe);xe(ye,21,()=>qe,be,(t,m)=>{var k=ft();k.__click=()=>r(T,e(m).id,!0);var E=o(k);at(E,()=>e(m).icon,(U,h)=>{h(U,{class:"h-4 w-4"})});var P=l(E);a(k),J(()=>{rt(k,1,`whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium flex items-center gap-2 ${e(T)===e(m).id?"border-primary text-primary":"border-transparent text-text-muted hover:border-border hover:text-text"}`),C(P,` ${e(m).label??""}`)}),s(t,k)}),a(ye),a(fe);var He=l(fe,2);{var Je=t=>{var m=yt(),k=w(m);De(k,{class:"mb-6",children:(h,R)=>{var z=_t(),q=l(w(z),2),x=o(q);ie(x,{type:"email",placeholder:"email@example.com",class:"flex-1",get value(){return e(G)},set value(b){r(G,b,!0)}});var n=l(x,2);ie(n,{type:"text",placeholder:"Reason (optional)",class:"flex-1",get value(){return e(X)},set value(b){r(X,b,!0)}});var D=l(n,2);{let b=oe(()=>!e(G).trim()||e(Y));de(D,{type:"primary",onclick:Te,get disabled(){return e(b)},children:(M,g)=>{var S=Q(),y=w(S);{var L=i=>{var u=le("Adding...");s(i,u)},v=i=>{var u=pt(),B=w(u);Pe(B,{class:"mr-2 h-4 w-4"}),se(),s(i,u)};$(y,i=>{e(Y)?i(L):i(v,!1)})}s(M,S)},$$slots:{default:!0}})}a(q),s(h,z)},$$slots:{default:!0}});var E=l(k,2);{var P=h=>{var R=ht(),z=o(R);Ee(z,{}),a(R),s(h,R)},U=h=>{var R=Q(),z=w(R);{var q=n=>{Be(n,{get icon(){return Ae},title:"No suppressed emails",message:"Add email addresses that should never receive emails from this brand."})},x=n=>{var D=gt(),b=w(D);{var M=L=>{var v=xt(),i=o(v);Le(i,{placeholder:"Search suppressed emails...",get value(){return e(W)},set value(u){r(W,u,!0)}}),a(v),s(L,v)};$(b,L=>{e(V).length>5&&L(M)})}var g=l(b,2),S=o(g),y=l(o(S));xe(y,21,()=>e(je),be,(L,v)=>{var i=bt(),u=o(i),B=o(u,!0);a(u);var c=l(u),f=o(c,!0);a(c);var p=l(c),K=o(p);Se(K,{variant:"default",size:"sm",children:(I,he)=>{se();var H=le();J(()=>C(H,e(v).source)),s(I,H)},$$slots:{default:!0}}),a(p);var j=l(p),pe=o(j,!0);a(j);var O=l(j),_e=o(O);de(_e,{type:"ghost",size:"sm",onclick:()=>Ge(e(v)),class:"text-text-muted hover:text-error",children:(I,he)=>{Re(I,{class:"h-4 w-4"})},$$slots:{default:!0}}),a(O),a(i),J(I=>{C(B,e(v).email),C(f,e(v).reason||"-"),C(pe,I)},[()=>new Date(e(v).created_at).toLocaleDateString()]),s(L,i)}),a(y),a(S),a(g),s(n,D)};$(z,n=>{e(V).length===0?n(q):n(x,!1)},!0)}s(h,R)};$(E,h=>{e(ne)?h(P):h(U,!1)})}s(t,m)},Ke=t=>{var m=Q(),k=w(m);{var E=P=>{var U=St(),h=w(U);De(h,{class:"mb-6",children:(x,n)=>{var D=$t(),b=l(w(D),4),M=o(b);ie(M,{type:"text",placeholder:"example.com",class:"flex-1",get value(){return e(N)},set value(y){r(N,y,!0)}});var g=l(M,2);ie(g,{type:"text",placeholder:"Reason (optional)",class:"flex-1",get value(){return e(te)},set value(y){r(te,y,!0)}});var S=l(g,2);{let y=oe(()=>!e(N).trim()||e(ae));de(S,{type:"primary",onclick:Ne,get disabled(){return e(y)},children:(L,v)=>{var i=Q(),u=w(i);{var B=f=>{var p=le("Blocking...");s(f,p)},c=f=>{var p=wt(),K=w(p);Pe(K,{class:"mr-2 h-4 w-4"}),se(),s(f,p)};$(u,f=>{e(ae)?f(B):f(c,!1)})}s(L,i)},$$slots:{default:!0}})}a(b),s(x,D)},$$slots:{default:!0}});var R=l(h,2);{var z=x=>{var n=kt(),D=o(n);Ee(D,{}),a(n),s(x,n)},q=x=>{var n=Q(),D=w(n);{var b=g=>{Be(g,{get icon(){return Ce},title:"No blocked domains",message:"Block domains to prevent all emails from those addresses."})},M=g=>{var S=Et(),y=w(S);{var L=B=>{var c=Dt(),f=o(c);Le(f,{placeholder:"Search blocked domains...",get value(){return e(ee)},set value(p){r(ee,p,!0)}}),a(c),s(B,c)};$(y,B=>{e(Z).length>5&&B(L)})}var v=l(y,2),i=o(v),u=l(o(i));xe(u,21,()=>e(Ie),be,(B,c)=>{var f=Bt(),p=o(f),K=o(p,!0);a(p);var j=l(p),pe=o(j,!0);a(j);var O=l(j),_e=o(O);{var I=A=>{Se(A,{variant:"warning",size:"sm",children:(re,Pt)=>{se();var $e=le();J(()=>C($e,e(c).block_attempts)),s(re,$e)},$$slots:{default:!0}})},he=A=>{var re=Lt();s(A,re)};$(_e,A=>{e(c).block_attempts>0?A(I):A(he,!1)})}a(O);var H=l(O),Qe=o(H,!0);a(H);var we=l(H),Ve=o(we);de(Ve,{type:"ghost",size:"sm",onclick:()=>Ue(e(c)),class:"text-text-muted hover:text-error",children:(A,re)=>{Re(A,{class:"h-4 w-4"})},$$slots:{default:!0}}),a(we),a(f),J(A=>{C(K,e(c).domain),C(pe,e(c).reason||"-"),C(Qe,A)},[()=>new Date(e(c).created_at).toLocaleDateString()]),s(B,f)}),a(u),a(i),a(v),s(g,S)};$(D,g=>{e(Z).length===0?g(b):g(M,!1)},!0)}s(x,n)};$(R,x=>{e(me)?x(z):x(q,!1)})}s(P,U)};$(k,P=>{e(T)==="domains"&&P(E)},!0)}s(t,m)};$(He,t=>{e(T)==="emails"?t(Je):t(Ke,!1)})}a(ue),s(Fe,ue),Ye(),Me()}tt(["click"]);export{Xt as component};
