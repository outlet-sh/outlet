import"../chunks/DsnmJJEf.js";import{p as Ke,s as v,a as Qe,u as We,b as t,f as F,d as Xe,e as Ye,i as e,h as r,c as l,t as ae,n as w,r as s,j as re,g as Ze}from"../chunks/odI--4Kw.js";import{s as S}from"../chunks/BNMK9zrr.js";import{a as o,c as we,f as h,t as k}from"../chunks/CCInJaqd.js";import{i as G}from"../chunks/COaB7F5h.js";import{e as et,i as tt}from"../chunks/BohEjZuL.js";import{h as at}from"../chunks/hUjpWz_l.js";import{e as rt,f as st,h as lt,i as ot}from"../chunks/ClaicyqD.js";import{B as z,M as be,g as it,I as J,S as Ae,A as nt,C as Pe}from"../chunks/DYqP3J7w.js";import{L as dt}from"../chunks/D716f0vp.js";import{S as vt}from"../chunks/CeRFu4qR.js";import{B as ve}from"../chunks/BD7k7D4N.js";import{P as Ue}from"../chunks/Dd3sdYnb.js";import{U as ut}from"../chunks/Dr3Yl38p.js";var ct=h("<!> Add User",1),mt=h("<p> </p>"),ft=h("<!> Add User",1),pt=h('<div class="text-center py-12"><!> <h3 class="mt-2 text-sm font-medium text-text">No users</h3> <p class="mt-1 text-sm text-text-muted">Get started by adding your first admin user.</p> <div class="mt-6"><!></div></div>'),_t=h('<div class="flex items-center justify-between py-4 first:pt-0 last:pb-0"><div class="flex items-center gap-3"><div class="h-10 w-10 rounded-full bg-primary flex items-center justify-center"><span class="text-sm font-medium text-white"> </span></div> <div><div class="flex items-center gap-2"><span class="font-medium text-text"> </span> <!> <!></div> <p class="text-sm text-text-muted"> </p></div></div> <div class="flex items-center gap-2"><span class="text-sm text-text-muted mr-4"> </span> <!> <!></div></div>'),$t=h('<div class="divide-y divide-border"></div>'),gt=h('<div class="flex justify-end gap-3"><!> <!></div>'),ht=h("<option>Admin</option> <option>Agent</option> <option>Viewer</option>",1),xt=h('<div class="space-y-4"><div><label for="new-name" class="form-label">Name</label> <!></div> <div><label for="new-email" class="form-label">Email</label> <!></div> <div><label for="new-password" class="form-label">Password</label> <!></div> <div><label for="new-role" class="form-label">Role</label> <!></div></div>'),yt=h('<div class="flex justify-end gap-3"><!> <!></div>'),wt=h("<option>Admin</option> <option>Agent</option> <option>Viewer</option>",1),bt=h('<div class="space-y-4"><div><label for="edit-name" class="form-label">Name</label> <!></div> <div><label for="edit-email" class="form-label">Email</label> <!></div> <div><label for="edit-role" class="form-label">Role</label> <!></div></div>'),At=h('<div class="space-y-6"><div class="flex justify-between items-center"><p class="text-sm text-text-secondary">Manage admin users who can access Outlet</p> <!></div> <!> <!></div> <!> <!> <!>',1);function Rt(De,Ee){Ke(Ee,!0);let se=v(!0),le=v(Qe([])),b=v(""),q=v(!1),T=v(!1),N=v(""),B=v(""),L=v(""),H=v("admin"),K=v(!1),Q=v(!1),W=v(!1),V=v(null),X=v(""),Y=v(""),Z=v(""),O=v(!1),C=v(null),oe=v(!1);We(()=>{ee()});async function ee(){t(se,!0),t(b,"");try{const a=await rt();t(le,a.users||[],!0)}catch(a){console.error("Failed to load users:",a),t(b,"Failed to load users")}finally{t(se,!1)}}function ue(){t(N,""),t(B,""),t(L,""),t(H,"admin"),t(q,!0)}function ce(){t(q,!1)}async function ke(){if(!(!e(N)||!e(B)||!e(L))){t(T,!0),t(b,"");try{await lt({name:e(N),email:e(B),password:e(L),role:e(H)}),ce(),await ee()}catch(a){console.error("Failed to add user:",a),t(b,a.message||"Failed to add user",!0)}finally{t(T,!1)}}}function Ce(a){t(V,a,!0),t(X,a.name,!0),t(Y,a.email,!0),t(Z,a.role,!0),t(K,!0)}function me(){t(K,!1),t(V,null)}async function Me(){if(e(V)){t(Q,!0),t(W,!1),t(b,"");try{await ot({},{name:e(X),email:e(Y),role:e(Z)},e(V).id),t(W,!0),setTimeout(()=>{t(W,!1),me()},1500),await ee()}catch(a){console.error("Failed to update user:",a),t(b,a.message||"Failed to update user",!0)}finally{t(Q,!1)}}}function je(a){t(C,a,!0),t(O,!0)}async function Fe(){if(e(C)){t(oe,!0);try{await st({},e(C).id),t(O,!1),t(C,null),await ee()}catch(a){console.error("Failed to delete user:",a),t(b,a.message||"Failed to delete user",!0)}finally{t(oe,!1)}}}function Se(a){switch(a?.toLowerCase()){case"super_admin":return"error";case"admin":return"primary";case"agent":return"info";default:return"default"}}function ze(a){return a?new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A"}var fe=At();at("c8rdj1",a=>{Ye(()=>{Ze.title="Users - Outlet"})});var ie=F(fe),ne=l(ie),Ne=r(l(ne),2);z(Ne,{type:"primary",onclick:ue,children:(a,d)=>{var m=ct(),i=F(m);Ue(i,{class:"mr-2 h-4 w-4"}),w(),o(a,m)},$$slots:{default:!0}}),s(ne);var pe=r(ne,2);{var Be=a=>{nt(a,{type:"error",title:"Error",children:(d,m)=>{var i=mt(),g=l(i,!0);s(i),ae(()=>S(g,e(b))),o(d,i)},$$slots:{default:!0}})};G(pe,a=>{e(b)&&a(Be)})}var Le=r(pe,2);{var Re=a=>{dt(a,{size:"large"})},Ie=a=>{var d=we(),m=F(d);{var i=f=>{Pe(f,{children:(_,x)=>{var u=pt(),D=l(u);ut(D,{class:"mx-auto h-12 w-12 text-text-muted"});var n=r(D,6),A=l(n);z(A,{type:"primary",onclick:ue,children:(c,M)=>{var p=ft(),E=F(p);Ue(E,{class:"mr-2 h-4 w-4"}),w(),o(c,p)},$$slots:{default:!0}}),s(n),s(u),o(_,u)},$$slots:{default:!0}})},g=f=>{Pe(f,{children:(_,x)=>{var u=$t();et(u,21,()=>e(le),tt,(D,n)=>{var A=_t(),c=l(A),M=l(c),p=l(M),E=l(p,!0);s(p),s(M);var P=r(M,2),y=l(P),j=l(y),te=l(j,!0);s(j);var ge=r(j,2);{let $=re(()=>Se(e(n).role));ve(ge,{get variant(){return e($)},size:"sm",children:(U,R)=>{w();var I=k();ae(()=>S(I,e(n).role)),o(U,I)},$$slots:{default:!0}})}var Ve=r(ge,2);{var Oe=$=>{ve($,{variant:"success",size:"sm",children:(U,R)=>{w();var I=k("Active");o(U,I)},$$slots:{default:!0}})},Ge=$=>{ve($,{variant:"error",size:"sm",children:(U,R)=>{w();var I=k("Inactive");o(U,I)},$$slots:{default:!0}})};G(Ve,$=>{e(n).active?$(Oe):$(Ge,!1)})}s(y);var he=r(y,2),Je=l(he,!0);s(he),s(P),s(c);var xe=r(c,2),de=l(xe),qe=l(de);s(de);var ye=r(de,2);z(ye,{type:"secondary",size:"sm",onclick:()=>Ce(e(n)),children:($,U)=>{w();var R=k("Edit");o($,R)},$$slots:{default:!0}});var He=r(ye,2);z(He,{type:"danger",size:"sm",onclick:()=>je(e(n)),children:($,U)=>{w();var R=k("Delete");o($,R)},$$slots:{default:!0}}),s(xe),s(A),ae(($,U)=>{S(E,$),S(te,e(n).name),S(Je,e(n).email),S(qe,`Added ${U??""}`)},[()=>(e(n).name||e(n).email)[0].toUpperCase(),()=>ze(e(n).created_at)]),o(D,A)}),s(u),o(_,u)},$$slots:{default:!0}})};G(m,f=>{e(le).length===0?f(i):f(g,!1)},!0)}o(a,d)};G(Le,a=>{e(se)?a(Re):a(Ie,!1)})}s(ie);var _e=r(ie,2);be(_e,{title:"Add User",get show(){return e(q)},set show(d){t(q,d,!0)},footer:d=>{var m=gt(),i=l(m);z(i,{type:"secondary",onclick:ce,get disabled(){return e(T)},children:(f,_)=>{w();var x=k("Cancel");o(f,x)},$$slots:{default:!0}});var g=r(i,2);{let f=re(()=>!e(N)||!e(B)||!e(L)||e(T));z(g,{type:"primary",onclick:ke,get disabled(){return e(f)},children:(_,x)=>{w();var u=k();ae(()=>S(u,e(T)?"Adding...":"Add User")),o(_,u)},$$slots:{default:!0}})}s(m),o(d,m)},children:(d,m)=>{var i=xt(),g=l(i),f=r(l(g),2);J(f,{id:"new-name",type:"text",placeholder:"John Doe",get value(){return e(N)},set value(c){t(N,c,!0)}}),s(g);var _=r(g,2),x=r(l(_),2);J(x,{id:"new-email",type:"email",placeholder:"john@example.com",get value(){return e(B)},set value(c){t(B,c,!0)}}),s(_);var u=r(_,2),D=r(l(u),2);J(D,{id:"new-password",type:"password",placeholder:"Enter password",get value(){return e(L)},set value(c){t(L,c,!0)}}),s(u);var n=r(u,2),A=r(l(n),2);Ae(A,{id:"new-role",get value(){return e(H)},set value(c){t(H,c,!0)},children:(c,M)=>{var p=ht(),E=F(p);E.value=E.__value="admin";var P=r(E,2);P.value=P.__value="agent";var y=r(P,2);y.value=y.__value="viewer",o(c,p)},$$slots:{default:!0}}),s(n),s(i),o(d,i)},$$slots:{footer:!0,default:!0}});var $e=r(_e,2);be($e,{title:"Edit User",get show(){return e(K)},set show(d){t(K,d,!0)},footer:d=>{var m=yt(),i=l(m);z(i,{type:"secondary",onclick:me,get disabled(){return e(Q)},children:(f,_)=>{w();var x=k("Cancel");o(f,x)},$$slots:{default:!0}});var g=r(i,2);vt(g,{label:"Save Changes",get saving(){return e(Q)},get saved(){return e(W)},onclick:Me}),s(m),o(d,m)},children:(d,m)=>{var i=we(),g=F(i);{var f=_=>{var x=bt(),u=l(x),D=r(l(u),2);J(D,{id:"edit-name",type:"text",get value(){return e(X)},set value(p){t(X,p,!0)}}),s(u);var n=r(u,2),A=r(l(n),2);J(A,{id:"edit-email",type:"email",get value(){return e(Y)},set value(p){t(Y,p,!0)}}),s(n);var c=r(n,2),M=r(l(c),2);Ae(M,{id:"edit-role",get value(){return e(Z)},set value(p){t(Z,p,!0)},children:(p,E)=>{var P=wt(),y=F(P);y.value=y.__value="admin";var j=r(y,2);j.value=j.__value="agent";var te=r(j,2);te.value=te.__value="viewer",o(p,P)},$$slots:{default:!0}}),s(c),s(x),o(_,x)};G(g,_=>{e(V)&&_(f)})}o(d,i)},$$slots:{footer:!0,default:!0}});var Te=r($e,2);{let a=re(()=>e(C)?`Are you sure you want to delete ${e(C).name}? This action cannot be undone.`:""),d=re(()=>e(oe)?"Deleting...":"Delete");it(Te,{title:"Delete User",get description(){return e(a)},get actionLabel(){return e(d)},actionType:"danger",onAction:Fe,onCancel:()=>{t(O,!1),t(C,null)},get open(){return e(O)},set open(m){t(O,m,!0)}})}o(De,fe),Xe()}export{Rt as component};
