import"../chunks/DsnmJJEf.js";import{f as J,p as ct,u as Fe,b as s,s as M,c as a,i as e,r as t,h as r,j as ce,t as k,d as vt,n as de,a as tt,m as At,$ as Tt,g as Lt}from"../chunks/C06BEU5l.js";import{d as ut,s as _,e as Et}from"../chunks/C8f6XRe7.js";import{s as Rt}from"../chunks/CA9xQ_fI.js";import{l as Ge,s as qe,p as Ft,i as B,c as at}from"../chunks/CGGWlPqF.js";import{e as Se,s as Y,a as be,i as Ce}from"../chunks/DeoqKKJ5.js";import{c as me,a as l,f as b,t as Re}from"../chunks/DV4WO4A5.js";import{h as Gt}from"../chunks/CFYH9Sl-.js";import{s as bt,a as mt}from"../chunks/OBh08uFC.js";import{g as ue}from"../chunks/DWOZHk3q.js";import{p as pt}from"../chunks/CvNcLl8J.js";import"../chunks/DLPkoF36.js";import{a as De,s as He,F as qt,M as Dt,I as rt,B as st,A as Ht,X as Kt,i as ot}from"../chunks/Bg2aYoKt.js";import{S as Wt}from"../chunks/2_aXXvvW.js";import{U as Xt}from"../chunks/DxZPXXeD.js";import{T as Yt}from"../chunks/ldoE5vPz.js";import{S as Jt}from"../chunks/DS6RRKoT.js";import{M as nt}from"../chunks/LmkpqQDV.js";import{C as Qt}from"../chunks/C6qnVqQt.js";import{A as Vt}from"../chunks/4hMN_xBY.js";import{j as Zt,l as ea,c as ta}from"../chunks/C03oMPLM.js";import{g as aa,l as ra}from"../chunks/CuiFJ7Vr.js";import{C as lt}from"../chunks/B2HSnf3Z.js";import{M as sa}from"../chunks/CMhEBYPT.js";import{P as it}from"../chunks/BwDKg4_N.js";function oa(E,m){const R=Ge(m,["children","$$slots","$$events","$$legacy"]);const D=[["path",{d:"M4.929 4.929 19.07 19.071"}],["circle",{cx:"12",cy:"12",r:"10"}]];De(E,qe({name:"ban"},()=>R,{get iconNode(){return D},children:(H,c)=>{var S=me(),v=J(S);He(v,m,"default",{}),l(H,S)},$$slots:{default:!0}}))}function na(E,m){const R=Ge(m,["children","$$slots","$$events","$$legacy"]);const D=[["path",{d:"m15 18-6-6 6-6"}]];De(E,qe({name:"chevron-left"},()=>R,{get iconNode(){return D},children:(H,c)=>{var S=me(),v=J(S);He(v,m,"default",{}),l(H,S)},$$slots:{default:!0}}))}function la(E,m){const R=Ge(m,["children","$$slots","$$events","$$legacy"]);const D=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1"}]];De(E,qe({name:"layout-dashboard"},()=>R,{get iconNode(){return D},children:(H,c)=>{var S=me(),v=J(S);He(v,m,"default",{}),l(H,S)},$$slots:{default:!0}}))}const ia=async({params:E})=>({brandSlug:E.brandSlug}),ar=Object.freeze(Object.defineProperty({__proto__:null,load:ia},Symbol.toStringTag,{value:"Module"}));var da=b('<a class="sidebar-brand"><!> <span class="sidebar-brand-text"> </span></a>'),ca=b('<a class="sidebar-brand-icon"><!></a>'),va=b('<span class="sidebar-label"> </span>'),ua=b("<a><!> <!></a>"),ba=b('<span class="sidebar-label"> </span>'),ma=b("<a><!> <!></a>"),pa=b('<!> <span class="sidebar-label">Collapse</span>',1),fa=b('<aside><div class="sidebar-header"><!></div> <nav class="sidebar-nav"></nav> <div class="flex-1"></div> <nav class="sidebar-nav sidebar-nav-bottom"><!> <button class="sidebar-collapse-btn"><!></button></nav></aside>');function dt(E,m){ct(m,!0);const R=()=>mt(pt,"$page",D),[D,H]=bt(),c=Ft(m,"orgName",3,"Outlet"),S="sidebar-collapsed";let v=M(!1);Fe(()=>{{const d=localStorage.getItem(S);s(v,d==="true")}});function ne(){s(v,!e(v)),localStorage.setItem(S,String(e(v)))}let C=ce(()=>`/${m.brandSlug}`);const K=[{id:"dashboard",label:"Dashboard",href:"",icon:la,exact:!0},{id:"campaigns",label:"Campaigns",href:"/campaigns",icon:Wt},{id:"lists",label:"Lists",href:"/lists",icon:Xt},{id:"templates",label:"Templates",href:"/templates",icon:qt},{id:"housekeeping",label:"Housekeeping",href:"/housekeeping",icon:Yt},{id:"blocklist",label:"Blocklist",href:"/blocklist",icon:oa}],j=[{id:"settings",label:"Settings",href:"/settings",icon:Jt}];function I(d,n=!1){const h=`${e(C)}${d}`;return n?R().url.pathname===h||R().url.pathname===h+"/":R().url.pathname.startsWith(h)&&h!==e(C)}var G=fa();let q;var A=a(G),ee=a(A);{var te=d=>{var n=da(),h=a(n);nt(h,{class:"h-6 w-6 text-primary"});var y=r(h,2),i=a(y,!0);t(y),t(n),k(()=>{Y(n,"href",e(C)),_(i,c())}),l(d,n)},Oe=d=>{var n=ca(),h=a(n);nt(h,{class:"h-6 w-6 text-primary"}),t(n),k(()=>Y(n,"href",e(C))),l(d,n)};B(ee,d=>{e(v)?d(Oe,!1):d(te)})}t(A);var le=r(A,2);Se(le,21,()=>K,Ce,(d,n)=>{const h=ce(()=>e(n).icon);var y=ua();let i;var g=a(y);at(g,()=>e(h),(u,x)=>{x(u,{class:"sidebar-icon"})});var T=r(g,2);{var L=u=>{var x=va(),w=a(x,!0);t(x),k(()=>_(w,e(n).label)),l(u,x)};B(T,u=>{e(v)||u(L)})}t(y),k(u=>{Y(y,"href",`${e(C)??""}${e(n).href??""}`),i=be(y,1,"sidebar-link",null,i,u),Y(y,"title",e(v)?e(n).label:void 0)},[()=>({active:I(e(n).href,e(n).exact)})]),l(d,y)}),t(le);var ve=r(le,4),pe=a(ve);Se(pe,17,()=>j,Ce,(d,n)=>{const h=ce(()=>e(n).icon);var y=ma();let i;var g=a(y);at(g,()=>e(h),(u,x)=>{x(u,{class:"sidebar-icon"})});var T=r(g,2);{var L=u=>{var x=ba(),w=a(x,!0);t(x),k(()=>_(w,e(n).label)),l(u,x)};B(T,u=>{e(v)||u(L)})}t(y),k(u=>{Y(y,"href",`${e(C)??""}${e(n).href??""}`),i=be(y,1,"sidebar-link",null,i,u),Y(y,"title",e(v)?e(n).label:void 0)},[()=>({active:I(e(n).href)})]),l(d,y)});var ae=r(pe,2);ae.__click=ne;var ze=a(ae);{var Be=d=>{Qt(d,{class:"h-4 w-4"})},fe=d=>{var n=pa(),h=J(n);na(h,{class:"h-4 w-4"}),de(2),l(d,n)};B(ze,d=>{e(v)?d(Be):d(fe,!1)})}t(ae),t(ve),t(G),k(()=>{q=be(G,1,"sidebar",null,q,{collapsed:e(v)}),Y(ae,"title",e(v)?"Expand sidebar":"Collapse sidebar")}),l(E,G),vt(),H()}ut(["click"]);var _a=b('<meta name="robots" content="noindex, nofollow"/>'),ga=b('<div class="min-h-screen bg-base-50 flex items-center justify-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),xa=b('<div class="min-h-screen bg-base-50 flex items-center justify-center"><div class="text-error"> </div></div>'),ha=b('<button><span class="flex items-center justify-center h-8 w-8 rounded-md text-xs font-semibold text-white bg-primary flex-shrink-0"> </span> <span class="flex-1 text-sm font-medium text-text truncate"> </span> <!></button>'),ya=b('<div class="absolute left-1/2 -translate-x-1/2 top-full mt-2 w-64 rounded-lg shadow-lg py-1 z-50 bg-white border border-base-200"><div class="px-3 py-2 border-b border-border"><p class="text-xs font-medium text-text-muted uppercase tracking-wide">Brands</p></div> <div class="max-h-64 overflow-y-auto"></div> <div class="border-t border-border mt-1 pt-1"><button class="w-full px-3 py-2 flex items-center gap-3 text-left transition-colors hover:bg-base-100 text-text-muted hover:text-text"><span class="flex items-center justify-center h-8 w-8 rounded-md border-2 border-dashed border-base-300 flex-shrink-0"><!></span> <span class="text-sm">Add brand</span></button></div></div>'),wa=b('<div class="absolute right-0 top-full mt-2 w-56 rounded-lg shadow-lg py-1 z-50 bg-white border border-base-200"><div class="px-4 py-3 border-b border-border"><p class="text-sm font-medium text-text truncate"> </p></div> <a class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900">Settings</a> <div class="border-t border-border my-1"></div> <button class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900 w-full text-left">Switch Brand</button> <button class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900 w-full text-left">Sign out</button></div>'),$a=b('<div class="fixed inset-0 z-40 bg-black/50 md:hidden" role="button" tabindex="-1"></div> <div class="fixed inset-y-0 left-0 z-50 w-[220px] md:hidden"><!></div>',1),ka=b('<button><span class="flex items-center justify-center h-8 w-8 rounded-md text-xs font-semibold text-white bg-primary flex-shrink-0"> </span> <span class="flex-1 text-sm font-medium text-text truncate"> </span> <!></button>'),Sa=b('<div class="absolute right-0 top-full mt-2 w-64 rounded-lg shadow-lg py-1 z-50 bg-white border border-base-200"><div class="px-3 py-2 border-b border-border"><p class="text-xs font-medium text-text-muted uppercase tracking-wide">Brands</p></div> <div class="max-h-64 overflow-y-auto"></div> <div class="border-t border-border mt-1 pt-1"><button class="w-full px-3 py-2 flex items-center gap-3 text-left transition-colors hover:bg-base-100 text-text-muted hover:text-text"><span class="flex items-center justify-center h-8 w-8 rounded-md border-2 border-dashed border-base-300 flex-shrink-0"><!></span> <span class="text-sm">Add brand</span></button></div></div>'),Ca=b('<div class="absolute right-0 top-full mt-2 w-56 rounded-lg shadow-lg py-1 z-50 bg-white border border-base-200"><div class="px-4 py-3 border-b border-border"><p class="text-sm font-medium text-text truncate"> </p> <p class="text-xs text-text-muted capitalize"> </p></div> <a class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900">Settings</a> <div class="border-t border-border my-1"></div> <button class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900 w-full text-left">Switch Brand</button> <button class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900 w-full text-left">Sign out</button></div>'),Oa=b('<div class="admin-layout"><div class="admin-sidebar hidden md:block"><!></div> <div class="fixed top-0 left-0 right-0 h-14 px-4 flex items-center justify-between z-40 border-b border-base-200 bg-white md:hidden"><button class="p-2 rounded-lg transition-colors text-text-muted hover:bg-base-100"><!></button> <div class="brand-switcher relative"><button class="flex items-center gap-1 font-semibold text-text"> <!></button> <!></div> <div class="user-menu-container relative"><button class="flex items-center gap-2 p-1 rounded-lg transition-colors hover:bg-base-100"><div class="flex items-center justify-center h-8 w-8 rounded-full text-sm font-medium text-white bg-primary"> </div></button> <!></div></div> <!> <div class="admin-main"><header class="h-16 px-6 items-center justify-end border-b border-base-200 sticky top-0 z-20 bg-white hidden md:flex"><div class="flex items-center gap-4"><div class="brand-switcher relative"><button class="flex items-center gap-2 px-2 py-1.5 rounded-lg transition-colors hover:bg-base-100 group"><span class="flex items-center justify-center h-7 w-7 rounded-md text-xs font-semibold text-white bg-primary"> </span> <span class="font-medium text-sm"> </span> <!></button> <!></div> <div class="user-menu-container relative"><button class="flex items-center gap-2 p-1 rounded-lg transition-colors hover:bg-base-100"><div class="flex items-center justify-center h-8 w-8 rounded-full text-sm font-medium text-white bg-primary"> </div> <span class="text-sm text-text-muted hidden lg:block"> </span></button> <!></div></div></header> <main class="flex-1"><!></main></div></div>'),za=b("<!> <!>",1),Ba=b('<div class="space-y-4"><!> <div><label for="brand-name" class="block text-sm font-medium text-text mb-1">Brand Name</label> <!></div> <div><label for="brand-slug" class="block text-sm font-medium text-text mb-1">URL Slug</label> <!> <p class="text-xs text-text-muted mt-1"> </p></div></div>'),Ia=b("<!> <!>",1);function rr(E,m){ct(m,!0);const R=()=>mt(pt,"$page",D),[D,H]=bt();let c=M(null),S=M(tt([])),v=M(!0),ne=M(""),C=tt(aa()),K=M(!1),j=M(!1),I=M(!1),G=M(!1),q=M(""),A=M(""),ee=M(!1),te=M("");Fe(()=>{Oe()}),Fe(()=>{R().url.pathname,s(K,!1)});async function Oe(){s(v,!0),s(ne,"");try{const[i,g]=await Promise.all([Zt({},m.data.brandSlug),ea()]);s(c,i,!0),s(S,g.organizations||[],!0),localStorage.setItem("currentOrgId",e(c).id),localStorage.setItem("currentOrgName",e(c).name),localStorage.setItem("currentOrgSlug",e(c).slug);const T=localStorage.getItem(`orgSetupSkipped_${e(c).slug}`);if(!e(c).from_email&&!T){ue(`/${e(c).slug}/welcome`);return}}catch(i){console.error("Failed to load organization:",i),s(ne,`Organization "${m.data.brandSlug}" not found`),ue("/")}finally{s(v,!1)}}function le(){localStorage.removeItem("currentOrgId"),localStorage.removeItem("currentOrgName"),localStorage.removeItem("currentOrgSlug"),ue("/")}function ve(){ra()}function pe(i){const g=i.target;g.closest(".user-menu-container")||s(j,!1),g.closest(".brand-switcher")||s(I,!1)}function ae(i){s(I,!1),ue(`/${i}`)}function ze(i){return i.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function Be(){s(A,ze(e(q)),!0)}function fe(){s(I,!1),s(q,""),s(A,""),s(te,""),s(G,!0)}async function d(){if(!(!e(q).trim()||!e(A).trim())){s(ee,!0),s(te,"");try{const i=await ta({name:e(q).trim(),slug:e(A).trim()});s(G,!1),ue(`/${i.slug}/welcome`)}catch(i){s(te,i.message||"Failed to create brand",!0)}finally{s(ee,!1)}}}var n=Ia();Gt("1xdtdtq",i=>{var g=_a();At(()=>{Lt.title=`${(e(c)?.name||"Admin")??""} | Outlet`}),l(i,g)}),Et("click",Tt,pe);var h=J(n);Vt(h,{children:(i,g)=>{var T=me(),L=J(T);{var u=w=>{var W=ga();l(w,W)},x=w=>{var W=me(),re=J(W);{var _e=Q=>{var O=xa(),V=a(O),xe=a(V,!0);t(V),t(O),k(()=>_(xe,e(ne))),l(Q,O)},ge=Q=>{var O=Oa(),V=a(O),xe=a(V);{let o=ce(()=>e(c)?.name);dt(xe,{get brandSlug(){return m.data.brandSlug},get orgName(){return e(o)}})}t(V);var ie=r(V,2),he=a(ie);he.__click=()=>s(K,!e(K));var ft=a(he);{var _t=o=>{Kt(o,{class:"h-6 w-6"})},gt=o=>{sa(o,{class:"h-6 w-6"})};B(ft,o=>{e(K)?o(_t):o(gt,!1)})}t(he);var Ie=r(he,2),ye=a(Ie);ye.__click=o=>{o.stopPropagation(),s(j,!1),s(I,!e(I))};var Ke=a(ye),xt=r(Ke);lt(xt,{class:"h-4 w-4 text-text-muted"}),t(ye);var ht=r(ye,2);{var yt=o=>{var f=ya(),p=r(a(f),2);Se(p,21,()=>e(S),Ce,(X,P)=>{var U=ha();U.__click=()=>ae(e(P).slug);var se=a(U),Ae=a(se,!0);t(se);var oe=r(se,2),Te=a(oe,!0);t(oe);var Le=r(oe,2);{var Ee=F=>{ot(F,{class:"h-4 w-4 text-primary flex-shrink-0"})};B(Le,F=>{e(P).id===e(c)?.id&&F(Ee)})}t(U),k(F=>{be(U,1,`w-full px-3 py-2 flex items-center gap-3 text-left transition-colors hover:bg-base-100 ${e(P).id===e(c)?.id?"bg-base-50":""}`),_(Ae,F),_(Te,e(P).name)},[()=>e(P).name[0].toUpperCase()]),l(X,U)}),t(p);var z=r(p,2),N=a(z);N.__click=fe;var $=a(N),Z=a($);it(Z,{class:"h-4 w-4"}),t($),de(2),t(N),t(z),t(f),l(o,f)};B(ht,o=>{e(I)&&o(yt)})}t(Ie);var We=r(Ie,2),we=a(We);we.__click=o=>{o.stopPropagation(),s(I,!1),s(j,!e(j))};var Xe=a(we),wt=a(Xe,!0);t(Xe),t(we);var $t=r(we,2);{var kt=o=>{var f=wa(),p=a(f),z=a(p),N=a(z,!0);t(z),t(p);var $=r(p,2);$.__click=()=>s(j,!1);var Z=r($,4);Z.__click=le;var X=r(Z,2);X.__click=ve,t(f),k(()=>{_(N,C?.email),Y($,"href",`/${m.data.brandSlug??""}/settings`)}),l(o,f)};B($t,o=>{e(j)&&o(kt)})}t(We),t(ie);var Ye=r(ie,2);{var St=o=>{var f=$a(),p=J(f);p.__click=()=>s(K,!1),p.__keydown=$=>$.key==="Escape"&&s(K,!1);var z=r(p,2),N=a(z);{let $=ce(()=>e(c)?.name);dt(N,{get brandSlug(){return m.data.brandSlug},get orgName(){return e($)}})}t(z),l(o,f)};B(Ye,o=>{e(K)&&o(St)})}var Je=r(Ye,2),Pe=a(Je),Qe=a(Pe),je=a(Qe),$e=a(je);$e.__click=o=>{o.stopPropagation(),s(j,!1),s(I,!e(I))};var Ne=a($e),Ct=a(Ne,!0);t(Ne);var Ue=r(Ne,2),Ot=a(Ue,!0);t(Ue);var zt=r(Ue,2);lt(zt,{class:"h-4 w-4 text-text-muted group-hover:text-text transition-colors"}),t($e);var Bt=r($e,2);{var It=o=>{var f=Sa(),p=r(a(f),2);Se(p,21,()=>e(S),Ce,(X,P)=>{var U=ka();U.__click=()=>ae(e(P).slug);var se=a(U),Ae=a(se,!0);t(se);var oe=r(se,2),Te=a(oe,!0);t(oe);var Le=r(oe,2);{var Ee=F=>{ot(F,{class:"h-4 w-4 text-primary flex-shrink-0"})};B(Le,F=>{e(P).id===e(c)?.id&&F(Ee)})}t(U),k(F=>{be(U,1,`w-full px-3 py-2 flex items-center gap-3 text-left transition-colors hover:bg-base-100 ${e(P).id===e(c)?.id?"bg-base-50":""}`),_(Ae,F),_(Te,e(P).name)},[()=>e(P).name[0].toUpperCase()]),l(X,U)}),t(p);var z=r(p,2),N=a(z);N.__click=fe;var $=a(N),Z=a($);it(Z,{class:"h-4 w-4"}),t($),de(2),t(N),t(z),t(f),l(o,f)};B(Bt,o=>{e(I)&&o(It)})}t(je);var Ve=r(je,2),ke=a(Ve);ke.__click=o=>{o.stopPropagation(),s(I,!1),s(j,!e(j))};var Me=a(ke),Pt=a(Me,!0);t(Me);var Ze=r(Me,2),jt=a(Ze,!0);t(Ze),t(ke);var Nt=r(ke,2);{var Ut=o=>{var f=Ca(),p=a(f),z=a(p),N=a(z,!0);t(z);var $=r(z,2),Z=a($,!0);t($),t(p);var X=r(p,2);X.__click=()=>s(j,!1);var P=r(X,4);P.__click=le;var U=r(P,2);U.__click=ve,t(f),k(()=>{_(N,C?.email),_(Z,C?.role||"user"),Y(X,"href",`/${m.data.brandSlug??""}/settings`)}),l(o,f)};B(Nt,o=>{e(j)&&o(Ut)})}t(Ve),t(Qe),t(Pe);var et=r(Pe,2),Mt=a(et);Rt(Mt,()=>m.children),t(et),t(Je),t(O),k((o,f,p)=>{_(Ke,`${(e(c)?.name||"Outlet")??""} `),_(wt,o),_(Ct,f),_(Ot,e(c)?.name||"Organization"),_(Pt,p),_(jt,C?.email)},[()=>(C?.name||C?.email||"U")[0].toUpperCase(),()=>(e(c)?.name||"O")[0].toUpperCase(),()=>(C?.name||C?.email||"U")[0].toUpperCase()]),l(Q,O)};B(re,Q=>{e(ne)?Q(_e):Q(ge,!1)},!0)}l(w,W)};B(L,w=>{e(v)?w(u):w(x,!1)})}l(i,T)},$$slots:{default:!0}});var y=r(h,2);Dt(y,{title:"Create Brand",get show(){return e(G)},set show(g){s(G,g,!0)},footer:g=>{var T=za(),L=J(T);st(L,{type:"secondary",onclick:()=>s(G,!1),get disabled(){return e(ee)},children:(x,w)=>{de();var W=Re("Cancel");l(x,W)},$$slots:{default:!0}});var u=r(L,2);{let x=ce(()=>!e(q).trim()||!e(A).trim()||e(ee));st(u,{type:"primary",onclick:d,get disabled(){return e(x)},children:(w,W)=>{de();var re=Re();k(()=>_(re,e(ee)?"Creating...":"Create Brand")),l(w,re)},$$slots:{default:!0}})}l(g,T)},children:(g,T)=>{var L=Ba(),u=a(L);{var x=O=>{Ht(O,{type:"error",children:(V,xe)=>{de();var ie=Re();k(()=>_(ie,e(te))),l(V,ie)},$$slots:{default:!0}})};B(u,O=>{e(te)&&O(x)})}var w=r(u,2),W=r(a(w),2);rt(W,{id:"brand-name",oninput:Be,placeholder:"My Company",get value(){return e(q)},set value(O){s(q,O,!0)}}),t(w);var re=r(w,2),_e=r(a(re),2);rt(_e,{id:"brand-slug",placeholder:"my-company",get value(){return e(A)},set value(O){s(A,O,!0)}});var ge=r(_e,2),Q=a(ge);t(ge),t(re),t(L),k(()=>_(Q,`This will be used in the URL: /${(e(A)||"my-company")??""}`)),l(g,L)},$$slots:{footer:!0,default:!0}}),l(E,n),vt(),H()}ut(["click","keydown"]);export{rr as component,ar as universal};
