import"../chunks/Bzak7iHL.js";import{p as xe,u as $e,b as t,d as l,g as e,f as h,a as be,k as ke,s as o,e as D,$ as we,c as n,r as i,t as Z,n as F}from"../chunks/Ip2DykXx.js";import{s as H}from"../chunks/DhOIAuLg.js";import{f as u,a as d,c as ae}from"../chunks/BPgbRZ5o.js";import{i as L}from"../chunks/BeCi3WIf.js";import{h as Ae}from"../chunks/vHZS38u2.js";import{a as Se,s as Pe}from"../chunks/ur54L5C-.js";import{g as Ie}from"../chunks/CDoCV2GU.js";import{p as Ce}from"../chunks/BUZmhiZ9.js";import{g as Te,p as ze,q as Re,s as Oe}from"../chunks/CtwFYI68.js";import{d as re,A as De,C as J,I as oe,B as M}from"../chunks/Bphptf_a.js";import{L as Fe}from"../chunks/sFH_xjRy.js";import{S as Le}from"../chunks/CwztAqJg.js";import{C as Be}from"../chunks/Dx9qyz7C.js";import{C as Ke}from"../chunks/C65kbecp.js";import{R as Ne}from"../chunks/CQK8yWuM.js";import{T as Ue}from"../chunks/Boqopfmd.js";var qe=u("<p> </p>"),je=u('<div class="mb-6"><!></div>'),Ee=u('<h2 class="text-lg font-medium text-text mb-4">General</h2> <div class="space-y-4"><div><label for="org-name" class="form-label">Site Name</label> <!></div> <div><label class="form-label">Slug</label> <p class="text-sm text-text-muted bg-bg-secondary px-3 py-2 rounded-md"> </p> <p class="mt-1 text-xs text-text-muted">The slug cannot be changed after creation</p></div> <div><label for="app-url" class="form-label">App URL</label> <!> <p class="mt-1 text-xs text-text-muted">Base URL of your application for confirmation links</p></div> <div class="pt-2"><!></div></div>',1),Ge=u("<!> Regenerate Key",1),Ze=u('<h2 class="text-lg font-medium text-text mb-4">API Key</h2> <p class="text-sm text-text-muted mb-4">Use this key to authenticate API requests for this site.</p> <div class="flex items-center gap-2 bg-bg-secondary px-3 py-2 rounded-md"><code class="flex-1 text-sm font-mono text-text break-all"> </code> <!></div> <div class="mt-4"><!></div>',1),He=u("<!> Delete Site",1),Je=u(`<h2 class="text-lg font-medium text-red-600 mb-4">Danger Zone</h2> <p class="text-sm text-text-muted mb-4">Permanently delete this site and all of its data including contacts, leads, and orders.
						This action cannot be undone.</p> <!>`,1),Me=u('<div class="space-y-6"><!> <!> <!></div>'),Qe=u("<!> <!> <!> <!>",1);function pt(se,le){xe(le,!0);const ne=()=>Se(Ce,"$page",ie),[ie,de]=Pe();let B=l(!0),r=l(null),m=l(""),p=l(""),w=l(""),K=l(!1),C=l(!1),N=l(!1),T=l(!1),U=l(!1),S=l(!1),q=l(!1);$e(()=>{Q()});async function Q(){t(B,!0),t(m,"");const a=ne().params.orgSlug;if(a)try{t(r,await Te({},a),!0),t(p,e(r).name,!0),t(w,e(r).app_url||"",!0)}catch(s){console.error("Failed to load organization:",s),t(m,"Failed to load organization")}finally{t(B,!1)}}async function ce(){if(!(!e(r)||!e(p).trim())){t(K,!0),t(C,!1),t(m,"");try{await Oe({},{name:e(p).trim(),app_url:e(w).trim()},e(r).id),e(r).name=e(p).trim(),e(r).app_url=e(w).trim(),localStorage.setItem("currentOrgName",e(p).trim()),t(C,!0),setTimeout(()=>{t(C,!1)},2e3)}catch(a){console.error("Failed to update organization:",a),t(m,a.message||"Failed to update organization",!0)}finally{t(K,!1)}}}function ue(){e(r)&&(navigator.clipboard.writeText(e(r).api_key),t(N,!0),setTimeout(()=>{t(N,!1)},2e3))}async function me(){if(e(r)){t(q,!0);try{await ze({},e(r).id),t(S,!1),await Q()}catch(a){console.error("Failed to regenerate API key:",a),t(m,a.message||"Failed to regenerate API key",!0)}finally{t(q,!1)}}}async function pe(){if(e(r)){t(U,!0);try{await Re({},e(r).id),localStorage.removeItem("currentOrgId"),localStorage.removeItem("currentOrgName"),localStorage.removeItem("currentOrgSlug"),Ie("/")}catch(a){console.error("Failed to delete organization:",a),t(m,a.message||"Failed to delete organization",!0)}finally{t(U,!1)}}}var V=Qe();Ae("10lcj35",a=>{ke(()=>{var s;we.title=`Site Settings - ${(((s=e(r))==null?void 0:s.name)||"Loading")??""}`})});var W=h(V);{var ge=a=>{var s=je(),g=n(s);De(g,{type:"error",title:"Error",children:(j,z)=>{var x=qe(),R=n(x,!0);i(x),Z(()=>H(R,e(m))),d(j,x)},$$slots:{default:!0}}),i(s),d(a,s)};L(W,a=>{e(m)&&a(ge)})}var X=o(W,2);{var fe=a=>{Fe(a,{size:"large"})},ve=a=>{var s=ae(),g=h(s);{var j=z=>{var x=Me(),R=n(x);J(R,{children:(P,te)=>{var f=Ee(),v=o(h(f),2),c=n(v),O=o(n(c),2);oe(O,{id:"org-name",type:"text",get value(){return e(p)},set value(k){t(p,k,!0)}}),i(c);var _=o(c,2),$=o(n(_),2),E=n($,!0);i($),F(2),i(_);var b=o(_,2),G=o(n(b),2);oe(G,{id:"app-url",type:"text",placeholder:"https://yourapp.com",get value(){return e(w)},set value(k){t(w,k,!0)}}),F(2),i(b);var y=o(b,2),I=n(y);{let k=D(()=>e(p)===e(r).name&&e(w)===(e(r).app_url||""));Le(I,{label:"Save Changes",get saving(){return e(K)},get saved(){return e(C)},onclick:ce,get disabled(){return e(k)}})}i(y),i(v),Z(()=>H(E,e(r).slug)),d(P,f)},$$slots:{default:!0}});var ee=o(R,2);J(ee,{children:(P,te)=>{var f=Ze(),v=o(h(f),4),c=n(v),O=n(c,!0);i(c);var _=o(c,2);M(_,{type:"ghost",size:"icon",onclick:ue,class:"flex-shrink-0 p-1.5 text-text-muted hover:text-text rounded transition-colors",children:(b,G)=>{var y=ae(),I=h(y);{var k=A=>{Be(A,{class:"h-4 w-4 text-green-500"})},he=A=>{Ke(A,{class:"h-4 w-4"})};L(I,A=>{e(N)?A(k):A(he,!1)})}d(b,y)},$$slots:{default:!0}}),i(v);var $=o(v,2),E=n($);M(E,{type:"secondary",onclick:()=>t(S,!0),children:(b,G)=>{var y=Ge(),I=h(y);Ne(I,{class:"mr-2 h-4 w-4"}),F(),d(b,y)},$$slots:{default:!0}}),i($),Z(()=>H(O,e(r).api_key)),d(P,f)},$$slots:{default:!0}});var ye=o(ee,2);J(ye,{children:(P,te)=>{var f=Je(),v=o(h(f),4);M(v,{type:"danger",onclick:()=>t(T,!0),children:(c,O)=>{var _=He(),$=h(_);Ue($,{class:"mr-2 h-4 w-4"}),F(),d(c,_)},$$slots:{default:!0}}),d(P,f)},$$slots:{default:!0}}),i(x),d(z,x)};L(g,z=>{e(r)&&z(j)},!0)}d(a,s)};L(X,a=>{e(B)?a(fe):a(ve,!1)})}var Y=o(X,2);{let a=D(()=>e(q)?"Regenerating...":"Regenerate");re(Y,{title:"Regenerate API Key",description:"Are you sure you want to regenerate the API key? The current key will immediately stop working. Any applications using the old key will need to be updated.",get actionLabel(){return e(a)},actionType:"danger",onAction:me,onCancel:()=>t(S,!1),get open(){return e(S)},set open(s){t(S,s,!0)}})}var _e=o(Y,2);{let a=D(()=>{var g;return`Are you sure you want to delete ${(g=e(r))==null?void 0:g.name}? This will permanently delete all associated data including contacts, leads, and orders. This action cannot be undone.`}),s=D(()=>e(U)?"Deleting...":"Delete");re(_e,{title:"Delete Site",get description(){return e(a)},get actionLabel(){return e(s)},actionType:"danger",onAction:pe,onCancel:()=>t(T,!1),get open(){return e(T)},set open(g){t(T,g,!0)}})}d(se,V),be(),de()}export{pt as component};
