import"../chunks/DsnmJJEf.js";import{p as xe,u as $e,b as t,s as l,i as e,f as h,d as be,l as ke,h as o,j as D,g as we,c as n,r as i,t as G,n as F}from"../chunks/DDjrJUyi.js";import{s as M}from"../chunks/CwHIudaz.js";import{f as u,a as d,c as ae}from"../chunks/DbkN8AN9.js";import{i as L}from"../chunks/CGvWOYBA.js";import{h as Ae}from"../chunks/DHP91Nzo.js";import{a as Pe,s as Se}from"../chunks/Bcmc20em.js";import{g as Ie}from"../chunks/C_3eB2yc.js";import{p as Te}from"../chunks/BtCD1IG0.js";import{g as ze,M as Ce,N as Oe,O as Re}from"../chunks/yWEY6ChK.js";import{i as re,A as De,C as Z,I as oe,B as H,e as Fe,g as Le}from"../chunks/DkmOYVX9.js";import{L as Be}from"../chunks/BWhLmYGf.js";import{S as Ke}from"../chunks/Bsa89Z5J.js";import{R as Ne}from"../chunks/Di8xpufM.js";import{T as Ue}from"../chunks/DQqcPUXs.js";var We=u("<p> </p>"),qe=u('<div class="mb-6"><!></div>'),je=u('<h2 class="text-lg font-medium text-text mb-4">General</h2> <div class="space-y-4"><div><label for="org-name" class="form-label">Workspace Name</label> <!></div> <div><label class="form-label">Slug</label> <p class="text-sm text-text-muted bg-bg-secondary px-3 py-2 rounded-md"> </p> <p class="mt-1 text-xs text-text-muted">The slug cannot be changed after creation</p></div> <div><label for="app-url" class="form-label">App URL</label> <!> <p class="mt-1 text-xs text-text-muted">Base URL of your application for confirmation links</p></div> <div class="pt-2"><!></div></div>',1),Ee=u("<!> Regenerate Key",1),Ge=u('<h2 class="text-lg font-medium text-text mb-4">API Key</h2> <p class="text-sm text-text-muted mb-4">Use this key to authenticate API requests for this workspace.</p> <div class="flex items-center gap-2 bg-bg-secondary px-3 py-2 rounded-md"><code class="flex-1 text-sm font-mono text-text break-all"> </code> <!></div> <div class="mt-4"><!></div>',1),Me=u("<!> Delete Workspace",1),Ze=u(`<h2 class="text-lg font-medium text-red-600 mb-4">Danger Zone</h2> <p class="text-sm text-text-muted mb-4">Permanently delete this workspace and all of its data including contacts, lists, and campaigns.
						This action cannot be undone.</p> <!>`,1),He=u('<div class="space-y-6"><!> <!> <!></div>'),Je=u("<!> <!> <!> <!>",1);function ut(se,le){xe(le,!0);const ne=()=>Pe(Te,"$page",ie),[ie,de]=Se();let B=l(!0),r=l(null),p=l(""),m=l(""),k=l(""),K=l(!1),T=l(!1),N=l(!1),z=l(!1),U=l(!1),A=l(!1),W=l(!1);$e(()=>{J()});async function J(){t(B,!0),t(p,"");const a=ne().params.orgSlug;if(a)try{t(r,await ze({},a),!0),t(m,e(r).name,!0),t(k,e(r).app_url||"",!0)}catch(s){console.error("Failed to load organization:",s),t(p,"Failed to load organization")}finally{t(B,!1)}}async function ce(){if(!(!e(r)||!e(m).trim())){t(K,!0),t(T,!1),t(p,"");try{await Re({},{name:e(m).trim(),app_url:e(k).trim()},e(r).id),e(r).name=e(m).trim(),e(r).app_url=e(k).trim(),localStorage.setItem("currentOrgName",e(m).trim()),t(T,!0),setTimeout(()=>{t(T,!1)},2e3)}catch(a){console.error("Failed to update organization:",a),t(p,a.message||"Failed to update organization",!0)}finally{t(K,!1)}}}function ue(){e(r)&&(navigator.clipboard.writeText(e(r).api_key),t(N,!0),setTimeout(()=>{t(N,!1)},2e3))}async function pe(){if(e(r)){t(W,!0);try{await Ce({},e(r).id),t(A,!1),await J()}catch(a){console.error("Failed to regenerate API key:",a),t(p,a.message||"Failed to regenerate API key",!0)}finally{t(W,!1)}}}async function me(){if(e(r)){t(U,!0);try{await Oe({},e(r).id),localStorage.removeItem("currentOrgId"),localStorage.removeItem("currentOrgName"),localStorage.removeItem("currentOrgSlug"),Ie("/")}catch(a){console.error("Failed to delete organization:",a),t(p,a.message||"Failed to delete organization",!0)}finally{t(U,!1)}}}var Q=Je();Ae("1b4t4qs",a=>{ke(()=>{we.title=`Workspace Settings - ${(e(r)?.name||"Loading")??""}`})});var V=h(Q);{var ge=a=>{var s=qe(),P=n(s);De(P,{type:"error",title:"Error",children:(q,C)=>{var y=We(),O=n(y,!0);i(y),G(()=>M(O,e(p))),d(q,y)},$$slots:{default:!0}}),i(s),d(a,s)};L(V,a=>{e(p)&&a(ge)})}var X=o(V,2);{var fe=a=>{Be(a,{size:"large"})},ve=a=>{var s=ae(),P=h(s);{var q=C=>{var y=He(),O=n(y);Z(O,{children:(S,te)=>{var g=je(),f=o(h(g),2),c=n(f),R=o(n(c),2);oe(R,{id:"org-name",type:"text",get value(){return e(m)},set value(b){t(m,b,!0)}}),i(c);var v=o(c,2),x=o(n(v),2),j=n(x,!0);i(x),F(2),i(v);var $=o(v,2),E=o(n($),2);oe(E,{id:"app-url",type:"text",placeholder:"https://yourapp.com",get value(){return e(k)},set value(b){t(k,b,!0)}}),F(2),i($);var _=o($,2),I=n(_);{let b=D(()=>e(m)===e(r).name&&e(k)===(e(r).app_url||""));Ke(I,{label:"Save Changes",get saving(){return e(K)},get saved(){return e(T)},onclick:ce,get disabled(){return e(b)}})}i(_),i(f),G(()=>M(j,e(r).slug)),d(S,g)},$$slots:{default:!0}});var ee=o(O,2);Z(ee,{children:(S,te)=>{var g=Ge(),f=o(h(g),4),c=n(f),R=n(c,!0);i(c);var v=o(c,2);H(v,{type:"ghost",size:"icon",onclick:ue,class:"flex-shrink-0 p-1.5 text-text-muted hover:text-text rounded transition-colors",children:($,E)=>{var _=ae(),I=h(_);{var b=w=>{Fe(w,{class:"h-4 w-4 text-green-500"})},ye=w=>{Le(w,{class:"h-4 w-4"})};L(I,w=>{e(N)?w(b):w(ye,!1)})}d($,_)},$$slots:{default:!0}}),i(f);var x=o(f,2),j=n(x);H(j,{type:"secondary",onclick:()=>t(A,!0),children:($,E)=>{var _=Ee(),I=h(_);Ne(I,{class:"mr-2 h-4 w-4"}),F(),d($,_)},$$slots:{default:!0}}),i(x),G(()=>M(R,e(r).api_key)),d(S,g)},$$slots:{default:!0}});var he=o(ee,2);Z(he,{children:(S,te)=>{var g=Ze(),f=o(h(g),4);H(f,{type:"danger",onclick:()=>t(z,!0),children:(c,R)=>{var v=Me(),x=h(v);Ue(x,{class:"mr-2 h-4 w-4"}),F(),d(c,v)},$$slots:{default:!0}}),d(S,g)},$$slots:{default:!0}}),i(y),d(C,y)};L(P,C=>{e(r)&&C(q)},!0)}d(a,s)};L(X,a=>{e(B)?a(fe):a(ve,!1)})}var Y=o(X,2);{let a=D(()=>e(W)?"Regenerating...":"Regenerate");re(Y,{title:"Regenerate API Key",description:"Are you sure you want to regenerate the API key? The current key will immediately stop working. Any applications using the old key will need to be updated.",get actionLabel(){return e(a)},actionType:"danger",onAction:pe,onCancel:()=>t(A,!1),get open(){return e(A)},set open(s){t(A,s,!0)}})}var _e=o(Y,2);{let a=D(()=>`Are you sure you want to delete ${e(r)?.name}? This will permanently delete all associated data including contacts, lists, and campaigns. This action cannot be undone.`),s=D(()=>e(U)?"Deleting...":"Delete");re(_e,{title:"Delete Workspace",get description(){return e(a)},get actionLabel(){return e(s)},actionType:"danger",onAction:me,onCancel:()=>t(z,!1),get open(){return e(z)},set open(P){t(z,P,!0)}})}d(se,Q),be(),de()}export{ut as component};
