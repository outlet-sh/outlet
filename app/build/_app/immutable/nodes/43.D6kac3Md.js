import"../chunks/DsnmJJEf.js";import{p as Ye,u as et,i as e,j as A,b as t,s as c,f as _,d as tt,l as at,h as a,g as rt,c as l,r as s,n as P,t as K}from"../chunks/DDjrJUyi.js";import{s as M}from"../chunks/CwHIudaz.js";import{f,a as d,c as De,t as T}from"../chunks/DbkN8AN9.js";import{i as E}from"../chunks/CGvWOYBA.js";import{i as lt,B as Q,o as st,A as Se,F as ot,E as it,C as ve,I as Ce,S as nt,l as dt,H as vt}from"../chunks/DkmOYVX9.js";import{h as ct}from"../chunks/DHP91Nzo.js";import{s as mt}from"../chunks/aSjiVL0V.js";import{s as ut,a as pt}from"../chunks/Bcmc20em.js";import{p as ft}from"../chunks/BtCD1IG0.js";import{g as ke}from"../chunks/C_3eB2yc.js";import{_ as _t,Z as gt,$ as xt}from"../chunks/yWEY6ChK.js";import{L as ht}from"../chunks/BWhLmYGf.js";import{B as ce}from"../chunks/42UF-HRp.js";import{A as $t}from"../chunks/D3Mqpf1w.js";import{S as bt}from"../chunks/wi6q-NiZ.js";import{T as yt}from"../chunks/DQqcPUXs.js";var wt=f('<div class="flex justify-center py-12"><!></div>'),Pt=f("<p>The requested template could not be found.</p> <!>",1),Tt=f("<!> Preview",1),Dt=f("<!> <!>",1),St=f("<p> </p>"),Ct=f('<h2 class="text-lg font-medium text-text mb-4">Settings</h2> <div class="space-y-4"><div><label for="template-name" class="form-label">Name</label> <!></div> <div><label class="form-label">Slug</label> <p class="text-sm text-text-muted bg-bg-secondary px-3 py-2 rounded-md"> </p> <p class="mt-1 text-xs text-text-muted">Cannot be changed after creation</p></div> <div><label for="template-description" class="form-label">Description</label> <!></div> <div><label for="template-category" class="form-label">Category</label> <!></div> <div class="flex items-center justify-between"><span class="text-sm text-text">Active</span> <!></div></div>',1),kt=f("<!> Delete Template",1),At=f('<h2 class="text-lg font-medium text-red-600 mb-4">Danger Zone</h2> <p class="text-sm text-text-muted mb-4">Permanently delete this template. This action cannot be undone.</p> <!>',1),Et=f('<h2 class="text-lg font-medium text-text mb-4">Email Content</h2> <!>',1),Ft=f('<div class="flex items-center gap-4 mb-6"><a class="p-2 rounded-lg hover:bg-bg-secondary transition-colors text-text-muted hover:text-text"><!></a> <div class="flex-1 flex items-center gap-3"><div class="data-table-icon"><!></div> <div><h1 class="text-2xl font-semibold text-text"> </h1> <div class="flex items-center gap-2 mt-1"><!> <!></div></div></div> <div class="flex items-center gap-2"><!> <!></div></div> <!> <div class="grid grid-cols-1 lg:grid-cols-3 gap-6"><div class="lg:col-span-1 space-y-4"><!> <!></div> <div class="lg:col-span-2"><!></div></div>',1),Bt=f('<div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"><div class="bg-bg-primary rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] flex flex-col"><div class="flex items-center justify-between p-4 border-b border-border"><h3 class="text-lg font-medium text-text"> </h3> <!></div> <div class="flex-1 overflow-auto p-4 bg-white"><!></div></div></div>'),jt=f('<div class="p-6 max-w-6xl mx-auto"><!></div> <!> <!>',1);function Xt(Ae,Ee){Ye(Ee,!0);const me=()=>pt(ft,"$page",Fe),[Fe,Be]=ut();let F=A(()=>me().params.id),Y=A(()=>`/${me().params.orgSlug}`),ee=c(!0),o=c(null),D=c(""),S=c(""),ue=c(""),L=c(""),N=c("general"),B=c(""),te=c(""),O=c(!0),R=c(!1),U=c(!1),ae=c(!1),W=c(!1),re=c(!1);const pe=[{value:"general",label:"General"},{value:"newsletter",label:"Newsletter"},{value:"promotional",label:"Promotional"},{value:"transactional",label:"Transactional"}];let je=A(()=>e(o)!==null&&(e(S)!==e(o).name||e(L)!==(e(o).description||"")||e(N)!==e(o).category||e(B)!==e(o).html_body||e(te)!==(e(o).plain_text||"")||e(O)!==e(o).is_active));et(()=>{ze()});async function ze(){if(e(F)){t(ee,!0),t(D,"");try{t(o,await _t({},e(F)),!0),t(S,e(o).name,!0),t(ue,e(o).slug,!0),t(L,e(o).description||"",!0),t(N,e(o).category,!0),t(B,e(o).html_body,!0),t(te,e(o).plain_text||"",!0),t(O,e(o).is_active,!0)}catch(r){console.error("Failed to load template:",r),t(D,"Failed to load template")}finally{t(ee,!1)}}}async function Ie(){if(!(!e(o)||!e(F)||!e(S).trim())){t(R,!0),t(U,!1),t(D,"");try{const r=await xt({},{name:e(S).trim(),description:e(L).trim()||void 0,category:e(N),html_body:e(B),plain_text:e(te)||void 0,is_active:e(O)},e(F));t(o,r,!0),t(U,!0),setTimeout(()=>{t(U,!1)},2e3)}catch(r){console.error("Failed to save template:",r),t(D,r.message||"Failed to save template",!0)}finally{t(R,!1)}}}async function He(){if(e(F)){t(re,!0);try{await gt({},e(F)),ke(`${e(Y)}/templates`)}catch(r){t(D,r.message||"Failed to delete template",!0)}finally{t(re,!1)}}}function Le(r){switch(r){case"newsletter":return"info";case"promotional":return"warning";case"transactional":return"success";default:return"default"}}function Ne(r){return pe.find(g=>g.value===r)?.label||r}var fe=jt();ct("t3hfna",r=>{at(()=>{rt.title=`${(e(o)?.name||"Template")??""} | Outlet`})});var le=_(fe),Oe=l(le);{var Ze=r=>{var u=wt(),g=l(u);ht(g,{size:"large"}),s(u),d(r,u)},qe=r=>{var u=De(),g=_(u);{var Z=$=>{Se($,{type:"error",title:"Template not found",children:(j,C)=>{var x=Pt(),G=a(_(x),2);Q(G,{type:"primary",class:"mt-3",onclick:()=>ke(`${e(Y)}/templates`),children:(z,I)=>{P();var se=T("Back to Templates");d(z,se)},$$slots:{default:!0}}),d(j,x)},$$slots:{default:!0}})},q=$=>{var j=Ft(),C=_(j),x=l(C),G=l(x);$t(G,{class:"h-5 w-5"}),s(x);var z=a(x,2),I=l(z),se=l(I);ot(se,{class:"h-5 w-5"}),s(I);var ge=a(I,2),oe=l(ge),Je=l(oe,!0);s(oe);var xe=a(oe,2),he=l(xe);{let i=A(()=>Le(e(o).category));ce(he,{get variant(){return e(i)},size:"sm",children:(p,v)=>{P();var n=T();K(m=>M(n,m),[()=>Ne(e(o).category)]),d(p,n)},$$slots:{default:!0}})}var Ke=a(he,2);{var Me=i=>{ce(i,{variant:"success",size:"sm",children:(p,v)=>{P();var n=T("Active");d(p,n)},$$slots:{default:!0}})},Qe=i=>{ce(i,{variant:"default",size:"sm",children:(p,v)=>{P();var n=T("Inactive");d(p,n)},$$slots:{default:!0}})};E(Ke,i=>{e(o).is_active?i(Me):i(Qe,!1)})}s(xe),s(ge),s(z);var $e=a(z,2),be=l($e);Q(be,{type:"secondary",onclick:()=>t(ae,!0),children:(i,p)=>{var v=Tt(),n=_(v);it(n,{class:"mr-2 h-4 w-4"}),P(),d(i,v)},$$slots:{default:!0}});var Re=a(be,2);{let i=A(()=>e(R)||!e(je));Q(Re,{type:"primary",onclick:Ie,get disabled(){return e(i)},children:(p,v)=>{var n=Dt(),m=_(n);bt(m,{class:"mr-2 h-4 w-4"});var X=a(m,2);{var b=y=>{var w=T("Saving...");d(y,w)},H=y=>{var w=De(),ne=_(w);{var V=h=>{var J=T("Saved!");d(h,J)},de=h=>{var J=T("Save");d(h,J)};E(ne,h=>{e(U)?h(V):h(de,!1)},!0)}d(y,w)};E(X,y=>{e(R)?y(b):y(H,!1)})}d(p,n)},$$slots:{default:!0}})}s($e),s(C);var ye=a(C,2);{var Ue=i=>{Se(i,{type:"error",title:"Error",class:"mb-4",children:(p,v)=>{var n=St(),m=l(n,!0);s(n),K(()=>M(m,e(D))),d(p,n)},$$slots:{default:!0}})};E(ye,i=>{e(D)&&i(Ue)})}var we=a(ye,2),ie=l(we),Pe=l(ie);ve(Pe,{children:(i,p)=>{var v=Ct(),n=a(_(v),2),m=l(n),X=a(l(m),2);Ce(X,{id:"template-name",type:"text",get value(){return e(S)},set value(k){t(S,k,!0)}}),s(m);var b=a(m,2),H=a(l(b),2),y=l(H,!0);s(H),P(2),s(b);var w=a(b,2),ne=a(l(w),2);Ce(ne,{id:"template-description",type:"text",placeholder:"Optional description",get value(){return e(L)},set value(k){t(L,k,!0)}}),s(w);var V=a(w,2),de=a(l(V),2);nt(de,{id:"template-category",get options(){return pe},get value(){return e(N)},set value(k){t(N,k,!0)}}),s(V);var h=a(V,2),J=a(l(h),2);dt(J,{get checked(){return e(O)},set checked(k){t(O,k,!0)}}),s(h),s(n),K(()=>M(y,e(ue))),d(i,v)},$$slots:{default:!0}});var We=a(Pe,2);ve(We,{children:(i,p)=>{var v=At(),n=a(_(v),4);Q(n,{type:"danger",onclick:()=>t(W,!0),children:(m,X)=>{var b=kt(),H=_(b);yt(H,{class:"mr-2 h-4 w-4"}),P(),d(m,b)},$$slots:{default:!0}}),d(i,v)},$$slots:{default:!0}}),s(ie);var Te=a(ie,2),Xe=l(Te);ve(Xe,{class:"h-full",children:(i,p)=>{var v=Et(),n=a(_(v),2);vt(n,{placeholder:"Start designing your email...",minHeight:"400px",get value(){return e(B)},set value(m){t(B,m,!0)}}),d(i,v)},$$slots:{default:!0}}),s(Te),s(we),K(()=>{mt(x,"href",`${e(Y)??""}/templates`),M(Je,e(o).name)}),d($,j)};E(g,$=>{e(o)?$(q,!1):$(Z)},!0)}d(r,u)};E(Oe,r=>{e(ee)?r(Ze):r(qe,!1)})}s(le);var _e=a(le,2);{var Ge=r=>{var u=Bt(),g=l(u),Z=l(g),q=l(Z),$=l(q);s(q);var j=a(q,2);Q(j,{type:"secondary",onclick:()=>t(ae,!1),children:(G,z)=>{P();var I=T("Close");d(G,I)},$$slots:{default:!0}}),s(Z);var C=a(Z,2),x=l(C);st(x,()=>e(B)),s(C),s(g),s(u),K(()=>M($,`Preview: ${e(S)??""}`)),d(r,u)};E(_e,r=>{e(ae)&&e(o)&&r(Ge)})}var Ve=a(_e,2);{let r=A(()=>`Are you sure you want to delete "${e(o)?.name}"? This action cannot be undone.`),u=A(()=>e(re)?"Deleting...":"Delete");lt(Ve,{title:"Delete Template",get description(){return e(r)},get actionLabel(){return e(u)},actionType:"danger",onAction:He,onCancel:()=>t(W,!1),get open(){return e(W)},set open(g){t(W,g,!0)}})}d(Ae,fe),tt(),Be()}export{Xt as component};
