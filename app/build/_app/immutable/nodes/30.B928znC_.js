import"../chunks/DsnmJJEf.js";import{p as Re,s as v,a as Qe,u as Ve,b as r,f as M,d as Ge,e as He,i as e,h as l,c as s,n as k,t as B,j as P,g as Je,r as a}from"../chunks/odI--4Kw.js";import{s as I}from"../chunks/BNMK9zrr.js";import{a as n,f as p,t as re,c as Ke}from"../chunks/CCInJaqd.js";import{i as S}from"../chunks/COaB7F5h.js";import{e as We,s as Xe,i as Ye}from"../chunks/BohEjZuL.js";import{h as Ze}from"../chunks/hUjpWz_l.js";import{s as et,a as tt}from"../chunks/DL1yFSKa.js";import{p as rt}from"../chunks/Wl_A6iPG.js";import{g as fe}from"../chunks/J_BT3AZT.js";import{t as at,C as st,D as lt}from"../chunks/CbJUEE85.js";import{B as Q,M as ot,g as it,I as ae,c as nt,A as dt,D as ct,i as vt}from"../chunks/CKHj2K0U.js";import{E as ut}from"../chunks/CF2FnicU.js";import{L as pt}from"../chunks/D716f0vp.js";import{B as mt}from"../chunks/BD7k7D4N.js";import{P as ge}from"../chunks/vPkRyia_.js";import{M as ft}from"../chunks/_cZI0v7b.js";import{U as gt}from"../chunks/Dxq8Hv-0.js";import{E as _t}from"../chunks/D9RG3a0A.js";import{S as xt}from"../chunks/CW92f3Ai.js";import{E as ht}from"../chunks/CnqfCpUb.js";import{T as bt}from"../chunks/Cu0Q0NU6.js";var $t=p("<!> New List",1),yt=p("<p> </p>"),wt=p("<!> <!>",1),Lt=p('<div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><div><label for="list-name" class="form-label">Name</label> <!></div> <div><label for="list-slug" class="form-label">Slug</label> <!> <p class="mt-1 text-xs text-text-muted">Used in URLs and API</p></div> <div class="sm:col-span-2"><label for="list-description" class="form-label">Description (optional)</label> <!></div> <div class="sm:col-span-2"><!> <p class="text-xs text-text-muted mt-1 ml-6">Subscribers must confirm their email before being added</p></div></div>'),Ct=p('<div class="flex justify-center py-12"><!></div>'),Dt=p("<!> Create List",1),kt=p('<div class="mb-4"><!></div>'),Pt=p('<p class="text-sm text-text-muted truncate"> </p>'),St=p('<tr><td><a class="block group"><div class="flex items-center gap-3"><div class="data-table-icon"><!></div> <div class="min-w-0 flex-1"><div class="flex items-center gap-2 flex-wrap"><span class="font-medium text-text group-hover:text-primary transition-colors"> </span> <!></div> <!></div></div></a></td><td class="text-right"><span class="text-lg font-semibold text-text"> </span></td><td class="text-right"><!></td></tr>'),Ft=p('<div class="text-center py-8 text-text-muted"> </div>'),Et=p('<!> <div class="data-table"><table class="w-full"><thead><tr><th class="text-left">List</th><th class="text-right">Subscribers</th><th class="text-right w-10"></th></tr></thead><tbody></tbody></table></div> <!>',1),Nt=p('<div class="p-6 max-w-5xl mx-auto"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6"><div><h1 class="text-2xl font-semibold text-text">Lists</h1> <p class="mt-1 text-sm text-text-muted">Manage your email subscriber lists</p></div> <!></div> <!> <!> <!></div> <!>',1);function tr(_e,xe){Re(xe,!0);const he=()=>tt(rt,"$page",be),[be,$e]=et();let V=v(!0),T=v(Qe([])),y=v(""),F=v(""),U=v(!1),A=v(!1),w=v(""),L=v(""),j=v(""),q=v(!0),G=P(()=>`/${he().params.brandSlug}`),se=P(()=>e(T).filter(t=>t.name.toLowerCase().includes(e(F).toLowerCase())||t.slug.toLowerCase().includes(e(F).toLowerCase())));Ve(()=>{H()});async function H(){r(V,!0),r(y,"");try{const t=await at();r(T,t.lists||[],!0)}catch(t){console.error("Failed to load lists:",t),r(y,"Failed to load email lists")}finally{r(V,!1)}}function le(){r(w,""),r(L,""),r(j,""),r(q,!0),r(U,!0)}function oe(){r(U,!1)}function ye(t){return t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function we(){r(L,ye(e(w)),!0)}async function Le(){if(!(!e(w)||!e(L))){r(A,!0),r(y,"");try{await lt({name:e(w),slug:e(L),description:e(j),double_optin:e(q)}),oe(),await H()}catch(t){console.error("Failed to create list:",t),r(y,t.message||"Failed to create list",!0)}finally{r(A,!1)}}}let O=v(!1),R=v(null),J=v(!1);function Ce(t){r(R,t,!0),r(O,!0)}async function De(){if(e(R)){r(J,!0);try{await st({},e(R).id),await H()}catch(t){console.error("Failed to delete list:",t),r(y,t.message||"Failed to delete list",!0)}finally{r(J,!1)}}}var ie=Nt();Ze("1ln5t19",t=>{He(()=>{Je.title="Lists | Outlet"})});var K=M(ie),W=s(K),ke=l(s(W),2);Q(ke,{type:"primary",onclick:le,children:(t,o)=>{var c=$t(),d=M(c);ge(d,{class:"mr-2 h-4 w-4"}),k(),n(t,c)},$$slots:{default:!0}}),a(W);var ne=l(W,2);{var Pe=t=>{dt(t,{type:"error",title:"Error",class:"mb-4",children:(o,c)=>{var d=yt(),g=s(d,!0);a(d),B(()=>I(g,e(y))),n(o,d)},$$slots:{default:!0}})};S(ne,t=>{e(y)&&t(Pe)})}var de=l(ne,2);ot(de,{title:"Create New List",size:"md",get show(){return e(U)},set show(o){r(U,o,!0)},footer:o=>{var c=wt(),d=M(c);Q(d,{type:"secondary",onclick:oe,get disabled(){return e(A)},children:(u,m)=>{k();var b=re("Cancel");n(u,b)},$$slots:{default:!0}});var g=l(d,2);{let u=P(()=>!e(w)||!e(L)||e(A));Q(g,{type:"primary",onclick:Le,get disabled(){return e(u)},children:(m,b)=>{k();var f=re();B(()=>I(f,e(A)?"Creating...":"Create List")),n(m,f)},$$slots:{default:!0}})}n(o,c)},children:(o,c)=>{var d=Lt(),g=s(d),u=l(s(g),2);ae(u,{id:"list-name",type:"text",oninput:we,placeholder:"Newsletter",get value(){return e(w)},set value(_){r(w,_,!0)}}),a(g);var m=l(g,2),b=l(s(m),2);ae(b,{id:"list-slug",type:"text",placeholder:"newsletter",get value(){return e(L)},set value(_){r(L,_,!0)}}),k(2),a(m);var f=l(m,2),E=l(s(f),2);ae(E,{id:"list-description",type:"text",placeholder:"Main newsletter for product updates",get value(){return e(j)},set value(_){r(j,_,!0)}}),a(f);var $=l(f,2),N=s($);nt(N,{label:"Require double opt-in",get checked(){return e(q)},set checked(_){r(q,_,!0)}}),k(2),a($),a(d),n(o,d)},$$slots:{footer:!0,default:!0}});var Se=l(de,2);{var Fe=t=>{var o=Ct(),c=s(o);pt(c,{size:"large"}),a(o),n(t,o)},Ee=t=>{var o=Ke(),c=M(o);{var d=u=>{ut(u,{get icon(){return ft},title:"No lists yet",description:"Create your first email list to start collecting subscribers.",children:(m,b)=>{Q(m,{type:"primary",onclick:le,children:(f,E)=>{var $=Dt(),N=M($);ge(N,{class:"mr-2 h-4 w-4"}),k(),n(f,$)},$$slots:{default:!0}})},$$slots:{default:!0}})},g=u=>{var m=Et(),b=M(m);{var f=x=>{var i=kt(),C=s(i);vt(C,{placeholder:"Search lists...",get value(){return e(F)},set value(z){r(F,z,!0)}}),a(i),n(x,i)};S(b,x=>{e(T).length>3&&x(f)})}var E=l(b,2),$=s(E),N=l(s($));We(N,21,()=>e(se),Ye,(x,i)=>{var C=St(),z=s(C),X=s(z),ce=s(X),Y=s(ce),Ie=s(Y);gt(Ie,{class:"h-4 w-4"}),a(Y);var ve=l(Y,2),Z=s(ve),ee=s(Z),Ae=s(ee,!0);a(ee);var ze=l(ee,2);{var Be=h=>{mt(h,{variant:"info",size:"sm",children:(D,me)=>{k();var Oe=re("Double opt-in");n(D,Oe)},$$slots:{default:!0}})};S(ze,h=>{e(i).double_optin&&h(Be)})}a(Z);var Te=l(Z,2);{var Ue=h=>{var D=Pt(),me=s(D,!0);a(D),B(()=>I(me,e(i).description)),n(h,D)};S(Te,h=>{e(i).description&&h(Ue)})}a(ve),a(ce),a(X),a(z);var te=l(z),ue=s(te),je=s(ue,!0);a(ue),a(te);var pe=l(te),qe=s(pe);{let h=P(()=>({icon:_t,class:"p-1.5 rounded-lg hover:bg-bg-secondary transition-colors text-text-muted hover:text-text"})),D=P(()=>[{label:"Edit",icon:xt,onclick:()=>fe(`${e(G)}/lists/${e(i).id}`)},{label:"View subscribers",icon:ht,onclick:()=>fe(`${e(G)}/lists/${e(i).id}/subscribers`)},{divider:!0},{label:"Delete",icon:bt,variant:"danger",onclick:()=>Ce(e(i))}]);ct(qe,{get trigger(){return e(h)},get items(){return e(D)}})}a(pe),a(C),B(()=>{Xe(X,"href",`${e(G)??""}/lists/${e(i).id??""}`),I(Ae,e(i).name),I(je,e(i).subscriber_count||0)}),n(x,C)}),a(N),a($),a(E);var _=l(E,2);{var Me=x=>{var i=Ft(),C=s(i);a(i),B(()=>I(C,`No lists match "${e(F)??""}"`)),n(x,i)};S(_,x=>{e(F)&&e(se).length===0&&x(Me)})}n(u,m)};S(c,u=>{e(T).length===0?u(d):u(g,!1)},!0)}n(t,o)};S(Se,t=>{e(V)?t(Fe):t(Ee,!1)})}a(K);var Ne=l(K,2);{let t=P(()=>`Delete "${e(R)?.name||""}"? This cannot be undone.`),o=P(()=>e(J)?"Deleting...":"Delete");it(Ne,{title:"Delete List",get description(){return e(t)},get actionLabel(){return e(o)},actionType:"danger",onAction:De,onCancel:()=>r(O,!1),get open(){return e(O)},set open(c){r(O,c,!0)}})}n(_e,ie),Ge(),$e()}export{tr as component};
