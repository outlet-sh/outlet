import"../chunks/DsnmJJEf.js";import{p as Be,s as f,a as Ue,u as Ae,b as s,d as Te,e as qe,f as j,i as e,h as o,c as a,n as P,t as z,j as B,g as Oe,r}from"../chunks/odI--4Kw.js";import{s as N}from"../chunks/BNMK9zrr.js";import{a as n,f as v,t as Z,c as Re}from"../chunks/CCInJaqd.js";import{i as S}from"../chunks/COaB7F5h.js";import{e as Qe,s as Ve,i as Ge}from"../chunks/BohEjZuL.js";import{h as He}from"../chunks/hUjpWz_l.js";import{s as Je,a as Ke}from"../chunks/DL1yFSKa.js";import{p as We}from"../chunks/Ccyv4eTX.js";import{g as ve}from"../chunks/H1ysZjBy.js";import{w as Xe,C as Ye,D as Ze}from"../chunks/cAHYBDdg.js";import{B as O,M as et,I as ee,c as tt,A as rt,D as at,j as st}from"../chunks/dP3ShF3Y.js";import{E as ot}from"../chunks/Dk-zchtc.js";import{L as lt}from"../chunks/D716f0vp.js";import{B as it}from"../chunks/BD7k7D4N.js";import{P as ue}from"../chunks/Dwj61qEl.js";import{M as nt}from"../chunks/DFQgqfc1.js";import{U as dt}from"../chunks/B6N_F_tn.js";import{E as ct}from"../chunks/BKIfp2DD.js";import{S as vt}from"../chunks/ntfkMumX.js";import{E as ut}from"../chunks/B-2teBlu.js";import{T as pt}from"../chunks/B7s8uui8.js";var mt=v("<!> New List",1),ft=v("<p> </p>"),_t=v("<!> <!>",1),gt=v('<div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><div><label for="list-name" class="form-label">Name</label> <!></div> <div><label for="list-slug" class="form-label">Slug</label> <!> <p class="mt-1 text-xs text-text-muted">Used in URLs and API</p></div> <div class="sm:col-span-2"><label for="list-description" class="form-label">Description (optional)</label> <!></div> <div class="sm:col-span-2"><!> <p class="text-xs text-text-muted mt-1 ml-6">Subscribers must confirm their email before being added</p></div></div>'),xt=v('<div class="flex justify-center py-12"><!></div>'),ht=v("<!> Create List",1),bt=v('<div class="mb-4"><!></div>'),$t=v('<p class="text-sm text-text-muted truncate"> </p>'),wt=v('<tr><td><a class="block group"><div class="flex items-center gap-3"><div class="data-table-icon"><!></div> <div class="min-w-0 flex-1"><div class="flex items-center gap-2 flex-wrap"><span class="font-medium text-text group-hover:text-primary transition-colors"> </span> <!></div> <!></div></div></a></td><td class="text-right"><span class="text-lg font-semibold text-text"> </span></td><td class="text-right"><!></td></tr>'),yt=v('<div class="text-center py-8 text-text-muted"> </div>'),Lt=v('<!> <div class="data-table"><table class="w-full"><thead><tr><th class="text-left">List</th><th class="text-right">Subscribers</th><th class="text-right w-10"></th></tr></thead><tbody></tbody></table></div> <!>',1),Ct=v('<div class="p-6 max-w-5xl mx-auto"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6"><div><h1 class="text-2xl font-semibold text-text">Lists</h1> <p class="mt-1 text-sm text-text-muted">Manage your email subscriber lists</p></div> <!></div> <!> <!> <!></div>');function Jt(pe,me){Be(me,!0);const fe=()=>Ke(We,"$page",_e),[_e,ge]=Je();let R=f(!0),U=f(Ue([])),w=f(""),D=f(""),A=f(!1),M=f(!1),y=f(""),L=f(""),T=f(""),q=f(!0),Q=B(()=>`/${fe().params.brandSlug}`),te=B(()=>e(U).filter(t=>t.name.toLowerCase().includes(e(D).toLowerCase())||t.slug.toLowerCase().includes(e(D).toLowerCase())));Ae(()=>{V()});async function V(){s(R,!0),s(w,"");try{const t=await Xe();s(U,t.lists||[],!0)}catch(t){console.error("Failed to load lists:",t),s(w,"Failed to load email lists")}finally{s(R,!1)}}function re(){s(y,""),s(L,""),s(T,""),s(q,!0),s(A,!0)}function ae(){s(A,!1)}function xe(t){return t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function he(){s(L,xe(e(y)),!0)}async function be(){if(!(!e(y)||!e(L))){s(M,!0),s(w,"");try{await Ye({name:e(y),slug:e(L),description:e(T),double_optin:e(q)}),ae(),await V()}catch(t){console.error("Failed to create list:",t),s(w,t.message||"Failed to create list",!0)}finally{s(M,!1)}}}async function $e(t){if(confirm(`Delete "${t.name}"? This cannot be undone.`))try{await Ze({},t.id),await V()}catch(l){console.error("Failed to delete list:",l),s(w,l.message||"Failed to delete list",!0)}}var G=Ct();He("1ln5t19",t=>{qe(()=>{Oe.title="Lists | Outlet"})});var H=a(G),we=o(a(H),2);O(we,{type:"primary",onclick:re,children:(t,l)=>{var u=mt(),d=j(u);ue(d,{class:"mr-2 h-4 w-4"}),P(),n(t,u)},$$slots:{default:!0}}),r(H);var se=o(H,2);{var ye=t=>{rt(t,{type:"error",title:"Error",class:"mb-4",children:(l,u)=>{var d=ft(),_=a(d,!0);r(d),z(()=>N(_,e(w))),n(l,d)},$$slots:{default:!0}})};S(se,t=>{e(w)&&t(ye)})}var oe=o(se,2);et(oe,{title:"Create New List",size:"md",get show(){return e(A)},set show(l){s(A,l,!0)},footer:l=>{var u=_t(),d=j(u);O(d,{type:"secondary",onclick:ae,get disabled(){return e(M)},children:(c,p)=>{P();var b=Z("Cancel");n(c,b)},$$slots:{default:!0}});var _=o(d,2);{let c=B(()=>!e(y)||!e(L)||e(M));O(_,{type:"primary",onclick:be,get disabled(){return e(c)},children:(p,b)=>{P();var m=Z();z(()=>N(m,e(M)?"Creating...":"Create List")),n(p,m)},$$slots:{default:!0}})}n(l,u)},children:(l,u)=>{var d=gt(),_=a(d),c=o(a(_),2);ee(c,{id:"list-name",type:"text",oninput:he,placeholder:"Newsletter",get value(){return e(y)},set value(g){s(y,g,!0)}}),r(_);var p=o(_,2),b=o(a(p),2);ee(b,{id:"list-slug",type:"text",placeholder:"newsletter",get value(){return e(L)},set value(g){s(L,g,!0)}}),P(2),r(p);var m=o(p,2),F=o(a(m),2);ee(F,{id:"list-description",type:"text",placeholder:"Main newsletter for product updates",get value(){return e(T)},set value(g){s(T,g,!0)}}),r(m);var $=o(m,2),E=a($);tt(E,{label:"Require double opt-in",get checked(){return e(q)},set checked(g){s(q,g,!0)}}),P(2),r($),r(d),n(l,d)},$$slots:{footer:!0,default:!0}});var Le=o(oe,2);{var Ce=t=>{var l=xt(),u=a(l);lt(u,{size:"large"}),r(l),n(t,l)},ke=t=>{var l=Re(),u=j(l);{var d=c=>{ot(c,{get icon(){return nt},title:"No lists yet",description:"Create your first email list to start collecting subscribers.",children:(p,b)=>{O(p,{type:"primary",onclick:re,children:(m,F)=>{var $=ht(),E=j($);ue(E,{class:"mr-2 h-4 w-4"}),P(),n(m,$)},$$slots:{default:!0}})},$$slots:{default:!0}})},_=c=>{var p=Lt(),b=j(p);{var m=x=>{var i=bt(),C=a(i);st(C,{placeholder:"Search lists...",get value(){return e(D)},set value(I){s(D,I,!0)}}),r(i),n(x,i)};S(b,x=>{e(U).length>3&&x(m)})}var F=o(b,2),$=a(F),E=o(a($));Qe(E,21,()=>e(te),Ge,(x,i)=>{var C=wt(),I=a(C),J=a(I),le=a(J),K=a(le),Se=a(K);dt(Se,{class:"h-4 w-4"}),r(K);var ie=o(K,2),W=a(ie),X=a(W),De=a(X,!0);r(X);var Fe=o(X,2);{var Ee=h=>{it(h,{variant:"info",size:"sm",children:(k,ce)=>{P();var ze=Z("Double opt-in");n(k,ze)},$$slots:{default:!0}})};S(Fe,h=>{e(i).double_optin&&h(Ee)})}r(W);var Ne=o(W,2);{var Me=h=>{var k=$t(),ce=a(k,!0);r(k),z(()=>N(ce,e(i).description)),n(h,k)};S(Ne,h=>{e(i).description&&h(Me)})}r(ie),r(le),r(J),r(I);var Y=o(I),ne=a(Y),Ie=a(ne,!0);r(ne),r(Y);var de=o(Y),je=a(de);{let h=B(()=>({icon:ct,class:"p-1.5 rounded-lg hover:bg-bg-secondary transition-colors text-text-muted hover:text-text"})),k=B(()=>[{label:"Edit",icon:vt,onclick:()=>ve(`${e(Q)}/lists/${e(i).id}`)},{label:"View subscribers",icon:ut,onclick:()=>ve(`${e(Q)}/lists/${e(i).id}/subscribers`)},{divider:!0},{label:"Delete",icon:pt,variant:"danger",onclick:()=>$e(e(i))}]);at(je,{get trigger(){return e(h)},get items(){return e(k)}})}r(de),r(C),z(()=>{Ve(J,"href",`${e(Q)??""}/lists/${e(i).id??""}`),N(De,e(i).name),N(Ie,e(i).subscriber_count||0)}),n(x,C)}),r(E),r($),r(F);var g=o(F,2);{var Pe=x=>{var i=yt(),C=a(i);r(i),z(()=>N(C,`No lists match "${e(D)??""}"`)),n(x,i)};S(g,x=>{e(D)&&e(te).length===0&&x(Pe)})}n(c,p)};S(u,c=>{e(U).length===0?c(d):c(_,!1)},!0)}n(t,l)};S(Le,t=>{e(R)?t(Ce):t(ke,!1)})}r(G),n(pe,G),Te(),ge()}export{Jt as component};
