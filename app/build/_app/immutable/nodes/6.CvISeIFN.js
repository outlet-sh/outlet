import"../chunks/DsnmJJEf.js";import{f as Y,p as lt,u as Te,b as s,c as a,i as e,r as t,h as r,t as $,j as ie,d as nt,s as U,n as ne,a as Qe,m as Pt,$ as Nt,g as Mt}from"../chunks/odI--4Kw.js";import{d as it,s as w,e as jt}from"../chunks/BNMK9zrr.js";import{s as Ut}from"../chunks/C07Dfx-t.js";import{l as Le,s as Ee,p as At,i as z,c as Ve}from"../chunks/COaB7F5h.js";import{e as $e,s as X,a as ve,i as ke}from"../chunks/BohEjZuL.js";import{c as ue,a as n,f as u,t as Ae}from"../chunks/CCInJaqd.js";import{h as Tt}from"../chunks/hUjpWz_l.js";import{s as dt,a as ct}from"../chunks/DL1yFSKa.js";import{g as ce}from"../chunks/Cw8GvGRZ.js";import{p as vt}from"../chunks/B9wg8JQw.js";import"../chunks/B9hjHVe6.js";import{a as Re,s as Fe,F as Lt,M as Et,I as Ze,B as et,A as Rt,X as Ft,h as tt}from"../chunks/C9m1dhUm.js";import{S as Gt}from"../chunks/B8f8Lr73.js";import{U as qt}from"../chunks/Cj9qDFvY.js";import{T as Dt}from"../chunks/BNdV4B7Z.js";import{S as Ht}from"../chunks/Cpkp7EWG.js";import{M as at}from"../chunks/CmCLcznS.js";import{C as Kt}from"../chunks/BJ9FW6bW.js";import{A as Wt}from"../chunks/Cnxj00C8.js";import{j as Xt,l as Yt,c as Jt}from"../chunks/BYFcJoO7.js";import{g as Qt,l as Vt}from"../chunks/CuiFJ7Vr.js";import{C as rt}from"../chunks/DK_z3urS.js";import{M as Zt}from"../chunks/DbBBAHYx.js";import{P as st}from"../chunks/Cmj1ijxE.js";function ea(E,b){const R=Le(b,["children","$$slots","$$events","$$legacy"]);const q=[["path",{d:"M4.929 4.929 19.07 19.071"}],["circle",{cx:"12",cy:"12",r:"10"}]];Re(E,Ee({name:"ban"},()=>R,{get iconNode(){return q},children:(D,m)=>{var k=ue(),c=Y(k);Fe(c,b,"default",{}),n(D,k)},$$slots:{default:!0}}))}function ta(E,b){const R=Le(b,["children","$$slots","$$events","$$legacy"]);const q=[["path",{d:"m15 18-6-6 6-6"}]];Re(E,Ee({name:"chevron-left"},()=>R,{get iconNode(){return q},children:(D,m)=>{var k=ue(),c=Y(k);Fe(c,b,"default",{}),n(D,k)},$$slots:{default:!0}}))}function aa(E,b){const R=Le(b,["children","$$slots","$$events","$$legacy"]);const q=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1"}]];Re(E,Ee({name:"layout-dashboard"},()=>R,{get iconNode(){return q},children:(D,m)=>{var k=ue(),c=Y(k);Fe(c,b,"default",{}),n(D,k)},$$slots:{default:!0}}))}const ra=async({params:E})=>({brandSlug:E.brandSlug}),Qa=Object.freeze(Object.defineProperty({__proto__:null,load:ra},Symbol.toStringTag,{value:"Module"}));var sa=u('<a class="sidebar-brand"><!> <span class="sidebar-brand-text"> </span></a>'),oa=u('<a class="sidebar-brand-icon"><!></a>'),la=u('<span class="sidebar-label"> </span>'),na=u("<a><!> <!></a>"),ia=u('<span class="sidebar-label"> </span>'),da=u("<a><!> <!></a>"),ca=u('<!> <span class="sidebar-label">Collapse</span>',1),va=u('<aside><div class="sidebar-header"><!></div> <nav class="sidebar-nav"></nav> <div class="flex-1"></div> <nav class="sidebar-nav sidebar-nav-bottom"><!> <button class="sidebar-collapse-btn"><!></button></nav></aside>');function ot(E,b){lt(b,!0);const R=()=>ct(vt,"$page",q),[q,D]=dt(),m=At(b,"orgName",3,"Outlet"),k="sidebar-collapsed";let c=U(!1);Te(()=>{{const d=localStorage.getItem(k);s(c,d==="true")}});function se(){s(c,!e(c)),localStorage.setItem(k,String(e(c)))}let S=ie(()=>`/${b.brandSlug}`);const H=[{id:"dashboard",label:"Dashboard",href:"",icon:aa,exact:!0},{id:"campaigns",label:"Campaigns",href:"/campaigns",icon:Gt},{id:"lists",label:"Lists",href:"/lists",icon:qt},{id:"templates",label:"Templates",href:"/templates",icon:Lt},{id:"housekeeping",label:"Housekeeping",href:"/housekeeping",icon:Dt},{id:"blocklist",label:"Blocklist",href:"/blocklist",icon:ea}],M=[{id:"settings",label:"Settings",href:"/settings",icon:Ht}];function I(d,l=!1){const x=`${e(S)}${d}`;return l?R().url.pathname===x||R().url.pathname===x+"/":R().url.pathname.startsWith(x)&&x!==e(S)}var F=va();let G;var A=a(F),Z=a(A);{var ee=d=>{var l=sa(),x=a(l);at(x,{class:"h-6 w-6 text-primary"});var h=r(x,2),i=a(h,!0);t(h),t(l),$(()=>{X(l,"href",e(S)),w(i,m())}),n(d,l)},Se=d=>{var l=oa(),x=a(l);at(x,{class:"h-6 w-6 text-primary"}),t(l),$(()=>X(l,"href",e(S))),n(d,l)};z(Z,d=>{e(c)?d(Se,!1):d(ee)})}t(A);var oe=r(A,2);$e(oe,21,()=>H,ke,(d,l)=>{const x=ie(()=>e(l).icon);var h=na();let i;var p=a(h);Ve(p,()=>e(x),(v,g)=>{g(v,{class:"sidebar-icon"})});var T=r(p,2);{var L=v=>{var g=la(),y=a(g,!0);t(g),$(()=>w(y,e(l).label)),n(v,g)};z(T,v=>{e(c)||v(L)})}t(h),$(v=>{X(h,"href",`${e(S)??""}${e(l).href??""}`),i=ve(h,1,"sidebar-link",null,i,v),X(h,"title",e(c)?e(l).label:void 0)},[()=>({active:I(e(l).href,e(l).exact)})]),n(d,h)}),t(oe);var de=r(oe,4),be=a(de);$e(be,17,()=>M,ke,(d,l)=>{const x=ie(()=>e(l).icon);var h=da();let i;var p=a(h);Ve(p,()=>e(x),(v,g)=>{g(v,{class:"sidebar-icon"})});var T=r(p,2);{var L=v=>{var g=ia(),y=a(g,!0);t(g),$(()=>w(y,e(l).label)),n(v,g)};z(T,v=>{e(c)||v(L)})}t(h),$(v=>{X(h,"href",`${e(S)??""}${e(l).href??""}`),i=ve(h,1,"sidebar-link",null,i,v),X(h,"title",e(c)?e(l).label:void 0)},[()=>({active:I(e(l).href)})]),n(d,h)});var te=r(be,2);te.__click=se;var Oe=a(te);{var Ce=d=>{Kt(d,{class:"h-4 w-4"})},me=d=>{var l=ca(),x=Y(l);ta(x,{class:"h-4 w-4"}),ne(2),n(d,l)};z(Oe,d=>{e(c)?d(Ce):d(me,!1)})}t(te),t(de),t(F),$(()=>{G=ve(F,1,"sidebar",null,G,{collapsed:e(c)}),X(te,"title",e(c)?"Expand sidebar":"Collapse sidebar")}),n(E,F),nt(),D()}it(["click"]);var ua=u('<meta name="robots" content="noindex, nofollow"/>'),ba=u('<div class="min-h-screen bg-base-50 flex items-center justify-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),ma=u('<div class="min-h-screen bg-base-50 flex items-center justify-center"><div class="text-error"> </div></div>'),fa=u('<button><span class="flex-1 text-sm font-medium text-text truncate"> </span> <!></button>'),pa=u('<div class="absolute left-1/2 -translate-x-1/2 top-full mt-2 w-64 rounded-lg shadow-lg py-1 z-50 bg-white border border-base-200"><div class="px-3 py-2 border-b border-border"><p class="text-xs font-medium text-text-muted uppercase tracking-wide">Brands</p></div> <div class="max-h-64 overflow-y-auto"></div> <div class="border-t border-border mt-1 pt-1"><button class="w-full px-3 py-2 flex items-center gap-2 text-left transition-colors hover:bg-base-100 text-text-muted hover:text-text"><!> <span class="text-sm">Add brand</span></button></div></div>'),ga=u('<div class="absolute right-0 top-full mt-2 w-56 rounded-lg shadow-lg py-1 z-50 bg-white border border-base-200"><div class="px-4 py-3 border-b border-border"><p class="text-sm font-medium text-text truncate"> </p></div> <a class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900">Settings</a> <div class="border-t border-border my-1"></div> <button class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900 w-full text-left">Switch Brand</button> <button class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900 w-full text-left">Sign out</button></div>'),_a=u('<div class="fixed inset-0 z-40 bg-black/50 md:hidden" role="button" tabindex="-1"></div> <div class="fixed inset-y-0 left-0 z-50 w-[220px] md:hidden"><!></div>',1),xa=u('<button><span class="flex-1 text-sm font-medium text-text truncate"> </span> <!></button>'),ha=u('<div class="absolute right-0 top-full mt-2 w-64 rounded-lg shadow-lg py-1 z-50 bg-white border border-base-200"><div class="px-3 py-2 border-b border-border"><p class="text-xs font-medium text-text-muted uppercase tracking-wide">Brands</p></div> <div class="max-h-64 overflow-y-auto"></div> <div class="border-t border-border mt-1 pt-1"><button class="w-full px-3 py-2 flex items-center gap-2 text-left transition-colors hover:bg-base-100 text-text-muted hover:text-text"><!> <span class="text-sm">Add brand</span></button></div></div>'),ya=u('<div class="absolute right-0 top-full mt-2 w-56 rounded-lg shadow-lg py-1 z-50 bg-white border border-base-200"><div class="px-4 py-3 border-b border-border"><p class="text-sm font-medium text-text truncate"> </p> <p class="text-xs text-text-muted capitalize"> </p></div> <a class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900">Settings</a> <div class="border-t border-border my-1"></div> <button class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900 w-full text-left">Switch Brand</button> <button class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900 w-full text-left">Sign out</button></div>'),wa=u('<div class="admin-layout"><div class="admin-sidebar hidden md:block"><!></div> <div class="fixed top-0 left-0 right-0 h-14 px-4 flex items-center justify-between z-40 border-b border-base-200 bg-white md:hidden"><button class="p-2 rounded-lg transition-colors text-text-muted hover:bg-base-100"><!></button> <div class="brand-switcher relative"><button class="flex items-center gap-1 font-semibold text-text"> <!></button> <!></div> <div class="user-menu-container relative"><button class="flex items-center gap-2 p-1 rounded-lg transition-colors hover:bg-base-100"><div class="flex items-center justify-center h-8 w-8 rounded-full text-sm font-medium text-white bg-primary"> </div></button> <!></div></div> <!> <div class="admin-main"><header class="h-16 px-6 items-center justify-end border-b border-base-200 sticky top-0 z-20 bg-white hidden md:flex"><div class="flex items-center gap-4"><div class="brand-switcher relative"><button class="flex items-center gap-2 px-2 py-1.5 rounded-lg transition-colors hover:bg-base-100 group"><span class="text-sm text-text-muted">Brand:</span> <span class="font-medium text-sm"> </span> <!></button> <!></div> <div class="user-menu-container relative"><button class="flex items-center gap-2 p-1 rounded-lg transition-colors hover:bg-base-100"><div class="flex items-center justify-center h-8 w-8 rounded-full text-sm font-medium text-white bg-primary"> </div> <span class="text-sm text-text-muted hidden lg:block"> </span></button> <!></div></div></header> <main class="flex-1"><!></main></div></div>'),$a=u("<!> <!>",1),ka=u('<div class="space-y-4"><!> <div><label for="brand-name" class="block text-sm font-medium text-text mb-1">Brand Name</label> <!></div> <div><label for="brand-slug" class="block text-sm font-medium text-text mb-1">URL Slug</label> <!> <p class="text-xs text-text-muted mt-1"> </p></div></div>'),Sa=u("<!> <!>",1);function Va(E,b){lt(b,!0);const R=()=>ct(vt,"$page",q),[q,D]=dt();let m=U(null),k=U(Qe([])),c=U(!0),se=U(""),S=Qe(Qt()),H=U(!1),M=U(!1),I=U(!1),F=U(!1),G=U(""),A=U(""),Z=U(!1),ee=U("");Te(()=>{Se()}),Te(()=>{R().url.pathname,s(H,!1)});async function Se(){s(c,!0),s(se,"");try{const[i,p]=await Promise.all([Xt({},b.data.brandSlug),Yt()]);s(m,i,!0),s(k,p.organizations||[],!0),localStorage.setItem("currentOrgId",e(m).id),localStorage.setItem("currentOrgName",e(m).name),localStorage.setItem("currentOrgSlug",e(m).slug);const T=localStorage.getItem(`orgSetupSkipped_${e(m).slug}`);if(!e(m).from_email&&!T){ce(`/${e(m).slug}/welcome`);return}}catch(i){console.error("Failed to load organization:",i),s(se,`Organization "${b.data.brandSlug}" not found`),ce("/")}finally{s(c,!1)}}function oe(){localStorage.removeItem("currentOrgId"),localStorage.removeItem("currentOrgName"),localStorage.removeItem("currentOrgSlug"),ce("/")}function de(){Vt()}function be(i){const p=i.target;p.closest(".user-menu-container")||s(M,!1),p.closest(".brand-switcher")||s(I,!1)}function te(i){s(I,!1),ce(`/${i}`)}function Oe(i){return i.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function Ce(){s(A,Oe(e(G)),!0)}function me(){s(I,!1),s(G,""),s(A,""),s(ee,""),s(F,!0)}async function d(){if(!(!e(G).trim()||!e(A).trim())){s(Z,!0),s(ee,"");try{const i=await Jt({name:e(G).trim(),slug:e(A).trim()});s(F,!1),ce(`/${i.slug}/welcome`)}catch(i){s(ee,i.message||"Failed to create brand",!0)}finally{s(Z,!1)}}}var l=Sa();Tt("1xdtdtq",i=>{var p=ua();Pt(()=>{Mt.title=`${(e(m)?.name||"Admin")??""} | Outlet`}),n(i,p)}),jt("click",Nt,be);var x=Y(l);Wt(x,{children:(i,p)=>{var T=ue(),L=Y(T);{var v=y=>{var K=ba();n(y,K)},g=y=>{var K=ue(),ae=Y(K);{var fe=J=>{var O=ma(),Q=a(O),ge=a(Q,!0);t(Q),t(O),$(()=>w(ge,e(se))),n(J,O)},pe=J=>{var O=wa(),Q=a(O),ge=a(Q);{let o=ie(()=>e(m)?.name);ot(ge,{get brandSlug(){return b.data.brandSlug},get orgName(){return e(o)}})}t(Q);var le=r(Q,2),_e=a(le);_e.__click=()=>s(H,!e(H));var ut=a(_e);{var bt=o=>{Ft(o,{class:"h-6 w-6"})},mt=o=>{Zt(o,{class:"h-6 w-6"})};z(ut,o=>{e(H)?o(bt):o(mt,!1)})}t(_e);var Be=r(_e,2),xe=a(Be);xe.__click=o=>{o.stopPropagation(),s(M,!1),s(I,!e(I))};var Ge=a(xe),ft=r(Ge);rt(ft,{class:"h-4 w-4 text-text-muted"}),t(xe);var pt=r(xe,2);{var gt=o=>{var f=pa(),_=r(a(f),2);$e(_,21,()=>e(k),ke,(V,B)=>{var N=fa();N.__click=()=>te(e(B).slug);var W=a(N),Me=a(W,!0);t(W);var je=r(W,2);{var Ue=re=>{tt(re,{class:"h-4 w-4 text-primary flex-shrink-0"})};z(je,re=>{e(B).id===e(m)?.id&&re(Ue)})}t(N),$(()=>{ve(N,1,`w-full px-3 py-2 flex items-center gap-2 text-left transition-colors hover:bg-base-100 ${e(B).id===e(m)?.id?"bg-base-50":""}`),w(Me,e(B).name)}),n(V,N)}),t(_);var C=r(_,2),j=a(C);j.__click=me;var P=a(j);st(P,{class:"h-4 w-4"}),ne(2),t(j),t(C),t(f),n(o,f)};z(pt,o=>{e(I)&&o(gt)})}t(Be);var qe=r(Be,2),he=a(qe);he.__click=o=>{o.stopPropagation(),s(I,!1),s(M,!e(M))};var De=a(he),_t=a(De,!0);t(De),t(he);var xt=r(he,2);{var ht=o=>{var f=ga(),_=a(f),C=a(_),j=a(C,!0);t(C),t(_);var P=r(_,2);P.__click=()=>s(M,!1);var V=r(P,4);V.__click=oe;var B=r(V,2);B.__click=de,t(f),$(()=>{w(j,S?.email),X(P,"href",`/${b.data.brandSlug??""}/settings`)}),n(o,f)};z(xt,o=>{e(M)&&o(ht)})}t(qe),t(le);var He=r(le,2);{var yt=o=>{var f=_a(),_=Y(f);_.__click=()=>s(H,!1),_.__keydown=P=>P.key==="Escape"&&s(H,!1);var C=r(_,2),j=a(C);{let P=ie(()=>e(m)?.name);ot(j,{get brandSlug(){return b.data.brandSlug},get orgName(){return e(P)}})}t(C),n(o,f)};z(He,o=>{e(H)&&o(yt)})}var Ke=r(He,2),ze=a(Ke),We=a(ze),Ie=a(We),ye=a(Ie);ye.__click=o=>{o.stopPropagation(),s(M,!1),s(I,!e(I))};var Pe=r(a(ye),2),wt=a(Pe,!0);t(Pe);var $t=r(Pe,2);rt($t,{class:"h-4 w-4 text-text-muted group-hover:text-text transition-colors"}),t(ye);var kt=r(ye,2);{var St=o=>{var f=ha(),_=r(a(f),2);$e(_,21,()=>e(k),ke,(V,B)=>{var N=xa();N.__click=()=>te(e(B).slug);var W=a(N),Me=a(W,!0);t(W);var je=r(W,2);{var Ue=re=>{tt(re,{class:"h-4 w-4 text-primary flex-shrink-0"})};z(je,re=>{e(B).id===e(m)?.id&&re(Ue)})}t(N),$(()=>{ve(N,1,`w-full px-3 py-2 flex items-center gap-2 text-left transition-colors hover:bg-base-100 ${e(B).id===e(m)?.id?"bg-base-50":""}`),w(Me,e(B).name)}),n(V,N)}),t(_);var C=r(_,2),j=a(C);j.__click=me;var P=a(j);st(P,{class:"h-4 w-4"}),ne(2),t(j),t(C),t(f),n(o,f)};z(kt,o=>{e(I)&&o(St)})}t(Ie);var Xe=r(Ie,2),we=a(Xe);we.__click=o=>{o.stopPropagation(),s(I,!1),s(M,!e(M))};var Ne=a(we),Ot=a(Ne,!0);t(Ne);var Ye=r(Ne,2),Ct=a(Ye,!0);t(Ye),t(we);var Bt=r(we,2);{var zt=o=>{var f=ya(),_=a(f),C=a(_),j=a(C,!0);t(C);var P=r(C,2),V=a(P,!0);t(P),t(_);var B=r(_,2);B.__click=()=>s(M,!1);var N=r(B,4);N.__click=oe;var W=r(N,2);W.__click=de,t(f),$(()=>{w(j,S?.email),w(V,S?.role||"user"),X(B,"href",`/${b.data.brandSlug??""}/settings`)}),n(o,f)};z(Bt,o=>{e(M)&&o(zt)})}t(Xe),t(We),t(ze);var Je=r(ze,2),It=a(Je);Ut(It,()=>b.children),t(Je),t(Ke),t(O),$((o,f)=>{w(Ge,`${(e(m)?.name||"Outlet")??""} `),w(_t,o),w(wt,e(m)?.name||"Organization"),w(Ot,f),w(Ct,S?.email)},[()=>(S?.name||S?.email||"U")[0].toUpperCase(),()=>(S?.name||S?.email||"U")[0].toUpperCase()]),n(J,O)};z(ae,J=>{e(se)?J(fe):J(pe,!1)},!0)}n(y,K)};z(L,y=>{e(c)?y(v):y(g,!1)})}n(i,T)},$$slots:{default:!0}});var h=r(x,2);Et(h,{title:"Create Brand",get show(){return e(F)},set show(p){s(F,p,!0)},footer:p=>{var T=$a(),L=Y(T);et(L,{type:"secondary",onclick:()=>s(F,!1),get disabled(){return e(Z)},children:(g,y)=>{ne();var K=Ae("Cancel");n(g,K)},$$slots:{default:!0}});var v=r(L,2);{let g=ie(()=>!e(G).trim()||!e(A).trim()||e(Z));et(v,{type:"primary",onclick:d,get disabled(){return e(g)},children:(y,K)=>{ne();var ae=Ae();$(()=>w(ae,e(Z)?"Creating...":"Create Brand")),n(y,ae)},$$slots:{default:!0}})}n(p,T)},children:(p,T)=>{var L=ka(),v=a(L);{var g=O=>{Rt(O,{type:"error",children:(Q,ge)=>{ne();var le=Ae();$(()=>w(le,e(ee))),n(Q,le)},$$slots:{default:!0}})};z(v,O=>{e(ee)&&O(g)})}var y=r(v,2),K=r(a(y),2);Ze(K,{id:"brand-name",oninput:Ce,placeholder:"My Company",get value(){return e(G)},set value(O){s(G,O,!0)}}),t(y);var ae=r(y,2),fe=r(a(ae),2);Ze(fe,{id:"brand-slug",placeholder:"my-company",get value(){return e(A)},set value(O){s(A,O,!0)}});var pe=r(fe,2),J=a(pe);t(pe),t(ae),t(L),$(()=>w(J,`This will be used in the URL: /${(e(A)||"my-company")??""}`)),n(p,L)},$$slots:{footer:!0,default:!0}}),n(E,l),nt(),D()}it(["click","keydown"]);export{Va as component,Qa as universal};
