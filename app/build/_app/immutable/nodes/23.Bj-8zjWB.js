import"../chunks/Bzak7iHL.js";import{f as I,p as je,d as f,j as Ae,u as Te,b as s,a as qe,h as Oe,s as o,c as a,g as e,$ as Re,n as P,r,t as j,e as A}from"../chunks/Ip2DykXx.js";import{s as E}from"../chunks/DhOIAuLg.js";import{c as he,a as n,f as v,t as se}from"../chunks/BPgbRZ5o.js";import{l as Ve,s as He,i as D}from"../chunks/BeCi3WIf.js";import{e as Qe,i as Ge}from"../chunks/-0-Kn73z.js";import{h as Je}from"../chunks/vHZS38u2.js";import{s as Ke}from"../chunks/CmyOW3uE.js";import{s as We,a as Xe}from"../chunks/ur54L5C-.js";import{p as Ye}from"../chunks/BUZmhiZ9.js";import{g as _e}from"../chunks/CDoCV2GU.js";import{D as Ze,E as et,F as tt}from"../chunks/CtwFYI68.js";import{B as V,e as rt,I as oe,b as at,A as st,D as ot,S as lt}from"../chunks/Bphptf_a.js";import{E as it,a as nt,S as dt}from"../chunks/iYJsf80Y.js";import{L as ct}from"../chunks/sFH_xjRy.js";import{B as vt}from"../chunks/CK6k7lQK.js";import{P as ge}from"../chunks/C0D2ZjIj.js";import{M as pt}from"../chunks/DWdrbJLD.js";import{U as ut}from"../chunks/BcG5IKGR.js";import"../chunks/hUurZXsg.js";import{s as mt}from"../chunks/Df8mRDld.js";import{I as ft}from"../chunks/CYeJYM_Q.js";import{T as _t}from"../chunks/Boqopfmd.js";function gt(H,T){const Q=Ve(T,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.522.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const G=[["path",{d:"M15 3h6v6"}],["path",{d:"M10 14 21 3"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}]];ft(H,He({name:"external-link"},()=>Q,{get iconNode(){return G},children:(J,q)=>{var w=he(),_=I(w);mt(_,T,"default",{}),n(J,w)},$$slots:{default:!0}}))}var ht=v("<!> New List",1),xt=v("<p> </p>"),bt=v("<!> <!>",1),$t=v('<div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><div><label for="list-name" class="form-label">Name</label> <!></div> <div><label for="list-slug" class="form-label">Slug</label> <!> <p class="mt-1 text-xs text-text-muted">Used in URLs and API</p></div> <div class="sm:col-span-2"><label for="list-description" class="form-label">Description (optional)</label> <!></div> <div class="sm:col-span-2"><!> <p class="text-xs text-text-muted mt-1 ml-6">Subscribers must confirm their email before being added</p></div></div>'),yt=v('<div class="flex justify-center py-12"><!></div>'),wt=v("<!> Create List",1),kt=v('<div class="mb-4"><!></div>'),Lt=v('<p class="text-sm text-text-muted truncate"> </p>'),Ct=v('<tr class="svelte-1mk2p91"><td class="svelte-1mk2p91"><a class="block group"><div class="flex items-center gap-3"><div class="lists-icon svelte-1mk2p91"><!></div> <div class="min-w-0 flex-1"><div class="flex items-center gap-2 flex-wrap"><span class="font-medium text-text group-hover:text-primary transition-colors"> </span> <!></div> <!></div></div></a></td><td class="text-right svelte-1mk2p91"><span class="text-lg font-semibold text-text"> </span></td><td class="text-right svelte-1mk2p91"><!></td></tr>'),St=v('<div class="text-center py-8 text-text-muted"> </div>'),Pt=v('<!> <div class="lists-table svelte-1mk2p91"><table class="w-full"><thead class="svelte-1mk2p91"><tr><th class="text-left svelte-1mk2p91">List</th><th class="text-right svelte-1mk2p91">Subscribers</th><th class="text-right w-10 svelte-1mk2p91"></th></tr></thead><tbody class="svelte-1mk2p91"></tbody></table></div> <!>',1),Dt=v('<div class="p-6 max-w-5xl mx-auto"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6"><div><h1 class="text-2xl font-semibold text-text">Lists</h1> <p class="mt-1 text-sm text-text-muted">Manage your email subscriber lists</p></div> <!></div> <!> <!> <!></div>');function Zt(H,T){je(T,!0);const Q=()=>Xe(Ye,"$page",G),[G,J]=We();let q=f(!0),w=f(Ae([])),_=f(""),F=f(""),z=f(!1),B=f(!1),k=f(""),L=f(""),O=f(""),R=f(!0),K=A(()=>`/${Q().params.orgSlug}`),le=A(()=>e(w).filter(t=>t.name.toLowerCase().includes(e(F).toLowerCase())||t.slug.toLowerCase().includes(e(F).toLowerCase())));Te(()=>{W()});async function W(){s(q,!0),s(_,"");try{const t=await Ze();s(w,t.lists||[],!0)}catch(t){console.error("Failed to load lists:",t),s(_,"Failed to load email lists")}finally{s(q,!1)}}function ie(){s(k,""),s(L,""),s(O,""),s(R,!0),s(z,!0)}function ne(){s(z,!1)}function xe(t){return t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function be(){s(L,xe(e(k)),!0)}async function $e(){if(!(!e(k)||!e(L))){s(B,!0),s(_,"");try{await et({name:e(k),slug:e(L),description:e(O),double_optin:e(R)}),ne(),await W()}catch(t){console.error("Failed to create list:",t),s(_,t.message||"Failed to create list",!0)}finally{s(B,!1)}}}async function ye(t){if(confirm(`Delete "${t.name}"? This cannot be undone.`))try{await tt({},t.id),await W()}catch(l){console.error("Failed to delete list:",l),s(_,l.message||"Failed to delete list",!0)}}var X=Dt();Je("1mk2p91",t=>{Oe(()=>{Re.title="Lists | Outlet"})});var Y=a(X),we=o(a(Y),2);V(we,{type:"primary",onclick:ie,get disabled(){return e(z)},children:(t,l)=>{var p=ht(),d=I(p);ge(d,{class:"mr-2 h-4 w-4"}),P(),n(t,p)},$$slots:{default:!0}}),r(Y);var de=o(Y,2);{var ke=t=>{st(t,{type:"error",title:"Error",class:"mb-4",children:(l,p)=>{var d=xt(),g=a(d,!0);r(d),j(()=>E(g,e(_))),n(l,d)},$$slots:{default:!0}})};D(de,t=>{e(_)&&t(ke)})}var ce=o(de,2);rt(ce,{title:"Create New List",get show(){return e(z)},set show(l){s(z,l,!0)},footer:l=>{var p=bt(),d=I(p);V(d,{type:"secondary",onclick:ne,get disabled(){return e(B)},children:(c,u)=>{P();var $=se("Cancel");n(c,$)},$$slots:{default:!0}});var g=o(d,2);{let c=A(()=>!e(k)||!e(L)||e(B));V(g,{type:"primary",onclick:$e,get disabled(){return e(c)},children:(u,$)=>{P();var m=se();j(()=>E(m,e(B)?"Creating...":"Create List")),n(u,m)},$$slots:{default:!0}})}n(l,p)},children:(l,p)=>{var d=$t(),g=a(d),c=o(a(g),2);oe(c,{id:"list-name",type:"text",oninput:be,placeholder:"Newsletter",get value(){return e(k)},set value(h){s(k,h,!0)}}),r(g);var u=o(g,2),$=o(a(u),2);oe($,{id:"list-slug",type:"text",placeholder:"newsletter",get value(){return e(L)},set value(h){s(L,h,!0)}}),P(2),r(u);var m=o(u,2),N=o(a(m),2);oe(N,{id:"list-description",type:"text",placeholder:"Main newsletter for product updates",get value(){return e(O)},set value(h){s(O,h,!0)}}),r(m);var y=o(m,2),M=a(y);at(M,{label:"Require double opt-in",get checked(){return e(R)},set checked(h){s(R,h,!0)}}),P(2),r(y),r(d),n(l,d)},$$slots:{footer:!0,default:!0}});var Le=o(ce,2);{var Ce=t=>{var l=yt(),p=a(l);ct(p,{size:"large"}),r(l),n(t,l)},Se=t=>{var l=he(),p=I(l);{var d=c=>{it(c,{get icon(){return pt},title:"No lists yet",description:"Create your first email list to start collecting subscribers.",children:(u,$)=>{V(u,{type:"primary",onclick:ie,children:(m,N)=>{var y=wt(),M=I(y);ge(M,{class:"mr-2 h-4 w-4"}),P(),n(m,y)},$$slots:{default:!0}})},$$slots:{default:!0}})},g=c=>{var u=Pt(),$=I(u);{var m=x=>{var i=kt(),C=a(i);lt(C,{placeholder:"Search lists...",get value(){return e(F)},set value(U){s(F,U,!0)}}),r(i),n(x,i)};D($,x=>{e(w).length>3&&x(m)})}var N=o($,2),y=a(N),M=o(a(y));Qe(M,21,()=>e(le),Ge,(x,i)=>{var C=Ct(),U=a(C),Z=a(U),ve=a(Z),ee=a(ve),De=a(ee);ut(De,{class:"h-4 w-4"}),r(ee);var pe=o(ee,2),te=a(pe),re=a(te),Fe=a(re,!0);r(re);var Ne=o(re,2);{var Me=b=>{vt(b,{variant:"info",size:"sm",children:(S,fe)=>{P();var Ue=se("Double opt-in");n(S,Ue)},$$slots:{default:!0}})};D(Ne,b=>{e(i).double_optin&&b(Me)})}r(te);var Ee=o(te,2);{var Ie=b=>{var S=Lt(),fe=a(S,!0);r(S),j(()=>E(fe,e(i).description)),n(b,S)};D(Ee,b=>{e(i).description&&b(Ie)})}r(pe),r(ve),r(Z),r(U);var ae=o(U),ue=a(ae),ze=a(ue,!0);r(ue),r(ae);var me=o(ae),Be=a(me);{let b=A(()=>({icon:nt,class:"p-1.5 rounded-lg hover:bg-bg-secondary transition-colors text-text-muted hover:text-text"})),S=A(()=>[{label:"Edit",icon:dt,onclick:()=>_e(`${e(K)}/lists/${e(i).id}`)},{label:"View subscribers",icon:gt,onclick:()=>_e(`${e(K)}/lists/${e(i).id}/subscribers`)},{divider:!0},{label:"Delete",icon:_t,variant:"danger",onclick:()=>ye(e(i))}]);ot(Be,{get trigger(){return e(b)},get items(){return e(S)}})}r(me),r(C),j(()=>{Ke(Z,"href",`${e(K)??""}/lists/${e(i).id??""}`),E(Fe,e(i).name),E(ze,e(i).subscriber_count||0)}),n(x,C)}),r(M),r(y),r(N);var h=o(N,2);{var Pe=x=>{var i=St(),C=a(i);r(i),j(()=>E(C,`No lists match "${e(F)??""}"`)),n(x,i)};D(h,x=>{e(F)&&e(le).length===0&&x(Pe)})}n(c,u)};D(p,c=>{e(w).length===0?c(d):c(g,!1)},!0)}n(t,l)};D(Le,t=>{e(q)?t(Ce):t(Se,!1)})}r(X),n(H,X),qe(),J()}export{Zt as component};
