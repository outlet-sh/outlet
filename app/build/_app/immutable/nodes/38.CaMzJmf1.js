import"../chunks/DsnmJJEf.js";import{p as xe,u as $e,b as t,i as e,f as h,d as be,s as n,m as we,j as O,h as o,g as ke,c as l,r as i,t as Q,n as D}from"../chunks/odI--4Kw.js";import{s as Z}from"../chunks/BNMK9zrr.js";import{a as d,f as u,c as ae}from"../chunks/CCInJaqd.js";import{i as F}from"../chunks/COaB7F5h.js";import{h as Ae}from"../chunks/hUjpWz_l.js";import{a as Pe,s as Se}from"../chunks/DL1yFSKa.js";import{g as Ie}from"../chunks/WWD3OlSc.js";import{p as Te}from"../chunks/B8l5u2D4.js";import{j as ze,P as Re,Q as Ce,R as Be}from"../chunks/MOXZsotB.js";import{g as re,A as Oe,C as H,I as oe,B as J,h as De,f as Fe}from"../chunks/B2E-c0C9.js";import{L as Le}from"../chunks/D716f0vp.js";import{S as Ke}from"../chunks/DmKCzuEX.js";import{R as Ne}from"../chunks/DmfaYHKu.js";import{T as Ue}from"../chunks/DHikf9no.js";var je=u("<p> </p>"),qe=u('<div class="mb-6"><!></div>'),Ee=u('<h2 class="text-lg font-medium text-text mb-4">General</h2> <div class="space-y-4"><div><label for="org-name" class="form-label">Brand Name</label> <!></div> <div><label class="form-label">Slug</label> <p class="text-sm text-text-muted bg-bg-secondary px-3 py-2 rounded-md"> </p> <p class="mt-1 text-xs text-text-muted">The slug cannot be changed after creation</p></div> <div><label for="app-url" class="form-label">App URL</label> <!> <p class="mt-1 text-xs text-text-muted">Base URL of your application for confirmation links</p></div> <div class="pt-2"><!></div></div>',1),Ge=u("<!> Regenerate Key",1),Qe=u('<h2 class="text-lg font-medium text-text mb-4">API Key</h2> <p class="text-sm text-text-muted mb-4">Use this key to authenticate API requests for this brand.</p> <div class="flex items-center gap-2 bg-bg-secondary px-3 py-2 rounded-md"><code class="flex-1 text-sm font-mono text-text break-all"> </code> <!></div> <div class="mt-4"><!></div>',1),Ze=u("<!> Delete Brand",1),He=u(`<h2 class="text-lg font-medium text-red-600 mb-4">Danger Zone</h2> <p class="text-sm text-text-muted mb-4">Permanently delete this brand and all of its data including contacts, lists, and campaigns.
						This action cannot be undone.</p> <!>`,1),Je=u('<div class="space-y-6"><!> <!> <!></div>'),Me=u("<!> <!> <!> <!>",1);function ut(se,ne){xe(ne,!0);const le=()=>Pe(Te,"$page",ie),[ie,de]=Se();let L=n(!0),r=n(null),m=n(""),p=n(""),w=n(""),K=n(!1),T=n(!1),N=n(!1),z=n(!1),U=n(!1),A=n(!1),j=n(!1);$e(()=>{M()});async function M(){t(L,!0),t(m,"");const a=le().params.brandSlug;if(a)try{t(r,await ze({},a),!0),t(p,e(r).name,!0),t(w,e(r).app_url||"",!0)}catch(s){console.error("Failed to load organization:",s),t(m,"Failed to load organization")}finally{t(L,!1)}}async function ce(){if(!(!e(r)||!e(p).trim())){t(K,!0),t(T,!1),t(m,"");try{await Be({},{name:e(p).trim(),app_url:e(w).trim()},e(r).id),e(r).name=e(p).trim(),e(r).app_url=e(w).trim(),localStorage.setItem("currentOrgName",e(p).trim()),t(T,!0),setTimeout(()=>{t(T,!1)},2e3)}catch(a){console.error("Failed to update organization:",a),t(m,a.message||"Failed to update organization",!0)}finally{t(K,!1)}}}function ue(){e(r)&&(navigator.clipboard.writeText(e(r).api_key),t(N,!0),setTimeout(()=>{t(N,!1)},2e3))}async function me(){if(e(r)){t(j,!0);try{await Re({},e(r).id),t(A,!1),await M()}catch(a){console.error("Failed to regenerate API key:",a),t(m,a.message||"Failed to regenerate API key",!0)}finally{t(j,!1)}}}async function pe(){if(e(r)){t(U,!0);try{await Ce({},e(r).id),localStorage.removeItem("currentOrgId"),localStorage.removeItem("currentOrgName"),localStorage.removeItem("currentOrgSlug"),Ie("/")}catch(a){console.error("Failed to delete organization:",a),t(m,a.message||"Failed to delete organization",!0)}finally{t(U,!1)}}}var V=Me();Ae("u5n06x",a=>{we(()=>{ke.title=`Brand Settings - ${(e(r)?.name||"Loading")??""}`})});var W=h(V);{var ge=a=>{var s=qe(),P=l(s);Oe(P,{type:"error",title:"Error",children:(q,R)=>{var y=je(),C=l(y,!0);i(y),Q(()=>Z(C,e(m))),d(q,y)},$$slots:{default:!0}}),i(s),d(a,s)};F(W,a=>{e(m)&&a(ge)})}var X=o(W,2);{var fe=a=>{Le(a,{size:"large"})},ve=a=>{var s=ae(),P=h(s);{var q=R=>{var y=Je(),C=l(y);H(C,{children:(S,te)=>{var g=Ee(),f=o(h(g),2),c=l(f),B=o(l(c),2);oe(B,{id:"org-name",type:"text",get value(){return e(p)},set value(b){t(p,b,!0)}}),i(c);var v=o(c,2),x=o(l(v),2),E=l(x,!0);i(x),D(2),i(v);var $=o(v,2),G=o(l($),2);oe(G,{id:"app-url",type:"text",placeholder:"https://yourapp.com",get value(){return e(w)},set value(b){t(w,b,!0)}}),D(2),i($);var _=o($,2),I=l(_);{let b=O(()=>e(p)===e(r).name&&e(w)===(e(r).app_url||""));Ke(I,{label:"Save Changes",get saving(){return e(K)},get saved(){return e(T)},onclick:ce,get disabled(){return e(b)}})}i(_),i(f),Q(()=>Z(E,e(r).slug)),d(S,g)},$$slots:{default:!0}});var ee=o(C,2);H(ee,{children:(S,te)=>{var g=Qe(),f=o(h(g),4),c=l(f),B=l(c,!0);i(c);var v=o(c,2);J(v,{type:"ghost",size:"icon",onclick:ue,class:"flex-shrink-0 p-1.5 text-text-muted hover:text-text rounded transition-colors",children:($,G)=>{var _=ae(),I=h(_);{var b=k=>{De(k,{class:"h-4 w-4 text-green-500"})},ye=k=>{Fe(k,{class:"h-4 w-4"})};F(I,k=>{e(N)?k(b):k(ye,!1)})}d($,_)},$$slots:{default:!0}}),i(f);var x=o(f,2),E=l(x);J(E,{type:"secondary",onclick:()=>t(A,!0),children:($,G)=>{var _=Ge(),I=h(_);Ne(I,{class:"mr-2 h-4 w-4"}),D(),d($,_)},$$slots:{default:!0}}),i(x),Q(()=>Z(B,e(r).api_key)),d(S,g)},$$slots:{default:!0}});var he=o(ee,2);H(he,{children:(S,te)=>{var g=He(),f=o(h(g),4);J(f,{type:"danger",onclick:()=>t(z,!0),children:(c,B)=>{var v=Ze(),x=h(v);Ue(x,{class:"mr-2 h-4 w-4"}),D(),d(c,v)},$$slots:{default:!0}}),d(S,g)},$$slots:{default:!0}}),i(y),d(R,y)};F(P,R=>{e(r)&&R(q)},!0)}d(a,s)};F(X,a=>{e(L)?a(fe):a(ve,!1)})}var Y=o(X,2);{let a=O(()=>e(j)?"Regenerating...":"Regenerate");re(Y,{title:"Regenerate API Key",description:"Are you sure you want to regenerate the API key? The current key will immediately stop working. Any applications using the old key will need to be updated.",get actionLabel(){return e(a)},actionType:"danger",onAction:me,onCancel:()=>t(A,!1),get open(){return e(A)},set open(s){t(A,s,!0)}})}var _e=o(Y,2);{let a=O(()=>`Are you sure you want to delete ${e(r)?.name}? This will permanently delete all associated data including contacts, lists, and campaigns. This action cannot be undone.`),s=O(()=>e(U)?"Deleting...":"Delete");re(_e,{title:"Delete Brand",get description(){return e(a)},get actionLabel(){return e(s)},actionType:"danger",onAction:pe,onCancel:()=>t(z,!1),get open(){return e(z)},set open(P){t(z,P,!0)}})}d(se,V),be(),de()}export{ut as component};
