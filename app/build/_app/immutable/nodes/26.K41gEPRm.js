import"../chunks/DsnmJJEf.js";import{p as We,s as _,a as ke,u as Xe,i as e,b as r,d as Ye,e as Ze,h as l,c as o,g as et,r as a,t as J,f as y,j as se,n as oe}from"../chunks/DDjrJUyi.js";import{d as tt,s as C}from"../chunks/CwHIudaz.js";import{f as d,a as s,c as Q,t as le}from"../chunks/DbkN8AN9.js";import{i as $,c as at}from"../chunks/CGvWOYBA.js";import{e as xe,i as ge,a as rt}from"../chunks/aSjiVL0V.js";import{h as st}from"../chunks/DHP91Nzo.js";import{s as ot}from"../chunks/Bcmc20em.js";import"../chunks/xO-kFbvT.js";import{n as lt,o as it,p as dt,q as nt,s as mt,t as ct}from"../chunks/yWEY6ChK.js";import{A as vt,C as De,I as ie,B as de,j as Le}from"../chunks/Bkv3Tidq.js";import{E as Be}from"../chunks/B00BxIdJ.js";import{L as Ee}from"../chunks/BWhLmYGf.js";import{B as Se}from"../chunks/42UF-HRp.js";import{M as Ae}from"../chunks/BinJvwcy.js";import{G as Ce}from"../chunks/C3yWjRTF.js";import{P as Pe}from"../chunks/BPUqRg7c.js";import{T as Re}from"../chunks/DxriTNl7.js";var ut=d("<p> </p>"),ft=d("<button><!> </button>"),pt=d("<!> Add",1),_t=d('<h2 class="text-lg font-medium text-text mb-4">Add Email to Suppression List</h2> <div class="flex gap-3"><!> <!> <!></div>',1),ht=d('<div class="flex justify-center py-12"><!></div>'),xt=d('<div class="mb-4"><!></div>'),gt=d('<tr><td class="font-medium text-text"> </td><td class="text-text-muted"> </td><td><!></td><td class="text-text-muted text-sm"> </td><td class="text-right"><!></td></tr>'),bt=d('<!> <div class="data-table"><table class="w-full"><thead><tr><th class="text-left">Email</th><th class="text-left">Reason</th><th class="text-left">Source</th><th class="text-left">Added</th><th class="text-right w-10"></th></tr></thead><tbody></tbody></table></div>',1),wt=d("<!> <!>",1),yt=d("<!> Block",1),$t=d('<h2 class="text-lg font-medium text-text mb-4">Block a Domain</h2> <p class="text-sm text-text-muted mb-4">All emails from blocked domains will be rejected. Use this to block spam or competitor domains.</p> <div class="flex gap-3"><!> <!> <!></div>',1),kt=d('<div class="flex justify-center py-12"><!></div>'),Dt=d('<div class="mb-4"><!></div>'),Lt=d('<span class="text-text-muted">0</span>'),Bt=d('<tr><td class="font-medium text-text"> </td><td class="text-text-muted"> </td><td><!></td><td class="text-text-muted text-sm"> </td><td class="text-right"><!></td></tr>'),Et=d('<!> <div class="data-table"><table class="w-full"><thead><tr><th class="text-left">Domain</th><th class="text-left">Reason</th><th class="text-left">Block Attempts</th><th class="text-left">Added</th><th class="text-right w-10"></th></tr></thead><tbody></tbody></table></div>',1),St=d("<!> <!>",1),At=d(`<div class="p-6 max-w-5xl mx-auto"><div class="mb-6"><h1 class="text-2xl font-semibold text-text">Blocklist</h1> <p class="mt-1 text-sm text-text-muted">Manage suppressed emails and blocked domains. Blocked addresses won't receive any emails.</p></div> <!> <div class="border-b border-border mb-6"><nav class="-mb-px flex space-x-8"></nav></div> <!></div>`);function Xt(Fe,je){We(je,!0);const[Ct,Me]=ot();let T=_("emails"),V=_(ke([])),ne=_(!0),W=_(""),q=_(""),X=_(""),Y=_(!1),Z=_(ke([])),me=_(!0),ee=_(""),G=_(""),te=_(""),ae=_(!1),F=_(""),ze=se(()=>e(V).filter(t=>t.email.toLowerCase().includes(e(W).toLowerCase())||(t.reason||"").toLowerCase().includes(e(W).toLowerCase()))),Ie=se(()=>e(Z).filter(t=>t.domain.toLowerCase().includes(e(ee).toLowerCase())||(t.reason||"").toLowerCase().includes(e(ee).toLowerCase())));Xe(()=>{e(T)==="emails"?ce():e(T)==="domains"&&ve()});async function ce(){r(ne,!0);try{const t=await lt({});r(V,t.emails||[],!0)}catch(t){console.error("Failed to load suppressed emails:",t)}finally{r(ne,!1)}}async function ve(){r(me,!0);try{const t=await it({});r(Z,t.domains||[],!0)}catch(t){console.error("Failed to load blocked domains:",t)}finally{r(me,!1)}}async function Te(){if(e(q).trim()){r(Y,!0),r(F,"");try{await dt({email:e(q).trim().toLowerCase(),reason:e(X).trim()||"Manual suppression"}),r(q,""),r(X,""),await ce()}catch(t){r(F,t.message||"Failed to add email to suppression list",!0)}finally{r(Y,!1)}}}async function qe(t){if(confirm(`Remove ${t.email} from the suppression list?`))try{await mt({},t.id),await ce()}catch(m){r(F,m.message||"Failed to remove email",!0)}}async function Ge(){if(e(G).trim()){r(ae,!0),r(F,"");try{await nt({domain:e(G).trim().toLowerCase(),reason:e(te).trim()||"Manual block"}),r(G,""),r(te,""),await ve()}catch(t){r(F,t.message||"Failed to block domain",!0)}finally{r(ae,!1)}}}async function Ne(t){if(confirm(`Unblock domain ${t.domain}?`))try{await ct({},t.id),await ve()}catch(m){r(F,m.message||"Failed to unblock domain",!0)}}const Ue=[{id:"emails",label:"Suppressed Emails",icon:Ae},{id:"domains",label:"Blocked Domains",icon:Ce}];var ue=At();st("qxspuw",t=>{Ze(()=>{et.title="Blocklist | Outlet"})});var be=l(o(ue),2);{var Oe=t=>{vt(t,{type:"error",title:"Error",class:"mb-4",children:(m,k)=>{var E=ut(),P=o(E,!0);a(E),J(()=>C(P,e(F))),s(m,E)},$$slots:{default:!0}})};$(be,t=>{e(F)&&t(Oe)})}var fe=l(be,2),we=o(fe);xe(we,21,()=>Ue,ge,(t,m)=>{var k=ft();k.__click=()=>r(T,e(m).id,!0);var E=o(k);at(E,()=>e(m).icon,(N,h)=>{h(N,{class:"h-4 w-4"})});var P=l(E);a(k),J(()=>{rt(k,1,`whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium flex items-center gap-2 ${e(T)===e(m).id?"border-primary text-primary":"border-transparent text-text-muted hover:border-border hover:text-text"}`),C(P,` ${e(m).label??""}`)}),s(t,k)}),a(we),a(fe);var He=l(fe,2);{var Je=t=>{var m=wt(),k=y(m);De(k,{class:"mb-6",children:(h,R)=>{var j=_t(),U=l(y(j),2),x=o(U);ie(x,{type:"email",placeholder:"email@example.com",class:"flex-1",get value(){return e(q)},set value(g){r(q,g,!0)}});var n=l(x,2);ie(n,{type:"text",placeholder:"Reason (optional)",class:"flex-1",get value(){return e(X)},set value(g){r(X,g,!0)}});var D=l(n,2);{let g=se(()=>!e(q).trim()||e(Y));de(D,{type:"primary",onclick:Te,get disabled(){return e(g)},children:(M,b)=>{var S=Q(),w=y(S);{var L=i=>{var u=le("Adding...");s(i,u)},v=i=>{var u=pt(),B=y(u);Pe(B,{class:"mr-2 h-4 w-4"}),oe(),s(i,u)};$(w,i=>{e(Y)?i(L):i(v,!1)})}s(M,S)},$$slots:{default:!0}})}a(U),s(h,j)},$$slots:{default:!0}});var E=l(k,2);{var P=h=>{var R=ht(),j=o(R);Ee(j,{}),a(R),s(h,R)},N=h=>{var R=Q(),j=y(R);{var U=n=>{Be(n,{get icon(){return Ae},title:"No suppressed emails",message:"Add email addresses that should never receive emails from this workspace."})},x=n=>{var D=bt(),g=y(D);{var M=L=>{var v=xt(),i=o(v);Le(i,{placeholder:"Search suppressed emails...",get value(){return e(W)},set value(u){r(W,u,!0)}}),a(v),s(L,v)};$(g,L=>{e(V).length>5&&L(M)})}var b=l(g,2),S=o(b),w=l(o(S));xe(w,21,()=>e(ze),ge,(L,v)=>{var i=gt(),u=o(i),B=o(u,!0);a(u);var c=l(u),f=o(c,!0);a(c);var p=l(c),K=o(p);Se(K,{variant:"default",size:"sm",children:(I,he)=>{oe();var H=le();J(()=>C(H,e(v).source)),s(I,H)},$$slots:{default:!0}}),a(p);var z=l(p),pe=o(z,!0);a(z);var O=l(z),_e=o(O);de(_e,{type:"ghost",size:"sm",onclick:()=>qe(e(v)),class:"text-text-muted hover:text-error",children:(I,he)=>{Re(I,{class:"h-4 w-4"})},$$slots:{default:!0}}),a(O),a(i),J(I=>{C(B,e(v).email),C(f,e(v).reason||"-"),C(pe,I)},[()=>new Date(e(v).created_at).toLocaleDateString()]),s(L,i)}),a(w),a(S),a(b),s(n,D)};$(j,n=>{e(V).length===0?n(U):n(x,!1)},!0)}s(h,R)};$(E,h=>{e(ne)?h(P):h(N,!1)})}s(t,m)},Ke=t=>{var m=Q(),k=y(m);{var E=P=>{var N=St(),h=y(N);De(h,{class:"mb-6",children:(x,n)=>{var D=$t(),g=l(y(D),4),M=o(g);ie(M,{type:"text",placeholder:"example.com",class:"flex-1",get value(){return e(G)},set value(w){r(G,w,!0)}});var b=l(M,2);ie(b,{type:"text",placeholder:"Reason (optional)",class:"flex-1",get value(){return e(te)},set value(w){r(te,w,!0)}});var S=l(b,2);{let w=se(()=>!e(G).trim()||e(ae));de(S,{type:"primary",onclick:Ge,get disabled(){return e(w)},children:(L,v)=>{var i=Q(),u=y(i);{var B=f=>{var p=le("Blocking...");s(f,p)},c=f=>{var p=yt(),K=y(p);Pe(K,{class:"mr-2 h-4 w-4"}),oe(),s(f,p)};$(u,f=>{e(ae)?f(B):f(c,!1)})}s(L,i)},$$slots:{default:!0}})}a(g),s(x,D)},$$slots:{default:!0}});var R=l(h,2);{var j=x=>{var n=kt(),D=o(n);Ee(D,{}),a(n),s(x,n)},U=x=>{var n=Q(),D=y(n);{var g=b=>{Be(b,{get icon(){return Ce},title:"No blocked domains",message:"Block domains to prevent all emails from those addresses."})},M=b=>{var S=Et(),w=y(S);{var L=B=>{var c=Dt(),f=o(c);Le(f,{placeholder:"Search blocked domains...",get value(){return e(ee)},set value(p){r(ee,p,!0)}}),a(c),s(B,c)};$(w,B=>{e(Z).length>5&&B(L)})}var v=l(w,2),i=o(v),u=l(o(i));xe(u,21,()=>e(Ie),ge,(B,c)=>{var f=Bt(),p=o(f),K=o(p,!0);a(p);var z=l(p),pe=o(z,!0);a(z);var O=l(z),_e=o(O);{var I=A=>{Se(A,{variant:"warning",size:"sm",children:(re,Pt)=>{oe();var $e=le();J(()=>C($e,e(c).block_attempts)),s(re,$e)},$$slots:{default:!0}})},he=A=>{var re=Lt();s(A,re)};$(_e,A=>{e(c).block_attempts>0?A(I):A(he,!1)})}a(O);var H=l(O),Qe=o(H,!0);a(H);var ye=l(H),Ve=o(ye);de(Ve,{type:"ghost",size:"sm",onclick:()=>Ne(e(c)),class:"text-text-muted hover:text-error",children:(A,re)=>{Re(A,{class:"h-4 w-4"})},$$slots:{default:!0}}),a(ye),a(f),J(A=>{C(K,e(c).domain),C(pe,e(c).reason||"-"),C(Qe,A)},[()=>new Date(e(c).created_at).toLocaleDateString()]),s(B,f)}),a(u),a(i),a(v),s(b,S)};$(D,b=>{e(Z).length===0?b(g):b(M,!1)},!0)}s(x,n)};$(R,x=>{e(me)?x(j):x(U,!1)})}s(P,N)};$(k,P=>{e(T)==="domains"&&P(E)},!0)}s(t,m)};$(He,t=>{e(T)==="emails"?t(Je):t(Ke,!1)})}a(ue),s(Fe,ue),Ye(),Me()}tt(["click"]);export{Xt as component};
