import"../chunks/Bzak7iHL.js";import{o as oe}from"../chunks/DufYntU0.js";import{p as le,f as w,s as h,a as ne,h as ie,c as u,$ as de,g as e,d as k,b as r,e as O,r as m,t as z,n as F,i as ve}from"../chunks/Ip2DykXx.js";import{e as fe,s as U}from"../chunks/DhOIAuLg.js";import{i as P}from"../chunks/BeCi3WIf.js";import{f as I,a as s,c as q,t as G}from"../chunks/BPgbRZ5o.js";import{h as ue}from"../chunks/vHZS38u2.js";import{g as me}from"../chunks/CDoCV2GU.js";import{l as ce}from"../chunks/CtwFYI68.js";import{a as pe}from"../chunks/DBvAn5fL.js";import{C as _e,I as N,B as ge,A as Q,T as he}from"../chunks/Bphptf_a.js";var ye=I('<p>Try again in <span class="font-mono font-semibold"> </span></p>'),xe=I('<!> <div class="mt-6"></div>',1),$e=I("<p> </p>"),be=I('<!> <div class="mt-6"></div>',1),we=I('<!> <form class="space-y-5"><div><label for="email" class="form-label">Email</label> <!></div> <div><label for="password" class="form-label">Password</label> <!></div> <!></form> <div class="mt-6 text-center"><a href="/auth/forgot-password" class="text-sm text-primary hover:underline">Forgot your password?</a></div>',1),ke=I('<div class="min-h-screen flex items-center justify-center"><div class="w-full max-w-sm space-y-8"><div class="text-center"><h1 class="text-4xl font-bold text-text">Outlet</h1> <p class="mt-3 text-text-muted">Sign in to your account</p></div> <!></div></div>');function Me(R,V){le(V,!0);let S=k(""),D=k(""),T=k(!1),c=k(""),o=k(null),n=k(0),p=null;function W(d){r(n,d,!0),p&&clearInterval(p),p=setInterval(()=>{ve(n,-1),e(n)<=0&&(p&&clearInterval(p),r(o,null),r(c,""))},1e3)}function H(d){const t=Math.floor(d/60),_=d%60;return t>0?`${t}m ${_}s`:`${_}s`}async function X(d){if(d.preventDefault(),!(e(o)&&new Date<e(o))){r(T,!0),r(c,""),r(o,null);try{const t=await ce({email:e(S),password:e(D)});t.token&&t.user?(pe.setSession(t.token,t.user),me("/")):r(c,"Invalid response from server")}catch(t){if(console.error("Login error:",t),t.blocked_until){r(o,new Date(t.blocked_until),!0);const _=t.retry_after||Math.ceil((e(o).getTime()-Date.now())/1e3);W(_),r(c,t.error||"Too many failed attempts",!0)}else r(c,t.message||"Login failed. Please check your credentials.",!0)}finally{r(T,!1)}}}oe(()=>{p&&clearInterval(p)});var A=ke();ue("1va3k2h",d=>{ie(()=>{de.title="Login - Outlet"})});var J=u(A),Y=h(u(J),2);_e(Y,{children:(d,t)=>{var _=we(),K=w(_);{var Z=a=>{var l=xe(),L=w(l);Q(L,{type:"warning",title:"Account temporarily locked",get icon(){return he},children:(y,x)=>{var v=ye(),$=h(u(v)),i=u($,!0);m($),m(v),z(f=>U(i,f),[()=>H(e(n))]),s(y,v)},$$slots:{default:!0}}),F(2),s(a,l)},ee=a=>{var l=q(),L=w(l);{var y=x=>{var v=be(),$=w(v);Q($,{type:"error",title:"Login failed",children:(i,f)=>{var g=$e(),E=u(g,!0);m(g),z(()=>U(E,e(c))),s(i,g)},$$slots:{default:!0}}),F(2),s(x,v)};P(L,x=>{e(c)&&x(y)},!0)}s(a,l)};P(K,a=>{e(o)&&e(n)>0?a(Z):a(ee,!1)})}var C=h(K,2),j=u(C),te=h(u(j),2);{let a=O(()=>e(o)!==null&&e(n)>0);N(te,{id:"email",type:"email",placeholder:"you@example.com",get disabled(){return e(a)},get value(){return e(S)},set value(l){r(S,l,!0)}})}m(j);var B=h(j,2),re=h(u(B),2);{let a=O(()=>e(o)!==null&&e(n)>0);N(re,{id:"password",type:"password",placeholder:"Enter your password",get disabled(){return e(a)},get value(){return e(D)},set value(l){r(D,l,!0)}})}m(B);var ae=h(B,2);{let a=O(()=>e(T)||e(o)!==null&&e(n)>0);ge(ae,{htmlType:"submit",type:"primary",size:"lg",get disabled(){return e(a)},class:"w-full justify-center",children:(l,L)=>{var y=q(),x=w(y);{var v=i=>{var f=G();z(g=>U(f,`Locked (${g??""})`),[()=>H(e(n))]),s(i,f)},$=i=>{var f=q(),g=w(f);{var E=b=>{var M=G("Signing in...");s(b,M)},se=b=>{var M=G("Sign in");s(b,M)};P(g,b=>{e(T)?b(E):b(se,!1)},!0)}s(i,f)};P(x,i=>{e(o)&&e(n)>0?i(v):i($,!1)})}s(l,y)},$$slots:{default:!0}})}m(C),F(2),fe("submit",C,X),s(d,_)},$$slots:{default:!0}}),m(J),m(A),s(R,A),ne()}export{Me as component};
