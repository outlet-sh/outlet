import"../chunks/Bzak7iHL.js";import{p as Re,d as _,j as Ve,u as We,b as s,a as He,h as Je,s as o,c as r,f as M,g as e,t as D,e as I,$ as Ke,n as F,r as a}from"../chunks/Ip2DykXx.js";import{s as T}from"../chunks/DhOIAuLg.js";import{f as m,a as n,t as G,c as Ue}from"../chunks/BPgbRZ5o.js";import{i as k}from"../chunks/BeCi3WIf.js";import{e as Xe,i as Ye}from"../chunks/-0-Kn73z.js";import{h as Ze}from"../chunks/vHZS38u2.js";import{s as et}from"../chunks/CmyOW3uE.js";import{s as tt,a as at}from"../chunks/ur54L5C-.js";import{p as rt}from"../chunks/BUZmhiZ9.js";import{g as me}from"../chunks/CDoCV2GU.js";import{A as st,B as lt,C as ot}from"../chunks/CtwFYI68.js";import{B as V,e as it,I as ae,A as nt,D as ct,S as dt}from"../chunks/Bphptf_a.js";import{E as vt,a as ut,S as mt}from"../chunks/iYJsf80Y.js";import{L as pt}from"../chunks/sFH_xjRy.js";import{S as ft}from"../chunks/O0AiFkiq.js";import{B as re}from"../chunks/CK6k7lQK.js";import{P as pe}from"../chunks/C0D2ZjIj.js";import{F as fe}from"../chunks/CGB94ttx.js";import{C as gt}from"../chunks/C65kbecp.js";import{T as _t}from"../chunks/Boqopfmd.js";var bt=m("<!> New Template",1),ht=m("<p> </p>"),xt=m("<!> <!>",1),$t=m('<div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><div><label for="template-name" class="form-label">Name</label> <!></div> <div><label for="template-slug" class="form-label">Slug</label> <!></div> <div><label for="template-category" class="form-label">Category</label> <!></div> <div><label for="template-description" class="form-label">Description (optional)</label> <!></div></div>'),yt=m('<div class="flex justify-center py-12"><!></div>'),wt=m("<!> Create Template",1),Ct=m('<div class="mb-4"><!></div>'),zt=m('<span class="text-sm text-text-muted block truncate"> </span>'),St=m('<span class="text-sm text-text-muted"> </span>'),Pt=m('<tr class="svelte-trz5ib"><td class="svelte-trz5ib"><a class="block group"><div class="flex items-center gap-3"><div class="templates-icon svelte-trz5ib"><!></div> <div class="min-w-0 flex-1"><span class="font-medium text-text group-hover:text-primary transition-colors block truncate"> </span> <!></div></div></a></td><td class="svelte-trz5ib"><!></td><td class="text-center svelte-trz5ib"><!></td><td class="text-right svelte-trz5ib"><!></td></tr>'),Dt=m('<div class="text-center py-8 text-text-muted"> </div>'),Ft=m('<!> <div class="templates-table svelte-trz5ib"><table class="w-full"><thead class="svelte-trz5ib"><tr><th class="text-left svelte-trz5ib">Template</th><th class="text-left svelte-trz5ib">Category</th><th class="text-center svelte-trz5ib">Status</th><th class="text-right w-10 svelte-trz5ib"></th></tr></thead><tbody class="svelte-trz5ib"></tbody></table></div> <!>',1),Tt=m('<div class="p-6 max-w-5xl mx-auto"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6"><div><h1 class="text-2xl font-semibold text-text">Templates</h1> <p class="mt-1 text-sm text-text-muted">Reusable email designs for campaigns and sequences</p></div> <!></div> <!> <!> <!></div>');function Yt(ge,_e){Re(_e,!0);const be=()=>at(rt,"$page",he),[he,xe]=tt();let W=_(!0),O=_(Ve([])),w=_(""),C=_(""),A=_(!1),j=_(!1),z=_(""),S=_(""),Q=_(""),R=_("general"),H=I(()=>`/${be().params.orgSlug}`),se=I(()=>e(O).filter(t=>t.name.toLowerCase().includes(e(C).toLowerCase())||t.slug.toLowerCase().includes(e(C).toLowerCase())||t.category.toLowerCase().includes(e(C).toLowerCase())));const le=[{value:"general",label:"General"},{value:"newsletter",label:"Newsletter"},{value:"promotional",label:"Promotional"},{value:"transactional",label:"Transactional"}];We(()=>{J()});async function J(){s(W,!0),s(w,"");try{const t=await st({});s(O,t.designs||[],!0)}catch(t){console.error("Failed to load templates:",t),s(w,"Failed to load templates")}finally{s(W,!1)}}function oe(){s(z,""),s(S,""),s(Q,""),s(R,"general"),s(A,!0)}function ie(){s(A,!1)}function $e(t){return t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function ye(){s(S,$e(e(z)),!0)}async function we(){if(!(!e(z)||!e(S))){s(j,!0),s(w,"");try{await lt({name:e(z),slug:e(S),description:e(Q),category:e(R),html_body:"<p>Start editing your template here...</p>",is_active:!0}),ie(),await J()}catch(t){console.error("Failed to create template:",t),s(w,t.message||"Failed to create template",!0)}finally{s(j,!1)}}}async function Ce(t){if(confirm(`Delete "${t.name}"? This cannot be undone.`))try{await ot({},t.id),await J()}catch(l){console.error("Failed to delete template:",l),s(w,l.message||"Failed to delete template",!0)}}function ze(t){switch(t){case"newsletter":return"info";case"promotional":return"warning";case"transactional":return"success";default:return"default"}}function Se(t){const l=le.find(u=>u.value===t);return(l==null?void 0:l.label)||t}var K=Tt();Ze("trz5ib",t=>{Je(()=>{Ke.title="Templates | Outlet"})});var U=r(K),Pe=o(r(U),2);V(Pe,{type:"primary",onclick:oe,get disabled(){return e(A)},children:(t,l)=>{var u=bt(),v=M(u);pe(v,{class:"mr-2 h-4 w-4"}),F(),n(t,u)},$$slots:{default:!0}}),a(U);var ne=o(U,2);{var De=t=>{nt(t,{type:"error",title:"Error",class:"mb-4",children:(l,u)=>{var v=ht(),b=r(v,!0);a(v),D(()=>T(b,e(w))),n(l,v)},$$slots:{default:!0}})};k(ne,t=>{e(w)&&t(De)})}var ce=o(ne,2);it(ce,{title:"Create New Template",get show(){return e(A)},set show(l){s(A,l,!0)},footer:l=>{var u=xt(),v=M(u);V(v,{type:"secondary",onclick:ie,get disabled(){return e(j)},children:(p,f)=>{F();var $=G("Cancel");n(p,$)},$$slots:{default:!0}});var b=o(v,2);{let p=I(()=>!e(z)||!e(S)||e(j));V(b,{type:"primary",onclick:we,get disabled(){return e(p)},children:(f,$)=>{F();var g=G();D(()=>T(g,e(j)?"Creating...":"Create Template")),n(f,g)},$$slots:{default:!0}})}n(l,u)},children:(l,u)=>{var v=$t(),b=r(v),p=o(r(b),2);ae(p,{id:"template-name",type:"text",oninput:ye,placeholder:"Welcome Email",get value(){return e(z)},set value(h){s(z,h,!0)}}),a(b);var f=o(b,2),$=o(r(f),2);ae($,{id:"template-slug",type:"text",placeholder:"welcome-email",get value(){return e(S)},set value(h){s(S,h,!0)}}),a(f);var g=o(f,2),L=o(r(g),2);ft(L,{id:"template-category",get options(){return le},get value(){return e(R)},set value(h){s(R,h,!0)}}),a(g);var y=o(g,2),E=o(r(y),2);ae(E,{id:"template-description",type:"text",placeholder:"Main welcome email for new subscribers",get value(){return e(Q)},set value(h){s(Q,h,!0)}}),a(y),a(v),n(l,v)},$$slots:{footer:!0,default:!0}});var Fe=o(ce,2);{var Te=t=>{var l=yt(),u=r(l);pt(u,{size:"large"}),a(l),n(t,l)},ke=t=>{var l=Ue(),u=M(l);{var v=p=>{vt(p,{get icon(){return fe},title:"No templates yet",description:"Create reusable email templates for your campaigns and sequences.",children:(f,$)=>{V(f,{type:"primary",onclick:oe,children:(g,L)=>{var y=wt(),E=M(y);pe(E,{class:"mr-2 h-4 w-4"}),F(),n(g,y)},$$slots:{default:!0}})},$$slots:{default:!0}})},b=p=>{var f=Ft(),$=M(f);{var g=x=>{var i=Ct(),P=r(i);dt(P,{placeholder:"Search templates...",get value(){return e(C)},set value(q){s(C,q,!0)}}),a(i),n(x,i)};k($,x=>{e(O).length>3&&x(g)})}var L=o($,2),y=r(L),E=o(r(y));Xe(E,21,()=>e(se),Ye,(x,i)=>{var P=Pt(),q=r(P),X=r(q),de=r(X),Y=r(de),Ee=r(Y);fe(Ee,{class:"h-4 w-4"}),a(Y);var ve=o(Y,2),Z=r(ve),Ne=r(Z,!0);a(Z);var Be=o(Z,2);{var Ie=c=>{var d=zt(),N=r(d,!0);a(d),D(()=>T(N,e(i).description)),n(c,d)},Ae=c=>{var d=St(),N=r(d,!0);a(d),D(()=>T(N,e(i).slug)),n(c,d)};k(Be,c=>{e(i).description?c(Ie):c(Ae,!1)})}a(ve),a(de),a(X),a(q);var ee=o(q),je=r(ee);{let c=I(()=>ze(e(i).category));re(je,{get variant(){return e(c)},size:"sm",children:(d,N)=>{F();var B=G();D(Qe=>T(B,Qe),[()=>Se(e(i).category)]),n(d,B)},$$slots:{default:!0}})}a(ee);var te=o(ee),qe=r(te);{var Me=c=>{re(c,{variant:"success",size:"sm",children:(d,N)=>{F();var B=G("Active");n(d,B)},$$slots:{default:!0}})},Ge=c=>{re(c,{variant:"default",size:"sm",children:(d,N)=>{F();var B=G("Inactive");n(d,B)},$$slots:{default:!0}})};k(qe,c=>{e(i).is_active?c(Me):c(Ge,!1)})}a(te);var ue=o(te),Oe=r(ue);{let c=I(()=>({icon:ut,class:"p-1.5 rounded-lg hover:bg-bg-secondary transition-colors text-text-muted hover:text-text"})),d=I(()=>[{label:"Edit",icon:mt,onclick:()=>me(`${e(H)}/templates/${e(i).id}`)},{label:"Duplicate",icon:gt,onclick:()=>me(`${e(H)}/templates/new?duplicate=${e(i).id}`)},{divider:!0},{label:"Delete",icon:_t,variant:"danger",onclick:()=>Ce(e(i))}]);ct(Oe,{get trigger(){return e(c)},get items(){return e(d)}})}a(ue),a(P),D(()=>{et(X,"href",`${e(H)??""}/templates/${e(i).id??""}`),T(Ne,e(i).name)}),n(x,P)}),a(E),a(y),a(L);var h=o(L,2);{var Le=x=>{var i=Dt(),P=r(i);a(i),D(()=>T(P,`No templates match "${e(C)??""}"`)),n(x,i)};k(h,x=>{e(C)&&e(se).length===0&&x(Le)})}n(p,f)};k(u,p=>{e(O).length===0?p(v):p(b,!1)},!0)}n(t,l)};k(Fe,t=>{e(W)?t(Te):t(ke,!1)})}a(K),n(ge,K),He(),xe()}export{Yt as component};
