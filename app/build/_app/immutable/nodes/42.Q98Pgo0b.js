import"../chunks/DsnmJJEf.js";import{p as Re,s as _,a as Ve,u as We,b as s,d as Ye,e as Ze,h as l,c as r,f as M,i as e,g as He,n as D,r as a,t as F,j}from"../chunks/DDjrJUyi.js";import{s as T}from"../chunks/CwHIudaz.js";import{f as m,a as n,t as G,c as Je}from"../chunks/DbkN8AN9.js";import{i as E}from"../chunks/CGvWOYBA.js";import{e as Ke,s as Ue,i as Xe}from"../chunks/aSjiVL0V.js";import{h as et}from"../chunks/DHP91Nzo.js";import{s as tt,a as at}from"../chunks/Bcmc20em.js";import{p as rt}from"../chunks/BtCD1IG0.js";import{g as me}from"../chunks/C_3eB2yc.js";import{x as st,Y as lt,Z as ot}from"../chunks/yWEY6ChK.js";import{B as V,n as it,I as ae,S as nt,A as dt,F as pe,D as ct,g as vt,j as ut}from"../chunks/DkmOYVX9.js";import{E as mt}from"../chunks/CmwwU0OP.js";import{L as pt}from"../chunks/BWhLmYGf.js";import{B as re}from"../chunks/42UF-HRp.js";import{P as fe}from"../chunks/D07NXJ8f.js";import{E as ft}from"../chunks/BbiHGHGs.js";import{S as gt}from"../chunks/D85tjsDW.js";import{T as _t}from"../chunks/DQqcPUXs.js";var ht=m("<!> New Template",1),xt=m("<p> </p>"),$t=m("<!> <!>",1),bt=m('<div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><div><label for="template-name" class="form-label">Name</label> <!></div> <div><label for="template-slug" class="form-label">Slug</label> <!></div> <div><label for="template-category" class="form-label">Category</label> <!></div> <div><label for="template-description" class="form-label">Description (optional)</label> <!></div></div>'),yt=m('<div class="flex justify-center py-12"><!></div>'),wt=m("<!> Create Template",1),Ct=m('<div class="mb-4"><!></div>'),St=m('<span class="text-sm text-text-muted block truncate"> </span>'),Pt=m('<span class="text-sm text-text-muted"> </span>'),kt=m('<tr><td><a class="block group"><div class="flex items-center gap-3"><div class="data-table-icon"><!></div> <div class="min-w-0 flex-1"><span class="font-medium text-text group-hover:text-primary transition-colors block truncate"> </span> <!></div></div></a></td><td><!></td><td class="text-center"><!></td><td class="text-right"><!></td></tr>'),Dt=m('<div class="text-center py-8 text-text-muted"> </div>'),Ft=m('<!> <div class="data-table"><table class="w-full"><thead><tr><th class="text-left">Template</th><th class="text-left">Category</th><th class="text-center">Status</th><th class="text-right w-10"></th></tr></thead><tbody></tbody></table></div> <!>',1),Tt=m('<div class="p-6 max-w-5xl mx-auto"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6"><div><h1 class="text-2xl font-semibold text-text">Templates</h1> <p class="mt-1 text-sm text-text-muted">Reusable email designs for campaigns and sequences</p></div> <!></div> <!> <!> <!></div>');function Jt(ge,_e){Re(_e,!0);const he=()=>at(rt,"$page",xe),[xe,$e]=tt();let W=_(!0),O=_(Ve([])),w=_(""),C=_(""),B=_(!1),q=_(!1),S=_(""),P=_(""),Q=_(""),R=_("general"),Y=j(()=>`/${he().params.orgSlug}`),se=j(()=>e(O).filter(t=>t.name.toLowerCase().includes(e(C).toLowerCase())||t.slug.toLowerCase().includes(e(C).toLowerCase())||t.category.toLowerCase().includes(e(C).toLowerCase())));const le=[{value:"general",label:"General"},{value:"newsletter",label:"Newsletter"},{value:"promotional",label:"Promotional"},{value:"transactional",label:"Transactional"}];We(()=>{Z()});async function Z(){s(W,!0),s(w,"");try{const t=await st({});s(O,t.designs||[],!0)}catch(t){console.error("Failed to load templates:",t),s(w,"Failed to load templates")}finally{s(W,!1)}}function oe(){s(S,""),s(P,""),s(Q,""),s(R,"general"),s(B,!0)}function ie(){s(B,!1)}function be(t){return t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function ye(){s(P,be(e(S)),!0)}async function we(){if(!(!e(S)||!e(P))){s(q,!0),s(w,"");try{await lt({name:e(S),slug:e(P),description:e(Q),category:e(R),html_body:"<p>Start editing your template here...</p>",is_active:!0}),ie(),await Z()}catch(t){console.error("Failed to create template:",t),s(w,t.message||"Failed to create template",!0)}finally{s(q,!1)}}}async function Ce(t){if(confirm(`Delete "${t.name}"? This cannot be undone.`))try{await ot({},t.id),await Z()}catch(o){console.error("Failed to delete template:",o),s(w,o.message||"Failed to delete template",!0)}}function Se(t){switch(t){case"newsletter":return"info";case"promotional":return"warning";case"transactional":return"success";default:return"default"}}function Pe(t){return le.find(u=>u.value===t)?.label||t}var H=Tt();et("9pk6fy",t=>{Ze(()=>{He.title="Templates | Outlet"})});var J=r(H),ke=l(r(J),2);V(ke,{type:"primary",onclick:oe,get disabled(){return e(B)},children:(t,o)=>{var u=ht(),v=M(u);fe(v,{class:"mr-2 h-4 w-4"}),D(),n(t,u)},$$slots:{default:!0}}),a(J);var ne=l(J,2);{var De=t=>{dt(t,{type:"error",title:"Error",class:"mb-4",children:(o,u)=>{var v=xt(),h=r(v,!0);a(v),F(()=>T(h,e(w))),n(o,v)},$$slots:{default:!0}})};E(ne,t=>{e(w)&&t(De)})}var de=l(ne,2);it(de,{title:"Create New Template",get show(){return e(B)},set show(o){s(B,o,!0)},footer:o=>{var u=$t(),v=M(u);V(v,{type:"secondary",onclick:ie,get disabled(){return e(q)},children:(p,f)=>{D();var b=G("Cancel");n(p,b)},$$slots:{default:!0}});var h=l(v,2);{let p=j(()=>!e(S)||!e(P)||e(q));V(h,{type:"primary",onclick:we,get disabled(){return e(p)},children:(f,b)=>{D();var g=G();F(()=>T(g,e(q)?"Creating...":"Create Template")),n(f,g)},$$slots:{default:!0}})}n(o,u)},children:(o,u)=>{var v=bt(),h=r(v),p=l(r(h),2);ae(p,{id:"template-name",type:"text",oninput:ye,placeholder:"Welcome Email",get value(){return e(S)},set value(x){s(S,x,!0)}}),a(h);var f=l(h,2),b=l(r(f),2);ae(b,{id:"template-slug",type:"text",placeholder:"welcome-email",get value(){return e(P)},set value(x){s(P,x,!0)}}),a(f);var g=l(f,2),L=l(r(g),2);nt(L,{id:"template-category",get options(){return le},get value(){return e(R)},set value(x){s(R,x,!0)}}),a(g);var y=l(g,2),N=l(r(y),2);ae(N,{id:"template-description",type:"text",placeholder:"Main welcome email for new subscribers",get value(){return e(Q)},set value(x){s(Q,x,!0)}}),a(y),a(v),n(o,v)},$$slots:{footer:!0,default:!0}});var Fe=l(de,2);{var Te=t=>{var o=yt(),u=r(o);pt(u,{size:"large"}),a(o),n(t,o)},Ee=t=>{var o=Je(),u=M(o);{var v=p=>{mt(p,{get icon(){return pe},title:"No templates yet",description:"Create reusable email templates for your campaigns and sequences.",children:(f,b)=>{V(f,{type:"primary",onclick:oe,children:(g,L)=>{var y=wt(),N=M(y);fe(N,{class:"mr-2 h-4 w-4"}),D(),n(g,y)},$$slots:{default:!0}})},$$slots:{default:!0}})},h=p=>{var f=Ft(),b=M(f);{var g=$=>{var i=Ct(),k=r(i);ut(k,{placeholder:"Search templates...",get value(){return e(C)},set value(A){s(C,A,!0)}}),a(i),n($,i)};E(b,$=>{e(O).length>3&&$(g)})}var L=l(b,2),y=r(L),N=l(r(y));Ke(N,21,()=>e(se),Xe,($,i)=>{var k=kt(),A=r(k),K=r(A),ce=r(K),U=r(ce),Ne=r(U);pe(Ne,{class:"h-4 w-4"}),a(U);var ve=l(U,2),X=r(ve),ze=r(X,!0);a(X);var Ie=l(X,2);{var je=d=>{var c=St(),z=r(c,!0);a(c),F(()=>T(z,e(i).description)),n(d,c)},Be=d=>{var c=Pt(),z=r(c,!0);a(c),F(()=>T(z,e(i).slug)),n(d,c)};E(Ie,d=>{e(i).description?d(je):d(Be,!1)})}a(ve),a(ce),a(K),a(A);var ee=l(A),qe=r(ee);{let d=j(()=>Se(e(i).category));re(qe,{get variant(){return e(d)},size:"sm",children:(c,z)=>{D();var I=G();F(Qe=>T(I,Qe),[()=>Pe(e(i).category)]),n(c,I)},$$slots:{default:!0}})}a(ee);var te=l(ee),Ae=r(te);{var Me=d=>{re(d,{variant:"success",size:"sm",children:(c,z)=>{D();var I=G("Active");n(c,I)},$$slots:{default:!0}})},Ge=d=>{re(d,{variant:"default",size:"sm",children:(c,z)=>{D();var I=G("Inactive");n(c,I)},$$slots:{default:!0}})};E(Ae,d=>{e(i).is_active?d(Me):d(Ge,!1)})}a(te);var ue=l(te),Oe=r(ue);{let d=j(()=>({icon:ft,class:"p-1.5 rounded-lg hover:bg-bg-secondary transition-colors text-text-muted hover:text-text"})),c=j(()=>[{label:"Edit",icon:gt,onclick:()=>me(`${e(Y)}/templates/${e(i).id}`)},{label:"Duplicate",icon:vt,onclick:()=>me(`${e(Y)}/templates/new?duplicate=${e(i).id}`)},{divider:!0},{label:"Delete",icon:_t,variant:"danger",onclick:()=>Ce(e(i))}]);ct(Oe,{get trigger(){return e(d)},get items(){return e(c)}})}a(ue),a(k),F(()=>{Ue(K,"href",`${e(Y)??""}/templates/${e(i).id??""}`),T(ze,e(i).name)}),n($,k)}),a(N),a(y),a(L);var x=l(L,2);{var Le=$=>{var i=Dt(),k=r(i);a(i),F(()=>T(k,`No templates match "${e(C)??""}"`)),n($,i)};E(x,$=>{e(C)&&e(se).length===0&&$(Le)})}n(p,f)};E(u,p=>{e(O).length===0?p(v):p(h,!1)},!0)}n(t,o)};E(Fe,t=>{e(W)?t(Te):t(Ee,!1)})}a(H),n(ge,H),Ye(),$e()}export{Jt as component};
