import"../chunks/DsnmJJEf.js";import{f as k,p as Xt,s as y,a as Yt,u as Zt,b as u,d as te,e as ee,i as t,j as w,h as d,c as s,g as ae,n as ct,r,t as x}from"../chunks/odI--4Kw.js";import{d as re,s as v}from"../chunks/BNMK9zrr.js";import{c as ut,a as i,f as c,t as se}from"../chunks/CCInJaqd.js";import{l as oe,s as le,i as $}from"../chunks/COaB7F5h.js";import{e as Ct,a as ne,i as Dt,s as ie}from"../chunks/BohEjZuL.js";import{h as de}from"../chunks/hUjpWz_l.js";import{s as ce,a as ue}from"../chunks/DL1yFSKa.js";import{p as ve}from"../chunks/Wl_A6iPG.js";import{g as q}from"../chunks/J_BT3AZT.js";import{ae as pe,af as me}from"../chunks/CbJUEE85.js";import{a as fe,s as _e,B as St,g as xe,A as he,i as ge,D as $e,f as be}from"../chunks/CKHj2K0U.js";import{E as ye}from"../chunks/CF2FnicU.js";import{L as we}from"../chunks/D716f0vp.js";import{B as Ce}from"../chunks/BD7k7D4N.js";import{P as kt}from"../chunks/vPkRyia_.js";import{S as De}from"../chunks/uzw4XPgy.js";import{E as Se}from"../chunks/D9RG3a0A.js";import{S as ke}from"../chunks/CW92f3Ai.js";import"../chunks/B9hjHVe6.js";import{T as Pe}from"../chunks/Cu0Q0NU6.js";function Fe(X,O){const Y=oe(O,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16"}],["path",{d:"M18 17V9"}],["path",{d:"M13 17V5"}],["path",{d:"M8 17v-3"}]];fe(X,le({name:"chart-column"},()=>Y,{get iconNode(){return Z},children:(tt,K)=>{var b=ut(),C=k(b);_e(C,O,"default",{}),i(tt,b)},$$slots:{default:!0}}))}var Le=c("<!> New Campaign",1),Ee=c("<p> </p>"),Me=c('<div class="flex justify-center py-12"><!></div>'),Ne=c("<!> Create Campaign",1),je=c('<span class="tab-nav-count"> </span>'),Ae=c("<button> <!></button>"),Te=c('<span class="text-xs text-text-muted"> </span>'),ze=c('<span class="text-xs text-text-muted"> </span>'),Be=c('<div class="flex flex-col items-end"><span class="font-medium text-text"> </span> <span class="text-xs text-text-muted"> </span></div>'),Ve=c('<span class="text-text-muted">-</span>'),Ie=c('<div class="flex flex-col items-end"><span class="font-medium text-text"> </span> <span class="text-xs text-text-muted"> </span></div>'),qe=c('<span class="text-text-muted">-</span>'),Oe=c('<tr><td><a class="block group"><div class="min-w-0"><span class="font-medium text-text group-hover:text-primary transition-colors block truncate"> </span> <span class="text-sm text-text-muted block truncate"> </span></div></a></td><td><div class="flex flex-col gap-1"><!> <!></div></td><td class="text-right"><span class="font-medium text-text"> </span></td><td class="text-right"><!></td><td class="text-right"><!></td><td class="text-right"><!></td></tr>'),Ke=c('<div class="text-center py-8 text-text-muted"> </div>'),Qe=c('<div class="tab-nav mb-4"></div> <div class="mb-4"><!></div> <div class="data-table"><table class="w-full"><thead><tr><th class="text-left">Campaign</th><th class="text-left">Status</th><th class="text-right">Recipients</th><th class="text-right">Opened</th><th class="text-right">Clicked</th><th class="text-right w-10"></th></tr></thead><tbody></tbody></table></div> <!>',1),Re=c('<div class="p-6 max-w-6xl mx-auto"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6"><div><h1 class="text-2xl font-semibold text-text">Campaigns</h1> <p class="mt-1 text-sm text-text-muted">Send one-time email campaigns to your lists</p></div> <!></div> <!> <!></div> <!>',1);function pa(X,O){Xt(O,!0);const Y=()=>ue(ve,"$page",Z),[Z,tt]=ce();let K=y(!0),b=y(Yt([])),C=y(""),P=y(""),Q=y("all"),F=w(()=>`/${Y().params.brandSlug}`);const Pt=[{id:"all",label:"All"},{id:"draft",label:"Drafts"},{id:"scheduled",label:"Scheduled"},{id:"sending",label:"Sending"},{id:"sent",label:"Sent"}];let vt=w(()=>()=>{let e=t(b);if(t(Q)!=="all"&&(e=e.filter(n=>n.status===t(Q))),t(P)){const n=t(P).toLowerCase();e=e.filter(p=>p.name.toLowerCase().includes(n)||p.subject.toLowerCase().includes(n))}return e}),pt=w(()=>()=>{const e={all:t(b).length};for(const n of t(b))e[n.status]=(e[n.status]||0)+1;return e});Zt(()=>{mt()});async function mt(){u(K,!0),u(C,"");try{const e=await pe({});u(b,e.campaigns||[],!0)}catch(e){console.error("Failed to load campaigns:",e),u(C,"Failed to load campaigns")}finally{u(K,!1)}}let R=y(!1),U=y(null),et=y(!1);function Ft(e){u(U,e,!0),u(R,!0)}async function Lt(){if(t(U)){u(et,!0);try{await me({},t(U).id),await mt()}catch(e){console.error("Failed to delete campaign:",e),u(C,e.message||"Failed to delete campaign",!0)}finally{u(et,!1)}}}function Et(e){switch(e){case"draft":return"default";case"scheduled":return"info";case"sending":return"warning";case"sent":return"success";case"paused":return"error";case"cancelled":return"error";default:return"default"}}function ft(e){return e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""}function at(e){return e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}var _t=Re();de("1aozuv7",e=>{ee(()=>{ae.title="Campaigns | Outlet"})});var rt=k(_t),st=s(rt),Mt=d(s(st),2);St(Mt,{type:"primary",onclick:()=>q(`${t(F)}/campaigns/new`),children:(e,n)=>{var p=Le(),D=k(p);kt(D,{class:"mr-2 h-4 w-4"}),ct(),i(e,p)},$$slots:{default:!0}}),r(st);var xt=d(st,2);{var Nt=e=>{he(e,{type:"error",title:"Error",class:"mb-4",children:(n,p)=>{var D=Ee(),ot=s(D,!0);r(D),x(()=>v(ot,t(C))),i(n,D)},$$slots:{default:!0}})};$(xt,e=>{t(C)&&e(Nt)})}var jt=d(xt,2);{var At=e=>{var n=Me(),p=s(n);we(p,{size:"large"}),r(n),i(e,n)},Tt=e=>{var n=ut(),p=k(n);{var D=L=>{ye(L,{get icon(){return De},title:"No campaigns yet",description:"Create your first campaign to send emails to your subscribers.",children:(G,H)=>{St(G,{type:"primary",onclick:()=>q(`${t(F)}/campaigns/new`),children:(A,ht)=>{var E=Ne(),J=k(E);kt(J,{class:"mr-2 h-4 w-4"}),ct(),i(A,E)},$$slots:{default:!0}})},$$slots:{default:!0}})},ot=L=>{var G=Qe(),H=k(G);Ct(H,21,()=>Pt,Dt,(h,a)=>{var f=Ae();f.__click=()=>u(Q,t(a).id,!0);let M;var N=s(f),W=d(N);{var T=z=>{var j=je(),lt=s(j,!0);r(j),x(B=>v(lt,B),[()=>t(pt)()[t(a).id]]),i(z,j)};$(W,z=>{t(pt)()[t(a).id]&&z(T)})}r(f),x(()=>{M=ne(f,1,"tab-nav-item",null,M,{active:t(Q)===t(a).id}),v(N,`${t(a).label??""} `)}),i(h,f)}),r(H);var A=d(H,2),ht=s(A);ge(ht,{placeholder:"Search campaigns...",get value(){return t(P)},set value(h){u(P,h,!0)}}),r(A);var E=d(A,2),J=s(E),gt=d(s(J));Ct(gt,21,()=>t(vt)(),Dt,(h,a)=>{var f=Oe(),M=s(f),N=s(M),W=s(N),T=s(W),z=s(T,!0);r(T);var j=d(T,2),lt=s(j,!0);r(j),r(W),r(N),r(M);var B=d(M),$t=s(B),bt=s($t);{let o=w(()=>Et(t(a).status));Ce(bt,{get variant(){return t(o)},size:"sm",children:(l,m)=>{ct();var _=se();x(()=>v(_,t(a).status)),i(l,_)},$$slots:{default:!0}})}var It=d(bt,2);{var qt=o=>{var l=Te(),m=s(l,!0);r(l),x(_=>v(m,_),[()=>ft(t(a).scheduled_at)]),i(o,l)},Ot=o=>{var l=ut(),m=k(l);{var _=g=>{var S=ze(),V=s(S,!0);r(S),x(I=>v(V,I),[()=>ft(t(a).completed_at)]),i(g,S)};$(m,g=>{t(a).completed_at&&t(a).status==="sent"&&g(_)},!0)}i(o,l)};$(It,o=>{t(a).scheduled_at&&t(a).status==="scheduled"?o(qt):o(Ot,!1)})}r($t),r(B);var nt=d(B),yt=s(nt),Kt=s(yt,!0);r(yt),r(nt);var it=d(nt),Qt=s(it);{var Rt=o=>{var l=Be(),m=s(l),_=s(m,!0);r(m);var g=d(m,2),S=s(g);r(g),r(l),x((V,I)=>{v(_,V),v(S,`${I??""}%`)},[()=>at(t(a).opened_count),()=>(t(a).opened_count/t(a).sent_count*100).toFixed(1)]),i(o,l)},Ut=o=>{var l=Ve();i(o,l)};$(Qt,o=>{t(a).sent_count>0?o(Rt):o(Ut,!1)})}r(it);var dt=d(it),Gt=s(dt);{var Ht=o=>{var l=Ie(),m=s(l),_=s(m,!0);r(m);var g=d(m,2),S=s(g);r(g),r(l),x((V,I)=>{v(_,V),v(S,`${I??""}%`)},[()=>at(t(a).clicked_count),()=>(t(a).clicked_count/t(a).sent_count*100).toFixed(1)]),i(o,l)},Jt=o=>{var l=qe();i(o,l)};$(Gt,o=>{t(a).sent_count>0?o(Ht):o(Jt,!1)})}r(dt);var wt=d(dt),Wt=s(wt);{let o=w(()=>({icon:Se,class:"p-1.5 rounded-lg hover:bg-bg-secondary transition-colors text-text-muted hover:text-text"})),l=w(()=>[{label:"Edit",icon:ke,onclick:()=>q(`${t(F)}/campaigns/${t(a).id}`)},{label:"View stats",icon:Fe,onclick:()=>q(`${t(F)}/campaigns/${t(a).id}/stats`)},{label:"Duplicate",icon:be,onclick:()=>q(`${t(F)}/campaigns/new?duplicate=${t(a).id}`)},{divider:!0},{label:"Delete",icon:Pe,variant:"danger",onclick:()=>Ft(t(a))}]);$e(Wt,{get trigger(){return t(o)},get items(){return t(l)}})}r(wt),r(f),x(o=>{ie(N,"href",`${t(F)??""}/campaigns/${t(a).id??""}`),v(z,t(a).name),v(lt,t(a).subject),v(Kt,o)},[()=>at(t(a).recipients_count)]),i(h,f)}),r(gt),r(J),r(E);var Bt=d(E,2);{var Vt=h=>{var a=Ke(),f=s(a);r(a),x(()=>v(f,`No campaigns match "${t(P)??""}"`)),i(h,a)};$(Bt,h=>{t(P)&&t(vt)().length===0&&h(Vt)})}i(L,G)};$(p,L=>{t(b).length===0?L(D):L(ot,!1)},!0)}i(e,n)};$(jt,e=>{t(K)?e(At):e(Tt,!1)})}r(rt);var zt=d(rt,2);{let e=w(()=>`Delete "${t(U)?.name||""}"? This cannot be undone.`),n=w(()=>t(et)?"Deleting...":"Delete");xe(zt,{title:"Delete Campaign",get description(){return t(e)},get actionLabel(){return t(n)},actionType:"danger",onAction:Lt,onCancel:()=>u(R,!1),get open(){return t(R)},set open(p){u(R,p,!0)}})}i(X,_t),te(),tt()}re(["click"]);export{pa as component};
