import"../chunks/Bzak7iHL.js";import{f as A,p as le,d as E,j as de,u as ne,b as d,g as t,a as ve,h as ce,s as e,$ as pe,c as r,r as a,t as F,n as J,e as xt}from"../chunks/Ip2DykXx.js";import{d as ue,s as m}from"../chunks/DhOIAuLg.js";import{c as Lt,a as i,f as l,t as At}from"../chunks/BPgbRZ5o.js";import{l as me,s as _e,i as S}from"../chunks/BeCi3WIf.js";import{e as Tt,i as Rt}from"../chunks/-0-Kn73z.js";import{h as xe}from"../chunks/vHZS38u2.js";import{A as fe,C as ft,B as tt,F as ge}from"../chunks/Bphptf_a.js";import{L as he}from"../chunks/sFH_xjRy.js";import{S as zt}from"../chunks/O0AiFkiq.js";import{B as $e}from"../chunks/CK6k7lQK.js";import{R as ye}from"../chunks/CQK8yWuM.js";import{Z as be}from"../chunks/BLkG7klo.js";import"../chunks/hUurZXsg.js";import{s as we}from"../chunks/Df8mRDld.js";import{I as ke,X as Pe}from"../chunks/CYeJYM_Q.js";import{C as Ce}from"../chunks/Dx9qyz7C.js";import{C as Se}from"../chunks/P2yphoDx.js";import{C as Ee}from"../chunks/rz6TTqSb.js";function Fe(ot,et){const U=me(et,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.522.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const B=[["circle",{cx:"12",cy:"12",r:"10"}],["polyline",{points:"12 6 12 12 16 14"}]];ke(ot,_e({name:"clock"},()=>U,{get iconNode(){return B},children:(X,at)=>{var D=Lt(),I=A(D);we(I,et,"default",{}),i(X,D)},$$slots:{default:!0}}))}var Ae=l("<p> </p>"),Te=l("<!> Refresh",1),Re=l('<div class="flex items-center justify-between"><div><h2 class="text-lg font-medium text-text">Automation Log</h2> <p class="mt-1 text-sm text-text-muted">View history of rule executions and their outcomes</p></div> <!></div>'),ze=l("<option>All Events</option> <option>Ticket Created</option> <option>Ticket Updated</option> <option>Payment Succeeded</option> <option>Payment Failed</option> <option>Email Bounced</option> <option>Email Complained</option> <option>Customer Created</option> <option>Contact Created</option>",1),Le=l("<option>All</option> <option>Success</option> <option>Failed</option>",1),Be=l("<!> Apply",1),De=l('<div class="flex flex-wrap items-end gap-4"><div class="flex-1 min-w-[150px]"><label for="filter-event" class="form-label">Event Type</label> <!></div> <div class="flex-1 min-w-[150px]"><label for="filter-success" class="form-label">Status</label> <!></div> <div class="flex gap-2"><!> <!></div></div>'),Ie=l('<div class="text-center py-12"><!> <h3 class="mt-2 text-sm font-medium text-text">No automation events</h3> <p class="mt-1 text-sm text-text-muted">Rule executions will appear here when events trigger your rules.</p></div>'),Ne=l('<span class="flex items-center text-green-600"><!> Success</span>'),je=l('<span class="flex items-center text-red-600"><!> Failed</span>'),Ve=l('<div><h4 class="text-sm font-medium text-red-600 mb-1">Error</h4> <p class="text-sm text-red-500 bg-red-50 p-2 rounded"> </p></div>'),Ze=l('<pre class="mt-1 text-xs text-text-muted overflow-x-auto"> </pre>'),Je=l('<div class="bg-bg p-2 rounded border border-border"><span class="text-sm font-mono text-primary"> </span> <!></div>'),Me=l('<div><h4 class="text-sm font-medium text-text mb-2">Actions Executed</h4> <div class="space-y-2"></div></div>'),Oe=l('<div><h4 class="text-sm font-medium text-text mb-2">Event Payload</h4> <pre class="text-xs text-text-muted bg-bg p-2 rounded border border-border overflow-x-auto max-h-48"> </pre></div>'),Ue=l('<tr class="bg-bg-secondary"><td colspan="6" class="px-4 py-4"><div class="space-y-4"><!> <!> <!> <div class="text-xs text-text-muted">Event ID: <code class="bg-bg px-1 rounded"> </code></div></div></td></tr>'),Xe=l('<tr class="hover:bg-bg-secondary cursor-pointer"><td class="px-4 py-3 text-sm text-text-muted whitespace-nowrap"> </td><td class="px-4 py-3 whitespace-nowrap"><!></td><td class="px-4 py-3 text-sm text-text"> </td><td class="px-4 py-3 whitespace-nowrap"><!></td><td class="px-4 py-3 text-sm text-text-muted whitespace-nowrap"><span class="flex items-center"><!> </span></td><td class="px-4 py-3 text-sm text-text-muted"> </td></tr> <!>',1),qe=l('<div class="flex items-center justify-between border-t border-border px-4 py-3"><div class="text-sm text-text-muted"> </div> <div class="flex items-center gap-2"><!> <span class="text-sm text-text"> </span> <!></div></div>'),Ge=l('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-border"><thead><tr><th class="px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider">Time</th><th class="px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider">Event</th><th class="px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider">Rule</th><th class="px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider">Status</th><th class="px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider">Duration</th><th class="px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider">Actions</th></tr></thead><tbody class="divide-y divide-border"></tbody></table></div> <!>',1),He=l('<div class="space-y-6"><!> <!> <!></div>'),Ke=l("<!> <!>",1);function xa(ot,et){le(et,!0);let U=E(!0),B=E(""),X=E(de([])),at=E(0),D=E(1),I=E(""),q=E(""),x=E(1);const st=20;ne(()=>{Bt()});async function Bt(){d(U,!0),d(B,"");try{await G()}catch(o){console.error("Failed to load data:",o),d(B,o.message||"Failed to load data",!0)}finally{d(U,!1)}}async function G(){try{const o={page:t(x),page_size:st};t(I)&&(o.event_type=t(I)),t(q)&&(o.success=t(q));const b=await(void 0)(o);d(X,b.entries||[],!0),d(at,b.total,!0),d(D,b.pages,!0)}catch(o){console.error("Failed to load automation log:",o),d(B,o.message||"Failed to load automation log",!0)}}function Dt(){d(x,1),G()}function It(){d(I,""),d(q,""),d(x,1),G()}function gt(o){d(x,o,!0),G()}function Nt(o){return o<1e3?`${o}ms`:`${(o/1e3).toFixed(2)}s`}function jt(o){return new Date(o).toLocaleString()}function Vt(o){return o.includes("ticket")?"info":o.includes("payment")?"success":o.includes("email")?"warning":"default"}let it=E(null);function Zt(o){d(it,t(it)===o?null:o,!0)}var ht=Ke();xe("1xgk8il",o=>{ce(()=>{pe.title="Automation Log"})});var $t=A(ht);{var Jt=o=>{fe(o,{type:"error",title:"Error",children:(b,lt)=>{var M=Ae(),dt=r(M,!0);a(M),F(()=>m(dt,t(B))),i(b,M)},$$slots:{default:!0}})};S($t,o=>{t(B)&&o(Jt)})}var Mt=e($t,2);{var Ot=o=>{he(o,{size:"large"})},Ut=o=>{var b=He(),lt=r(b);ft(lt,{children:(H,yt)=>{var w=Re(),N=e(r(w),2);tt(N,{type:"secondary",onclick:()=>G(),children:(K,O)=>{var f=Te(),g=A(f);ye(g,{class:"mr-2 h-4 w-4"}),J(),i(K,f)},$$slots:{default:!0}}),a(w),i(H,w)},$$slots:{default:!0}});var M=e(lt,2);ft(M,{children:(H,yt)=>{var w=De(),N=r(w),K=e(r(N),2);zt(K,{id:"filter-event",get value(){return t(I)},set value(c){d(I,c,!0)},children:(c,Q)=>{var _=ze(),n=A(_);n.value=n.__value="";var s=e(n,2);s.value=s.__value="ticket.created";var u=e(s,2);u.value=u.__value="ticket.updated";var k=e(u,2);k.value=k.__value="payment.succeeded";var P=e(k,2);P.value=P.__value="payment.failed";var R=e(P,2);R.value=R.__value="email.bounced";var h=e(R,2);h.value=h.__value="email.complained";var j=e(h,2);j.value=j.__value="customer.created";var z=e(j,2);z.value=z.__value="contact.created",i(c,_)},$$slots:{default:!0}}),a(N);var O=e(N,2),f=e(r(O),2);zt(f,{id:"filter-success",get value(){return t(q)},set value(c){d(q,c,!0)},children:(c,Q)=>{var _=Le(),n=A(_);n.value=n.__value="";var s=e(n,2);s.value=s.__value="true";var u=e(s,2);u.value=u.__value="false",i(c,_)},$$slots:{default:!0}}),a(O);var g=e(O,2),T=r(g);tt(T,{type:"primary",onclick:Dt,children:(c,Q)=>{var _=Be(),n=A(_);ge(n,{class:"mr-2 h-4 w-4"}),J(),i(c,_)},$$slots:{default:!0}});var rt=e(T,2);tt(rt,{type:"secondary",onclick:It,children:(c,Q)=>{J();var _=At("Clear");i(c,_)},$$slots:{default:!0}}),a(g),a(w),i(H,w)},$$slots:{default:!0}});var dt=e(M,2);ft(dt,{children:(H,yt)=>{var w=Lt(),N=A(w);{var K=f=>{var g=Ie(),T=r(g);be(T,{class:"mx-auto h-12 w-12 text-text-muted"}),J(4),a(g),i(f,g)},O=f=>{var g=Ge(),T=A(g),rt=r(T),c=e(r(rt));Tt(c,21,()=>t(X),Rt,(n,s)=>{var u=Xe(),k=A(u);k.__click=()=>Zt(t(s).id);var P=r(k),R=r(P,!0);a(P);var h=e(P),j=r(h);{let p=xt(()=>Vt(t(s).event_type));$e(j,{get variant(){return t(p)},children:(v,C)=>{J();var W=At();F(()=>m(W,t(s).event_type)),i(v,W)},$$slots:{default:!0}})}a(h);var z=e(h),V=r(z,!0);a(z);var Z=e(z),nt=r(Z);{var Xt=p=>{var v=Ne(),C=r(v);Ce(C,{class:"h-4 w-4 mr-1"}),J(),a(v),i(p,v)},qt=p=>{var v=je(),C=r(v);Pe(C,{class:"h-4 w-4 mr-1"}),J(),a(v),i(p,v)};S(nt,p=>{t(s).success?p(Xt):p(qt,!1)})}a(Z);var vt=e(Z),bt=r(vt),wt=r(bt);Fe(wt,{class:"h-3 w-3 mr-1"});var Gt=e(wt);a(bt),a(vt);var kt=e(vt),Ht=r(kt);a(kt),a(k);var Kt=e(k,2);{var Qt=p=>{var v=Ue(),C=r(v),W=r(C),Pt=r(W);{var Wt=$=>{var y=Ve(),L=e(r(y),2),Y=r(L,!0);a(L),a(y),F(()=>m(Y,t(s).error_message)),i($,y)};S(Pt,$=>{t(s).error_message&&$(Wt)})}var Ct=e(Pt,2);{var Yt=$=>{var y=Me(),L=e(r(y),2);Tt(L,21,()=>t(s).actions_executed,Rt,(Y,ct)=>{var pt=Je(),ut=r(pt),ae=r(ut,!0);a(ut);var re=e(ut,2);{var oe=mt=>{var _t=Ze(),se=r(_t,!0);a(_t),F(ie=>m(se,ie),[()=>JSON.stringify(t(ct).params,null,2)]),i(mt,_t)};S(re,mt=>{t(ct).params&&mt(oe)})}a(pt),F(()=>m(ae,t(ct).type)),i(Y,pt)}),a(L),a(y),i($,y)};S(Ct,$=>{t(s).actions_executed&&t(s).actions_executed.length>0&&$(Yt)})}var St=e(Ct,2);{var te=$=>{var y=Oe(),L=e(r(y),2),Y=r(L,!0);a(L),a(y),F(()=>m(Y,t(s).event_payload)),i($,y)};S(St,$=>{t(s).event_payload&&$(te)})}var Et=e(St,2),Ft=e(r(Et)),ee=r(Ft,!0);a(Ft),a(Et),a(W),a(C),a(v),F(()=>m(ee,t(s).event_id)),i(p,v)};S(Kt,p=>{t(it)===t(s).id&&p(Qt)})}F((p,v)=>{var C;m(R,p),m(V,t(s).rule_name),m(Gt,` ${v??""}`),m(Ht,`${(((C=t(s).actions_executed)==null?void 0:C.length)||0)??""} action(s)`)},[()=>jt(t(s).created_at),()=>Nt(t(s).execution_time_ms)]),i(n,u)}),a(c),a(rt),a(T);var Q=e(T,2);{var _=n=>{var s=qe(),u=r(s),k=r(u);a(u);var P=e(u,2),R=r(P);{let V=xt(()=>t(x)<=1);tt(R,{type:"secondary",size:"sm",get disabled(){return t(V)},onclick:()=>gt(t(x)-1),children:(Z,nt)=>{Se(Z,{class:"h-4 w-4"})},$$slots:{default:!0}})}var h=e(R,2),j=r(h);a(h);var z=e(h,2);{let V=xt(()=>t(x)>=t(D));tt(z,{type:"secondary",size:"sm",get disabled(){return t(V)},onclick:()=>gt(t(x)+1),children:(Z,nt)=>{Ee(Z,{class:"h-4 w-4"})},$$slots:{default:!0}})}a(P),a(s),F(V=>{m(k,`Showing ${(t(x)-1)*st+1} to ${V??""} of ${t(at)??""} entries`),m(j,`Page ${t(x)??""} of ${t(D)??""}`)},[()=>Math.min(t(x)*st,t(at))]),i(n,s)};S(Q,n=>{t(D)>1&&n(_)})}i(f,g)};S(N,f=>{t(X).length===0?f(K):f(O,!1)})}i(H,w)},$$slots:{default:!0}}),a(b),i(o,b)};S(Mt,o=>{t(U)?o(Ot):o(Ut,!1)})}i(ot,ht),ve()}ue(["click"]);export{xa as component};
