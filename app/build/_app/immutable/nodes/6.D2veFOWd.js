import"../chunks/DsnmJJEf.js";import{f as Y,p as lt,u as Te,b as s,c as a,i as e,r as t,h as r,t as $,j as ie,d as nt,s as A,n as ne,a as Qe,m as Pt,$ as Nt,g as Mt}from"../chunks/odI--4Kw.js";import{d as it,s as w,e as jt}from"../chunks/BNMK9zrr.js";import{s as Ut}from"../chunks/C07Dfx-t.js";import{l as Le,s as Ee,p as At,i as z,c as Ve}from"../chunks/COaB7F5h.js";import{e as $e,s as X,a as ve,i as ke}from"../chunks/BohEjZuL.js";import{c as ue,a as n,f as u,t as Ae}from"../chunks/CCInJaqd.js";import{h as Tt}from"../chunks/hUjpWz_l.js";import{s as dt,a as ct}from"../chunks/DL1yFSKa.js";import{g as ce}from"../chunks/J_BT3AZT.js";import{p as vt}from"../chunks/Wl_A6iPG.js";import"../chunks/B9hjHVe6.js";import{a as Re,s as Fe,F as Lt,M as Et,I as Ze,B as et,A as Rt,X as Ft,h as tt}from"../chunks/CKHj2K0U.js";import{S as Gt}from"../chunks/uzw4XPgy.js";import{U as qt}from"../chunks/Dxq8Hv-0.js";import{T as Dt}from"../chunks/Cu0Q0NU6.js";import{S as Ht}from"../chunks/Be28jTKQ.js";import{M as at}from"../chunks/_cZI0v7b.js";import{C as Kt}from"../chunks/Ch6Q5zDb.js";import{A as Wt}from"../chunks/BT5ymYMx.js";import{j as Xt,l as Yt,c as Jt}from"../chunks/CbJUEE85.js";import{g as Qt,l as Vt}from"../chunks/CuiFJ7Vr.js";import{C as rt}from"../chunks/CBAWCkCk.js";import{M as Zt}from"../chunks/Bo4nJZq0.js";import{P as st}from"../chunks/vPkRyia_.js";function ea(E,b){const R=Le(b,["children","$$slots","$$events","$$legacy"]);const q=[["path",{d:"M4.929 4.929 19.07 19.071"}],["circle",{cx:"12",cy:"12",r:"10"}]];Re(E,Ee({name:"ban"},()=>R,{get iconNode(){return q},children:(D,m)=>{var k=ue(),v=Y(k);Fe(v,b,"default",{}),n(D,k)},$$slots:{default:!0}}))}function ta(E,b){const R=Le(b,["children","$$slots","$$events","$$legacy"]);const q=[["path",{d:"m15 18-6-6 6-6"}]];Re(E,Ee({name:"chevron-left"},()=>R,{get iconNode(){return q},children:(D,m)=>{var k=ue(),v=Y(k);Fe(v,b,"default",{}),n(D,k)},$$slots:{default:!0}}))}function aa(E,b){const R=Le(b,["children","$$slots","$$events","$$legacy"]);const q=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1"}]];Re(E,Ee({name:"layout-dashboard"},()=>R,{get iconNode(){return q},children:(D,m)=>{var k=ue(),v=Y(k);Fe(v,b,"default",{}),n(D,k)},$$slots:{default:!0}}))}const ra=async({params:E})=>({brandSlug:E.brandSlug}),Qa=Object.freeze(Object.defineProperty({__proto__:null,load:ra},Symbol.toStringTag,{value:"Module"}));var sa=u('<a class="sidebar-brand"><!> <span class="sidebar-brand-text"> </span></a>'),oa=u('<a class="sidebar-brand-icon"><!></a>'),la=u('<span class="sidebar-label"> </span>'),na=u("<a><!> <!></a>"),ia=u('<span class="sidebar-label"> </span>'),da=u("<a><!> <!></a>"),ca=u('<!> <span class="sidebar-label">Collapse</span>',1),va=u('<aside><div class="sidebar-header"><!></div> <nav class="sidebar-nav"></nav> <div class="flex-1"></div> <nav class="sidebar-nav sidebar-nav-bottom"><!> <button class="sidebar-collapse-btn"><!></button></nav></aside>');function ot(E,b){lt(b,!0);const R=()=>ct(vt,"$page",q),[q,D]=dt(),m=At(b,"orgName",3,"Outlet"),k="sidebar-collapsed";let v=A(!1);Te(()=>{{const c=localStorage.getItem(k);s(v,c==="true")}});function se(){s(v,!e(v)),localStorage.setItem(k,String(e(v)))}let S=ie(()=>`/${b.brandSlug}`);const H=[{id:"dashboard",label:"Dashboard",href:"",icon:aa,exact:!0},{id:"campaigns",label:"Campaigns",href:"/campaigns",icon:Gt},{id:"lists",label:"Lists",href:"/lists",icon:qt},{id:"templates",label:"Templates",href:"/templates",icon:Lt},{id:"housekeeping",label:"Housekeeping",href:"/housekeeping",icon:Dt},{id:"blocklist",label:"Blocklist",href:"/blocklist",icon:ea}],j=[{id:"settings",label:"Settings",href:"/settings",icon:Ht}];function I(c,l=!1){const x=`${e(S)}${c}`;return l?R().url.pathname===x||R().url.pathname===x+"/":R().url.pathname.startsWith(x)&&x!==e(S)}var F=va();let G;var T=a(F),Z=a(T);{var ee=c=>{var l=sa(),x=a(l);at(x,{class:"h-6 w-6 text-primary"});var h=r(x,2),i=a(h,!0);t(h),t(l),$(()=>{X(l,"href",e(S)),w(i,m())}),n(c,l)},Se=c=>{var l=oa(),x=a(l);at(x,{class:"h-6 w-6 text-primary"}),t(l),$(()=>X(l,"href",e(S))),n(c,l)};z(Z,c=>{e(v)?c(Se,!1):c(ee)})}t(T);var oe=r(T,2);$e(oe,21,()=>H,ke,(c,l)=>{const x=ie(()=>e(l).icon);var h=na();let i;var f=a(h);Ve(f,()=>e(x),(d,g)=>{g(d,{class:"sidebar-icon"})});var L=r(f,2);{var P=d=>{var g=la(),y=a(g,!0);t(g),$(()=>w(y,e(l).label)),n(d,g)};z(L,d=>{e(v)||d(P)})}t(h),$(d=>{X(h,"href",`${e(S)??""}${e(l).href??""}`),i=ve(h,1,"sidebar-link",null,i,d),X(h,"title",e(v)?e(l).label:void 0)},[()=>({active:I(e(l).href,e(l).exact)})]),n(c,h)}),t(oe);var de=r(oe,4),be=a(de);$e(be,17,()=>j,ke,(c,l)=>{const x=ie(()=>e(l).icon);var h=da();let i;var f=a(h);Ve(f,()=>e(x),(d,g)=>{g(d,{class:"sidebar-icon"})});var L=r(f,2);{var P=d=>{var g=ia(),y=a(g,!0);t(g),$(()=>w(y,e(l).label)),n(d,g)};z(L,d=>{e(v)||d(P)})}t(h),$(d=>{X(h,"href",`${e(S)??""}${e(l).href??""}`),i=ve(h,1,"sidebar-link",null,i,d),X(h,"title",e(v)?e(l).label:void 0)},[()=>({active:I(e(l).href)})]),n(c,h)});var te=r(be,2);te.__click=se;var Ce=a(te);{var Oe=c=>{Kt(c,{class:"h-4 w-4"})},me=c=>{var l=ca(),x=Y(l);ta(x,{class:"h-4 w-4"}),ne(2),n(c,l)};z(Ce,c=>{e(v)?c(Oe):c(me,!1)})}t(te),t(de),t(F),$(()=>{G=ve(F,1,"sidebar",null,G,{collapsed:e(v)}),X(te,"title",e(v)?"Expand sidebar":"Collapse sidebar")}),n(E,F),nt(),D()}it(["click"]);var ua=u('<meta name="robots" content="noindex, nofollow"/>'),ba=u('<div class="min-h-screen bg-base-50 flex items-center justify-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),ma=u('<div class="min-h-screen bg-base-50 flex items-center justify-center"><div class="text-error"> </div></div>'),pa=u('<button><span class="flex-1 text-sm font-medium text-text truncate"> </span> <!></button>'),fa=u('<div class="absolute left-1/2 -translate-x-1/2 top-full mt-2 w-64 rounded-lg shadow-lg py-1 z-50 bg-white border border-base-200"><div class="px-3 py-2 border-b border-border"><p class="text-xs font-medium text-text-muted uppercase tracking-wide">Brands</p></div> <div class="max-h-64 overflow-y-auto"></div> <div class="border-t border-border mt-1 pt-1"><button class="w-full px-3 py-2 flex items-center gap-2 text-left transition-colors hover:bg-base-100 text-text-muted hover:text-text"><!> <span class="text-sm">Add brand</span></button></div></div>'),ga=u('<div class="absolute right-0 top-full mt-2 w-56 rounded-lg shadow-lg py-1 z-50 bg-white border border-base-200"><div class="px-4 py-3 border-b border-border"><p class="text-sm font-medium text-text truncate"> </p></div> <a class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900">Settings</a> <div class="border-t border-border my-1"></div> <button class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900 w-full text-left">Switch Brand</button> <button class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900 w-full text-left">Sign out</button></div>'),_a=u('<div class="fixed inset-0 z-40 bg-black/50 md:hidden" role="button" tabindex="-1"></div> <div class="fixed inset-y-0 left-0 z-50 w-[220px] md:hidden"><!></div>',1),xa=u('<button><span class="flex-1 text-sm font-medium text-text truncate"> </span> <!></button>'),ha=u('<div class="absolute right-0 top-full mt-2 w-64 rounded-lg shadow-lg py-1 z-50 bg-white border border-base-200"><div class="px-3 py-2 border-b border-border"><p class="text-xs font-medium text-text-muted uppercase tracking-wide">Brands</p></div> <div class="max-h-64 overflow-y-auto"></div> <div class="border-t border-border mt-1 pt-1"><button class="w-full px-3 py-2 flex items-center gap-2 text-left transition-colors hover:bg-base-100 text-text-muted hover:text-text"><!> <span class="text-sm">Add brand</span></button></div></div>'),ya=u('<div class="absolute right-0 top-full mt-2 w-56 rounded-lg shadow-lg py-1 z-50 bg-white border border-base-200"><div class="px-4 py-3 border-b border-border"><p class="text-sm font-medium text-text truncate"> </p> <p class="text-xs text-text-muted capitalize"> </p></div> <a class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900">Settings</a> <div class="border-t border-border my-1"></div> <button class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900 w-full text-left">Switch Brand</button> <button class="block px-4 py-2 text-sm transition-colors text-base-700 hover:bg-base-100 hover:text-base-900 w-full text-left">Sign out</button></div>'),wa=u('<div class="admin-layout"><div class="admin-sidebar hidden md:block"><!></div> <div class="fixed top-0 left-0 right-0 h-14 px-4 flex items-center justify-between z-40 border-b border-base-200 bg-white md:hidden"><button class="p-2 rounded-lg transition-colors text-text-muted hover:bg-base-100"><!></button> <div class="brand-switcher relative"><button class="flex items-center gap-1 font-semibold text-text"> <!></button> <!></div> <div class="user-menu-container relative"><button class="flex items-center gap-2 p-1 rounded-lg transition-colors hover:bg-base-100"><div class="flex items-center justify-center h-8 w-8 rounded-full text-sm font-medium text-white bg-primary"> </div></button> <!></div></div> <!> <div class="admin-main"><header class="h-16 px-6 items-center justify-end border-b border-base-200 sticky top-0 z-20 bg-white hidden md:flex"><div class="flex items-center gap-4"><div class="brand-switcher relative"><button class="flex items-center gap-2 px-2 py-1.5 rounded-lg transition-colors hover:bg-base-100 group"><span class="text-sm text-text-muted">Brand:</span> <span class="font-medium text-sm"> </span> <!></button> <!></div> <div class="user-menu-container relative"><button class="flex items-center gap-2 p-1 rounded-lg transition-colors hover:bg-base-100"><div class="flex items-center justify-center h-8 w-8 rounded-full text-sm font-medium text-white bg-primary"> </div> <span class="text-sm text-text-muted hidden lg:block"> </span></button> <!></div></div></header> <main class="flex-1"><!></main></div></div>'),$a=u("<!> <!>",1),ka=u('<div class="space-y-4"><!> <div><label for="brand-name" class="block text-sm font-medium text-text mb-1">Brand Name</label> <!></div> <div><label for="brand-slug" class="block text-sm font-medium text-text mb-1">URL Slug</label> <!> <p class="text-xs text-text-muted mt-1"> </p></div></div>'),Sa=u("<!> <!>",1);function Va(E,b){lt(b,!0);const R=()=>ct(vt,"$page",q),[q,D]=dt();let m=A(null),k=A(Qe([])),v=A(!0),se=A(""),S=Qe(Qt()),H=A(!1),j=A(!1),I=A(!1),F=A(!1),G=A(""),T=A(""),Z=A(!1),ee=A("");Te(()=>{Se()}),Te(()=>{R().url.pathname,s(H,!1)});async function Se(){s(v,!0),s(se,"");try{const[i,f]=await Promise.all([Xt({},b.data.brandSlug),Yt()]);s(m,i,!0),s(k,(f.organizations||[]).sort((P,d)=>P.name.localeCompare(d.name)),!0),localStorage.setItem("currentOrgId",e(m).id),localStorage.setItem("currentOrgName",e(m).name),localStorage.setItem("currentOrgSlug",e(m).slug);const L=localStorage.getItem(`orgSetupSkipped_${e(m).slug}`);if(!e(m).from_email&&!L){ce(`/${e(m).slug}/welcome`);return}}catch(i){console.error("Failed to load organization:",i),s(se,`Organization "${b.data.brandSlug}" not found`),ce("/")}finally{s(v,!1)}}function oe(){localStorage.removeItem("currentOrgId"),localStorage.removeItem("currentOrgName"),localStorage.removeItem("currentOrgSlug"),ce("/")}function de(){Vt()}function be(i){const f=i.target;f.closest(".user-menu-container")||s(j,!1),f.closest(".brand-switcher")||s(I,!1)}function te(i){s(I,!1),ce(`/${i}`)}function Ce(i){return i.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function Oe(){s(T,Ce(e(G)),!0)}function me(){s(I,!1),s(G,""),s(T,""),s(ee,""),s(F,!0)}async function c(){if(!(!e(G).trim()||!e(T).trim())){s(Z,!0),s(ee,"");try{const i=await Jt({name:e(G).trim(),slug:e(T).trim()});s(F,!1),ce(`/${i.slug}/welcome`)}catch(i){s(ee,i.message||"Failed to create brand",!0)}finally{s(Z,!1)}}}var l=Sa();Tt("1xdtdtq",i=>{var f=ua();Pt(()=>{Mt.title=`${(e(m)?.name||"Admin")??""} | Outlet`}),n(i,f)}),jt("click",Nt,be);var x=Y(l);Wt(x,{children:(i,f)=>{var L=ue(),P=Y(L);{var d=y=>{var K=ba();n(y,K)},g=y=>{var K=ue(),ae=Y(K);{var pe=J=>{var C=ma(),Q=a(C),ge=a(Q,!0);t(Q),t(C),$(()=>w(ge,e(se))),n(J,C)},fe=J=>{var C=wa(),Q=a(C),ge=a(Q);{let o=ie(()=>e(m)?.name);ot(ge,{get brandSlug(){return b.data.brandSlug},get orgName(){return e(o)}})}t(Q);var le=r(Q,2),_e=a(le);_e.__click=()=>s(H,!e(H));var ut=a(_e);{var bt=o=>{Ft(o,{class:"h-6 w-6"})},mt=o=>{Zt(o,{class:"h-6 w-6"})};z(ut,o=>{e(H)?o(bt):o(mt,!1)})}t(_e);var Be=r(_e,2),xe=a(Be);xe.__click=o=>{o.stopPropagation(),s(j,!1),s(I,!e(I))};var Ge=a(xe),pt=r(Ge);rt(pt,{class:"h-4 w-4 text-text-muted"}),t(xe);var ft=r(xe,2);{var gt=o=>{var p=fa(),_=r(a(p),2);$e(_,21,()=>e(k),ke,(V,B)=>{var M=pa();M.__click=()=>te(e(B).slug);var W=a(M),Me=a(W,!0);t(W);var je=r(W,2);{var Ue=re=>{tt(re,{class:"h-4 w-4 text-primary flex-shrink-0"})};z(je,re=>{e(B).id===e(m)?.id&&re(Ue)})}t(M),$(()=>{ve(M,1,`w-full px-3 py-2 flex items-center gap-2 text-left transition-colors hover:bg-base-100 ${e(B).id===e(m)?.id?"bg-base-50":""}`),w(Me,e(B).name)}),n(V,M)}),t(_);var O=r(_,2),U=a(O);U.__click=me;var N=a(U);st(N,{class:"h-4 w-4"}),ne(2),t(U),t(O),t(p),n(o,p)};z(ft,o=>{e(I)&&o(gt)})}t(Be);var qe=r(Be,2),he=a(qe);he.__click=o=>{o.stopPropagation(),s(I,!1),s(j,!e(j))};var De=a(he),_t=a(De,!0);t(De),t(he);var xt=r(he,2);{var ht=o=>{var p=ga(),_=a(p),O=a(_),U=a(O,!0);t(O),t(_);var N=r(_,2);N.__click=()=>s(j,!1);var V=r(N,4);V.__click=oe;var B=r(V,2);B.__click=de,t(p),$(()=>{w(U,S?.email),X(N,"href",`/${b.data.brandSlug??""}/settings`)}),n(o,p)};z(xt,o=>{e(j)&&o(ht)})}t(qe),t(le);var He=r(le,2);{var yt=o=>{var p=_a(),_=Y(p);_.__click=()=>s(H,!1),_.__keydown=N=>N.key==="Escape"&&s(H,!1);var O=r(_,2),U=a(O);{let N=ie(()=>e(m)?.name);ot(U,{get brandSlug(){return b.data.brandSlug},get orgName(){return e(N)}})}t(O),n(o,p)};z(He,o=>{e(H)&&o(yt)})}var Ke=r(He,2),ze=a(Ke),We=a(ze),Ie=a(We),ye=a(Ie);ye.__click=o=>{o.stopPropagation(),s(j,!1),s(I,!e(I))};var Pe=r(a(ye),2),wt=a(Pe,!0);t(Pe);var $t=r(Pe,2);rt($t,{class:"h-4 w-4 text-text-muted group-hover:text-text transition-colors"}),t(ye);var kt=r(ye,2);{var St=o=>{var p=ha(),_=r(a(p),2);$e(_,21,()=>e(k),ke,(V,B)=>{var M=xa();M.__click=()=>te(e(B).slug);var W=a(M),Me=a(W,!0);t(W);var je=r(W,2);{var Ue=re=>{tt(re,{class:"h-4 w-4 text-primary flex-shrink-0"})};z(je,re=>{e(B).id===e(m)?.id&&re(Ue)})}t(M),$(()=>{ve(M,1,`w-full px-3 py-2 flex items-center gap-2 text-left transition-colors hover:bg-base-100 ${e(B).id===e(m)?.id?"bg-base-50":""}`),w(Me,e(B).name)}),n(V,M)}),t(_);var O=r(_,2),U=a(O);U.__click=me;var N=a(U);st(N,{class:"h-4 w-4"}),ne(2),t(U),t(O),t(p),n(o,p)};z(kt,o=>{e(I)&&o(St)})}t(Ie);var Xe=r(Ie,2),we=a(Xe);we.__click=o=>{o.stopPropagation(),s(I,!1),s(j,!e(j))};var Ne=a(we),Ct=a(Ne,!0);t(Ne);var Ye=r(Ne,2),Ot=a(Ye,!0);t(Ye),t(we);var Bt=r(we,2);{var zt=o=>{var p=ya(),_=a(p),O=a(_),U=a(O,!0);t(O);var N=r(O,2),V=a(N,!0);t(N),t(_);var B=r(_,2);B.__click=()=>s(j,!1);var M=r(B,4);M.__click=oe;var W=r(M,2);W.__click=de,t(p),$(()=>{w(U,S?.email),w(V,S?.role||"user"),X(B,"href",`/${b.data.brandSlug??""}/settings`)}),n(o,p)};z(Bt,o=>{e(j)&&o(zt)})}t(Xe),t(We),t(ze);var Je=r(ze,2),It=a(Je);Ut(It,()=>b.children),t(Je),t(Ke),t(C),$((o,p)=>{w(Ge,`${(e(m)?.name||"Outlet")??""} `),w(_t,o),w(wt,e(m)?.name||"Organization"),w(Ct,p),w(Ot,S?.email)},[()=>(S?.name||S?.email||"U")[0].toUpperCase(),()=>(S?.name||S?.email||"U")[0].toUpperCase()]),n(J,C)};z(ae,J=>{e(se)?J(pe):J(fe,!1)},!0)}n(y,K)};z(P,y=>{e(v)?y(d):y(g,!1)})}n(i,L)},$$slots:{default:!0}});var h=r(x,2);Et(h,{title:"Create Brand",get show(){return e(F)},set show(f){s(F,f,!0)},footer:f=>{var L=$a(),P=Y(L);et(P,{type:"secondary",onclick:()=>s(F,!1),get disabled(){return e(Z)},children:(g,y)=>{ne();var K=Ae("Cancel");n(g,K)},$$slots:{default:!0}});var d=r(P,2);{let g=ie(()=>!e(G).trim()||!e(T).trim()||e(Z));et(d,{type:"primary",onclick:c,get disabled(){return e(g)},children:(y,K)=>{ne();var ae=Ae();$(()=>w(ae,e(Z)?"Creating...":"Create Brand")),n(y,ae)},$$slots:{default:!0}})}n(f,L)},children:(f,L)=>{var P=ka(),d=a(P);{var g=C=>{Rt(C,{type:"error",children:(Q,ge)=>{ne();var le=Ae();$(()=>w(le,e(ee))),n(Q,le)},$$slots:{default:!0}})};z(d,C=>{e(ee)&&C(g)})}var y=r(d,2),K=r(a(y),2);Ze(K,{id:"brand-name",oninput:Oe,placeholder:"My Company",get value(){return e(G)},set value(C){s(G,C,!0)}}),t(y);var ae=r(y,2),pe=r(a(ae),2);Ze(pe,{id:"brand-slug",placeholder:"my-company",get value(){return e(T)},set value(C){s(T,C,!0)}});var fe=r(pe,2),J=a(fe);t(fe),t(ae),t(P),$(()=>w(J,`This will be used in the URL: /${(e(T)||"my-company")??""}`)),n(f,P)},$$slots:{footer:!0,default:!0}}),n(E,l),nt(),D()}it(["click","keydown"]);export{Va as component,Qa as universal};
