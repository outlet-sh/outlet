import"../chunks/DsnmJJEf.js";import{p as Ue,s as m,a as Xe,u as Ye,b as a,f as B,d as Ze,e as et,i as e,h as s,c as l,j as w,g as tt,n as F,r,t as k}from"../chunks/odI--4Kw.js";import{s as L}from"../chunks/BNMK9zrr.js";import{a as i,f as p,t as G,c as at}from"../chunks/CCInJaqd.js";import{i as E}from"../chunks/COaB7F5h.js";import{e as rt,s as lt,i as st}from"../chunks/BohEjZuL.js";import{h as ot}from"../chunks/hUjpWz_l.js";import{s as it,a as nt}from"../chunks/DL1yFSKa.js";import{p as dt}from"../chunks/Wl_A6iPG.js";import{g as _e}from"../chunks/J_BT3AZT.js";import{w as ct,$ as ut,a0 as vt}from"../chunks/CbJUEE85.js";import{B as H,o as mt,g as pt,I as se,S as ft,A as gt,F as he,D as _t,f as ht,i as xt}from"../chunks/CKHj2K0U.js";import{E as $t}from"../chunks/CF2FnicU.js";import{L as bt}from"../chunks/D716f0vp.js";import{B as oe}from"../chunks/BD7k7D4N.js";import{P as xe}from"../chunks/vPkRyia_.js";import{E as yt}from"../chunks/D9RG3a0A.js";import{S as wt}from"../chunks/CW92f3Ai.js";import{T as Ct}from"../chunks/Cu0Q0NU6.js";var Dt=p("<!> New Template",1),St=p("<p> </p>"),Tt=p("<!> <!>",1),Pt=p('<div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><div><label for="template-name" class="form-label">Name</label> <!></div> <div><label for="template-slug" class="form-label">Slug</label> <!></div> <div><label for="template-category" class="form-label">Category</label> <!></div> <div><label for="template-description" class="form-label">Description (optional)</label> <!></div></div>'),Ft=p('<div class="flex justify-center py-12"><!></div>'),kt=p("<!> Create Template",1),Lt=p('<div class="mb-4"><!></div>'),Et=p('<span class="text-sm text-text-muted block truncate"> </span>'),Nt=p('<span class="text-sm text-text-muted"> </span>'),zt=p('<tr><td><a class="block group"><div class="flex items-center gap-3"><div class="data-table-icon"><!></div> <div class="min-w-0 flex-1"><span class="font-medium text-text group-hover:text-primary transition-colors block truncate"> </span> <!></div></div></a></td><td><!></td><td class="text-center"><!></td><td class="text-right"><!></td></tr>'),It=p('<div class="text-center py-8 text-text-muted"> </div>'),At=p('<!> <div class="data-table"><table class="w-full"><thead><tr><th class="text-left">Template</th><th class="text-left">Category</th><th class="text-center">Status</th><th class="text-right w-10"></th></tr></thead><tbody></tbody></table></div> <!>',1),Bt=p('<div class="p-6 max-w-5xl mx-auto"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6"><div><h1 class="text-2xl font-semibold text-text">Templates</h1> <p class="mt-1 text-sm text-text-muted">Reusable email designs for campaigns and sequences</p></div> <!></div> <!> <!> <!></div> <!>',1);function ra($e,be){Ue(be,!0);const ye=()=>nt(dt,"$page",we),[we,Ce]=it();let J=m(!0),O=m(Xe([])),C=m(""),D=m(""),j=m(!1),q=m(!1),S=m(""),T=m(""),Q=m(""),R=m("general"),K=w(()=>`/${ye().params.brandSlug}`),ie=w(()=>e(O).filter(t=>t.name.toLowerCase().includes(e(D).toLowerCase())||t.slug.toLowerCase().includes(e(D).toLowerCase())||t.category.toLowerCase().includes(e(D).toLowerCase())));const ne=[{value:"general",label:"General"},{value:"newsletter",label:"Newsletter"},{value:"promotional",label:"Promotional"},{value:"transactional",label:"Transactional"}];Ye(()=>{U()});async function U(){a(J,!0),a(C,"");try{const t=await ct({});a(O,t.designs||[],!0)}catch(t){console.error("Failed to load templates:",t),a(C,"Failed to load templates")}finally{a(J,!1)}}function de(){a(S,""),a(T,""),a(Q,""),a(R,"general"),a(j,!0)}function ce(){a(j,!1)}function De(t){return t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function Se(){a(T,De(e(S)),!0)}async function Te(){if(!(!e(S)||!e(T))){a(q,!0),a(C,"");try{await vt({name:e(S),slug:e(T),description:e(Q),category:e(R),html_body:"<p>Start editing your template here...</p>",is_active:!0}),ce(),await U()}catch(t){console.error("Failed to create template:",t),a(C,t.message||"Failed to create template",!0)}finally{a(q,!1)}}}let V=m(!1),W=m(null),X=m(!1);function Pe(t){a(W,t,!0),a(V,!0)}async function Fe(){if(e(W)){a(X,!0);try{await ut({},e(W).id),await U()}catch(t){console.error("Failed to delete template:",t),a(C,t.message||"Failed to delete template",!0)}finally{a(X,!1)}}}function ke(t){switch(t){case"newsletter":return"info";case"promotional":return"warning";case"transactional":return"success";default:return"default"}}function Le(t){return ne.find(c=>c.value===t)?.label||t}var ue=Bt();ot("pzy5f",t=>{et(()=>{tt.title="Templates | Outlet"})});var Y=B(ue),Z=l(Y),Ee=s(l(Z),2);H(Ee,{type:"primary",onclick:de,get disabled(){return e(j)},children:(t,n)=>{var c=Dt(),v=B(c);xe(v,{class:"mr-2 h-4 w-4"}),F(),i(t,c)},$$slots:{default:!0}}),r(Z);var ve=s(Z,2);{var Ne=t=>{gt(t,{type:"error",title:"Error",class:"mb-4",children:(n,c)=>{var v=St(),h=l(v,!0);r(v),k(()=>L(h,e(C))),i(n,v)},$$slots:{default:!0}})};E(ve,t=>{e(C)&&t(Ne)})}var me=s(ve,2);mt(me,{title:"Create New Template",get show(){return e(j)},set show(n){a(j,n,!0)},footer:n=>{var c=Tt(),v=B(c);H(v,{type:"secondary",onclick:ce,get disabled(){return e(q)},children:(f,g)=>{F();var b=G("Cancel");i(f,b)},$$slots:{default:!0}});var h=s(v,2);{let f=w(()=>!e(S)||!e(T)||e(q));H(h,{type:"primary",onclick:Te,get disabled(){return e(f)},children:(g,b)=>{F();var _=G();k(()=>L(_,e(q)?"Creating...":"Create Template")),i(g,_)},$$slots:{default:!0}})}i(n,c)},children:(n,c)=>{var v=Pt(),h=l(v),f=s(l(h),2);se(f,{id:"template-name",type:"text",oninput:Se,placeholder:"Welcome Email",get value(){return e(S)},set value(x){a(S,x,!0)}}),r(h);var g=s(h,2),b=s(l(g),2);se(b,{id:"template-slug",type:"text",placeholder:"welcome-email",get value(){return e(T)},set value(x){a(T,x,!0)}}),r(g);var _=s(g,2),N=s(l(_),2);ft(N,{id:"template-category",get options(){return ne},get value(){return e(R)},set value(x){a(R,x,!0)}}),r(_);var y=s(_,2),z=s(l(y),2);se(z,{id:"template-description",type:"text",placeholder:"Main welcome email for new subscribers",get value(){return e(Q)},set value(x){a(Q,x,!0)}}),r(y),r(v),i(n,v)},$$slots:{footer:!0,default:!0}});var ze=s(me,2);{var Ie=t=>{var n=Ft(),c=l(n);bt(c,{size:"large"}),r(n),i(t,n)},Ae=t=>{var n=at(),c=B(n);{var v=f=>{$t(f,{get icon(){return he},title:"No templates yet",description:"Create reusable email templates for your campaigns and sequences.",children:(g,b)=>{H(g,{type:"primary",onclick:de,children:(_,N)=>{var y=kt(),z=B(y);xe(z,{class:"mr-2 h-4 w-4"}),F(),i(_,y)},$$slots:{default:!0}})},$$slots:{default:!0}})},h=f=>{var g=At(),b=B(g);{var _=$=>{var o=Lt(),P=l(o);xt(P,{placeholder:"Search templates...",get value(){return e(D)},set value(M){a(D,M,!0)}}),r(o),i($,o)};E(b,$=>{e(O).length>3&&$(_)})}var N=s(b,2),y=l(N),z=s(l(y));rt(z,21,()=>e(ie),st,($,o)=>{var P=zt(),M=l(P),ee=l(M),pe=l(ee),te=l(pe),qe=l(te);he(qe,{class:"h-4 w-4"}),r(te);var fe=s(te,2),ae=l(fe),Me=l(ae,!0);r(ae);var Ge=s(ae,2);{var Oe=d=>{var u=Et(),I=l(u,!0);r(u),k(()=>L(I,e(o).description)),i(d,u)},Qe=d=>{var u=Nt(),I=l(u,!0);r(u),k(()=>L(I,e(o).slug)),i(d,u)};E(Ge,d=>{e(o).description?d(Oe):d(Qe,!1)})}r(fe),r(pe),r(ee),r(M);var re=s(M),Re=l(re);{let d=w(()=>ke(e(o).category));oe(Re,{get variant(){return e(d)},size:"sm",children:(u,I)=>{F();var A=G();k(Ke=>L(A,Ke),[()=>Le(e(o).category)]),i(u,A)},$$slots:{default:!0}})}r(re);var le=s(re),Ve=l(le);{var We=d=>{oe(d,{variant:"success",size:"sm",children:(u,I)=>{F();var A=G("Active");i(u,A)},$$slots:{default:!0}})},He=d=>{oe(d,{variant:"default",size:"sm",children:(u,I)=>{F();var A=G("Inactive");i(u,A)},$$slots:{default:!0}})};E(Ve,d=>{e(o).is_active?d(We):d(He,!1)})}r(le);var ge=s(le),Je=l(ge);{let d=w(()=>({icon:yt,class:"p-1.5 rounded-lg hover:bg-bg-secondary transition-colors text-text-muted hover:text-text"})),u=w(()=>[{label:"Edit",icon:wt,onclick:()=>_e(`${e(K)}/templates/${e(o).id}`)},{label:"Duplicate",icon:ht,onclick:()=>_e(`${e(K)}/templates/new?duplicate=${e(o).id}`)},{divider:!0},{label:"Delete",icon:Ct,variant:"danger",onclick:()=>Pe(e(o))}]);_t(Je,{get trigger(){return e(d)},get items(){return e(u)}})}r(ge),r(P),k(()=>{lt(ee,"href",`${e(K)??""}/templates/${e(o).id??""}`),L(Me,e(o).name)}),i($,P)}),r(z),r(y),r(N);var x=s(N,2);{var je=$=>{var o=It(),P=l(o);r(o),k(()=>L(P,`No templates match "${e(D)??""}"`)),i($,o)};E(x,$=>{e(D)&&e(ie).length===0&&$(je)})}i(f,g)};E(c,f=>{e(O).length===0?f(v):f(h,!1)},!0)}i(t,n)};E(ze,t=>{e(J)?t(Ie):t(Ae,!1)})}r(Y);var Be=s(Y,2);{let t=w(()=>`Delete "${e(W)?.name||""}"? This cannot be undone.`),n=w(()=>e(X)?"Deleting...":"Delete");pt(Be,{title:"Delete Template",get description(){return e(t)},get actionLabel(){return e(n)},actionType:"danger",onAction:Fe,onCancel:()=>a(V,!1),get open(){return e(V)},set open(c){a(V,c,!0)}})}i($e,ue),Ze(),Ce()}export{ra as component};
