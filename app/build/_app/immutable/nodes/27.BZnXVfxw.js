import"../chunks/DsnmJJEf.js";import{f as N,p as Rt,s as q,a as Ut,u as Gt,b,d as Ht,e as Jt,i as t,j as M,h as d,c as r,g as Wt,n as nt,r as s,t as _}from"../chunks/odI--4Kw.js";import{d as Xt,s as v}from"../chunks/BNMK9zrr.js";import{c as it,a as i,f as c,t as Yt}from"../chunks/CCInJaqd.js";import{l as Zt,s as te,i as g}from"../chunks/COaB7F5h.js";import{e as $t,a as ee,i as bt,s as ae}from"../chunks/BohEjZuL.js";import{h as se}from"../chunks/hUjpWz_l.js";import{s as re,a as oe}from"../chunks/DL1yFSKa.js";import{p as le}from"../chunks/B8l5u2D4.js";import{g as I}from"../chunks/WWD3OlSc.js";import{ae as ne,af as ie}from"../chunks/MOXZsotB.js";import{a as de,s as ce,B as yt,A as ve,i as ue,D as pe,f as me}from"../chunks/B2E-c0C9.js";import{E as fe}from"../chunks/CPRLrdFK.js";import{L as _e}from"../chunks/D716f0vp.js";import{B as xe}from"../chunks/BD7k7D4N.js";import{P as wt}from"../chunks/g3qaOJz4.js";import{S as he}from"../chunks/DMxAZ-CD.js";import{E as ge}from"../chunks/qscMUjvl.js";import{S as $e}from"../chunks/C9UsJ-0h.js";import"../chunks/B9hjHVe6.js";import{T as be}from"../chunks/DHikf9no.js";function ye(J,O){const W=Zt(O,["children","$$slots","$$events","$$legacy"]);const X=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16"}],["path",{d:"M18 17V9"}],["path",{d:"M13 17V5"}],["path",{d:"M8 17v-3"}]];de(J,te({name:"chart-column"},()=>W,{get iconNode(){return X},children:(Y,K)=>{var $=it(),y=N($);ce(y,O,"default",{}),i(Y,$)},$$slots:{default:!0}}))}var we=c("<!> New Campaign",1),Ce=c("<p> </p>"),Se=c('<div class="flex justify-center py-12"><!></div>'),ke=c("<!> Create Campaign",1),De=c('<span class="tab-nav-count"> </span>'),Pe=c("<button> <!></button>"),Fe=c('<span class="text-xs text-text-muted"> </span>'),Ee=c('<span class="text-xs text-text-muted"> </span>'),Le=c('<div class="flex flex-col items-end"><span class="font-medium text-text"> </span> <span class="text-xs text-text-muted"> </span></div>'),Me=c('<span class="text-text-muted">-</span>'),Ne=c('<div class="flex flex-col items-end"><span class="font-medium text-text"> </span> <span class="text-xs text-text-muted"> </span></div>'),je=c('<span class="text-text-muted">-</span>'),ze=c('<tr><td><a class="block group"><div class="min-w-0"><span class="font-medium text-text group-hover:text-primary transition-colors block truncate"> </span> <span class="text-sm text-text-muted block truncate"> </span></div></a></td><td><div class="flex flex-col gap-1"><!> <!></div></td><td class="text-right"><span class="font-medium text-text"> </span></td><td class="text-right"><!></td><td class="text-right"><!></td><td class="text-right"><!></td></tr>'),Be=c('<div class="text-center py-8 text-text-muted"> </div>'),Te=c('<div class="tab-nav mb-4"></div> <div class="mb-4"><!></div> <div class="data-table"><table class="w-full"><thead><tr><th class="text-left">Campaign</th><th class="text-left">Status</th><th class="text-right">Recipients</th><th class="text-right">Opened</th><th class="text-right">Clicked</th><th class="text-right w-10"></th></tr></thead><tbody></tbody></table></div> <!>',1),Ve=c('<div class="p-6 max-w-6xl mx-auto"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6"><div><h1 class="text-2xl font-semibold text-text">Campaigns</h1> <p class="mt-1 text-sm text-text-muted">Send one-time email campaigns to your lists</p></div> <!></div> <!> <!></div>');function la(J,O){Rt(O,!0);const W=()=>oe(le,"$page",X),[X,Y]=re();let K=q(!0),$=q(Ut([])),y=q(""),S=q(""),Q=q("all"),k=M(()=>`/${W().params.brandSlug}`);const Ct=[{id:"all",label:"All"},{id:"draft",label:"Drafts"},{id:"scheduled",label:"Scheduled"},{id:"sending",label:"Sending"},{id:"sent",label:"Sent"}];let dt=M(()=>()=>{let e=t($);if(t(Q)!=="all"&&(e=e.filter(n=>n.status===t(Q))),t(S)){const n=t(S).toLowerCase();e=e.filter(m=>m.name.toLowerCase().includes(n)||m.subject.toLowerCase().includes(n))}return e}),ct=M(()=>()=>{const e={all:t($).length};for(const n of t($))e[n.status]=(e[n.status]||0)+1;return e});Gt(()=>{vt()});async function vt(){b(K,!0),b(y,"");try{const e=await ne({});b($,e.campaigns||[],!0)}catch(e){console.error("Failed to load campaigns:",e),b(y,"Failed to load campaigns")}finally{b(K,!1)}}async function St(e){if(confirm(`Delete "${e.name}"? This cannot be undone.`))try{await ie({},e.id),await vt()}catch(n){console.error("Failed to delete campaign:",n),b(y,n.message||"Failed to delete campaign",!0)}}function kt(e){switch(e){case"draft":return"default";case"scheduled":return"info";case"sending":return"warning";case"sent":return"success";case"paused":return"error";case"cancelled":return"error";default:return"default"}}function ut(e){return e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""}function Z(e){return e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}var tt=Ve();se("1aozuv7",e=>{Jt(()=>{Wt.title="Campaigns | Outlet"})});var et=r(tt),Dt=d(r(et),2);yt(Dt,{type:"primary",onclick:()=>I(`${t(k)}/campaigns/new`),children:(e,n)=>{var m=we(),w=N(m);wt(w,{class:"mr-2 h-4 w-4"}),nt(),i(e,m)},$$slots:{default:!0}}),s(et);var pt=d(et,2);{var Pt=e=>{ve(e,{type:"error",title:"Error",class:"mb-4",children:(n,m)=>{var w=Ce(),at=r(w,!0);s(w),_(()=>v(at,t(y))),i(n,w)},$$slots:{default:!0}})};g(pt,e=>{t(y)&&e(Pt)})}var Ft=d(pt,2);{var Et=e=>{var n=Se(),m=r(n);_e(m,{size:"large"}),s(n),i(e,n)},Lt=e=>{var n=it(),m=N(n);{var w=D=>{fe(D,{get icon(){return he},title:"No campaigns yet",description:"Create your first campaign to send emails to your subscribers.",children:(R,U)=>{yt(R,{type:"primary",onclick:()=>I(`${t(k)}/campaigns/new`),children:(j,mt)=>{var P=ke(),G=N(P);wt(G,{class:"mr-2 h-4 w-4"}),nt(),i(j,P)},$$slots:{default:!0}})},$$slots:{default:!0}})},at=D=>{var R=Te(),U=N(R);$t(U,21,()=>Ct,bt,(x,a)=>{var p=Pe();p.__click=()=>b(Q,t(a).id,!0);let F;var E=r(p),H=d(E);{var z=B=>{var L=De(),st=r(L,!0);s(L),_(T=>v(st,T),[()=>t(ct)()[t(a).id]]),i(B,L)};g(H,B=>{t(ct)()[t(a).id]&&B(z)})}s(p),_(()=>{F=ee(p,1,"tab-nav-item",null,F,{active:t(Q)===t(a).id}),v(E,`${t(a).label??""} `)}),i(x,p)}),s(U);var j=d(U,2),mt=r(j);ue(mt,{placeholder:"Search campaigns...",get value(){return t(S)},set value(x){b(S,x,!0)}}),s(j);var P=d(j,2),G=r(P),ft=d(r(G));$t(ft,21,()=>t(dt)(),bt,(x,a)=>{var p=ze(),F=r(p),E=r(F),H=r(E),z=r(H),B=r(z,!0);s(z);var L=d(z,2),st=r(L,!0);s(L),s(H),s(E),s(F);var T=d(F),_t=r(T),xt=r(_t);{let o=M(()=>kt(t(a).status));xe(xt,{get variant(){return t(o)},size:"sm",children:(l,u)=>{nt();var f=Yt();_(()=>v(f,t(a).status)),i(l,f)},$$slots:{default:!0}})}var jt=d(xt,2);{var zt=o=>{var l=Fe(),u=r(l,!0);s(l),_(f=>v(u,f),[()=>ut(t(a).scheduled_at)]),i(o,l)},Bt=o=>{var l=it(),u=N(l);{var f=h=>{var C=Ee(),V=r(C,!0);s(C),_(A=>v(V,A),[()=>ut(t(a).completed_at)]),i(h,C)};g(u,h=>{t(a).completed_at&&t(a).status==="sent"&&h(f)},!0)}i(o,l)};g(jt,o=>{t(a).scheduled_at&&t(a).status==="scheduled"?o(zt):o(Bt,!1)})}s(_t),s(T);var rt=d(T),ht=r(rt),Tt=r(ht,!0);s(ht),s(rt);var ot=d(rt),Vt=r(ot);{var At=o=>{var l=Le(),u=r(l),f=r(u,!0);s(u);var h=d(u,2),C=r(h);s(h),s(l),_((V,A)=>{v(f,V),v(C,`${A??""}%`)},[()=>Z(t(a).opened_count),()=>(t(a).opened_count/t(a).sent_count*100).toFixed(1)]),i(o,l)},qt=o=>{var l=Me();i(o,l)};g(Vt,o=>{t(a).sent_count>0?o(At):o(qt,!1)})}s(ot);var lt=d(ot),It=r(lt);{var Ot=o=>{var l=Ne(),u=r(l),f=r(u,!0);s(u);var h=d(u,2),C=r(h);s(h),s(l),_((V,A)=>{v(f,V),v(C,`${A??""}%`)},[()=>Z(t(a).clicked_count),()=>(t(a).clicked_count/t(a).sent_count*100).toFixed(1)]),i(o,l)},Kt=o=>{var l=je();i(o,l)};g(It,o=>{t(a).sent_count>0?o(Ot):o(Kt,!1)})}s(lt);var gt=d(lt),Qt=r(gt);{let o=M(()=>({icon:ge,class:"p-1.5 rounded-lg hover:bg-bg-secondary transition-colors text-text-muted hover:text-text"})),l=M(()=>[{label:"Edit",icon:$e,onclick:()=>I(`${t(k)}/campaigns/${t(a).id}`)},{label:"View stats",icon:ye,onclick:()=>I(`${t(k)}/campaigns/${t(a).id}/stats`)},{label:"Duplicate",icon:me,onclick:()=>I(`${t(k)}/campaigns/new?duplicate=${t(a).id}`)},{divider:!0},{label:"Delete",icon:be,variant:"danger",onclick:()=>St(t(a))}]);pe(Qt,{get trigger(){return t(o)},get items(){return t(l)}})}s(gt),s(p),_(o=>{ae(E,"href",`${t(k)??""}/campaigns/${t(a).id??""}`),v(B,t(a).name),v(st,t(a).subject),v(Tt,o)},[()=>Z(t(a).recipients_count)]),i(x,p)}),s(ft),s(G),s(P);var Mt=d(P,2);{var Nt=x=>{var a=Be(),p=r(a);s(a),_(()=>v(p,`No campaigns match "${t(S)??""}"`)),i(x,a)};g(Mt,x=>{t(S)&&t(dt)().length===0&&x(Nt)})}i(D,R)};g(m,D=>{t($).length===0?D(w):D(at,!1)},!0)}i(e,n)};g(Ft,e=>{t(K)?e(Et):e(Lt,!1)})}s(tt),i(J,tt),Ht(),Y()}Xt(["click"]);export{la as component};
