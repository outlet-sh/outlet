import"../chunks/DsnmJJEf.js";import{p as lt,s as d,a as Se,u as it,i as e,b as a,f as h,d as dt,e as nt,c as o,j as J,h as l,g as mt,r,t as K,n as ne}from"../chunks/odI--4Kw.js";import{d as ct,s as A}from"../chunks/BNMK9zrr.js";import{a as s,f as n,c as V,t as me}from"../chunks/CCInJaqd.js";import{i as $,c as vt}from"../chunks/COaB7F5h.js";import{e as we,i as $e,a as ut}from"../chunks/BohEjZuL.js";import{h as ft}from"../chunks/hUjpWz_l.js";import{s as pt}from"../chunks/DL1yFSKa.js";import"../chunks/DnNGWFqw.js";import{m as _t,n as ht,o as xt,p as gt,q as bt,s as yt}from"../chunks/CbJUEE85.js";import{g as Ae,A as wt,C as Pe,I as ce,B as ve,i as Re}from"../chunks/DDAcQctE.js";import{E as Fe}from"../chunks/BtTFHV7Z.js";import{L as ze}from"../chunks/D716f0vp.js";import{B as Ie}from"../chunks/BD7k7D4N.js";import{M as Me}from"../chunks/DTKoSMkA.js";import{G as Te}from"../chunks/BCoGcWrO.js";import{P as je}from"../chunks/iPsqwY4C.js";import{T as Ue}from"../chunks/BzbtGsEE.js";var $t=n("<p> </p>"),kt=n("<button><!> </button>"),Dt=n("<!> Add",1),Et=n('<h2 class="text-lg font-medium text-text mb-4">Add Email to Suppression List</h2> <div class="flex gap-3"><!> <!> <!></div>',1),Lt=n('<div class="flex justify-center py-12"><!></div>'),Bt=n('<div class="mb-4"><!></div>'),Ct=n('<tr><td class="font-medium text-text"> </td><td class="text-text-muted"> </td><td><!></td><td class="text-text-muted text-sm"> </td><td class="text-right"><!></td></tr>'),St=n('<!> <div class="data-table"><table class="w-full"><thead><tr><th class="text-left">Email</th><th class="text-left">Reason</th><th class="text-left">Source</th><th class="text-left">Added</th><th class="text-right w-10"></th></tr></thead><tbody></tbody></table></div>',1),At=n("<!> <!>",1),Pt=n("<!> Block",1),Rt=n('<h2 class="text-lg font-medium text-text mb-4">Block a Domain</h2> <p class="text-sm text-text-muted mb-4">All emails from blocked domains will be rejected. Use this to block spam or competitor domains.</p> <div class="flex gap-3"><!> <!> <!></div>',1),Ft=n('<div class="flex justify-center py-12"><!></div>'),zt=n('<div class="mb-4"><!></div>'),It=n('<span class="text-text-muted">0</span>'),Mt=n('<tr><td class="font-medium text-text"> </td><td class="text-text-muted"> </td><td><!></td><td class="text-text-muted text-sm"> </td><td class="text-right"><!></td></tr>'),Tt=n('<!> <div class="data-table"><table class="w-full"><thead><tr><th class="text-left">Domain</th><th class="text-left">Reason</th><th class="text-left">Block Attempts</th><th class="text-left">Added</th><th class="text-right w-10"></th></tr></thead><tbody></tbody></table></div>',1),jt=n("<!> <!>",1),Ut=n(`<div class="p-6 max-w-5xl mx-auto"><div class="mb-6"><h1 class="text-2xl font-semibold text-text">Blocklist</h1> <p class="mt-1 text-sm text-text-muted">Manage suppressed emails and blocked domains. Blocked addresses won't receive any emails.</p></div> <!> <div class="border-b border-border mb-6"><nav class="-mb-px flex space-x-8"></nav></div> <!></div> <!> <!>`,1);function ia(Ge,Ne){lt(Ne,!0);const[Gt,qe]=pt();let j=d("emails"),W=d(Se([])),ue=d(!0),X=d(""),U=d(""),Y=d(""),Z=d(!1),ee=d(Se([])),fe=d(!0),te=d(""),G=d(""),ae=d(""),re=d(!1),F=d(""),Oe=J(()=>e(W).filter(t=>t.email.toLowerCase().includes(e(X).toLowerCase())||(t.reason||"").toLowerCase().includes(e(X).toLowerCase()))),He=J(()=>e(ee).filter(t=>t.domain.toLowerCase().includes(e(te).toLowerCase())||(t.reason||"").toLowerCase().includes(e(te).toLowerCase())));it(()=>{e(j)==="emails"?pe():e(j)==="domains"&&_e()});async function pe(){a(ue,!0);try{const t=await _t({});a(W,t.emails||[],!0)}catch(t){console.error("Failed to load suppressed emails:",t)}finally{a(ue,!1)}}async function _e(){a(fe,!0);try{const t=await ht({});a(ee,t.domains||[],!0)}catch(t){console.error("Failed to load blocked domains:",t)}finally{a(fe,!1)}}async function Je(){if(e(U).trim()){a(Z,!0),a(F,"");try{await bt({email:e(U).trim().toLowerCase(),reason:e(Y).trim()||"Manual suppression"}),a(U,""),a(Y,""),await pe()}catch(t){a(F,t.message||"Failed to add email to suppression list",!0)}finally{a(Z,!1)}}}let se=d(!1),oe=d(null);function Ke(t){a(oe,t,!0),a(se,!0)}async function Qe(){if(e(oe))try{await xt({},e(oe).id),await pe()}catch(t){a(F,t.message||"Failed to remove email",!0)}}async function Ve(){if(e(G).trim()){a(re,!0),a(F,"");try{await yt({domain:e(G).trim().toLowerCase(),reason:e(ae).trim()||"Manual block"}),a(G,""),a(ae,""),await _e()}catch(t){a(F,t.message||"Failed to block domain",!0)}finally{a(re,!1)}}}let le=d(!1),ie=d(null);function We(t){a(ie,t,!0),a(le,!0)}async function Xe(){if(e(ie))try{await gt({},e(ie).id),await _e()}catch(t){a(F,t.message||"Failed to unblock domain",!0)}}const Ye=[{id:"emails",label:"Suppressed Emails",icon:Me},{id:"domains",label:"Blocked Domains",icon:Te}];var ke=Ut();ft("1rbsnzh",t=>{nt(()=>{mt.title="Blocklist | Outlet"})});var he=h(ke),De=l(o(he),2);{var Ze=t=>{wt(t,{type:"error",title:"Error",class:"mb-4",children:(c,k)=>{var B=$t(),P=o(B,!0);r(B),K(()=>A(P,e(F))),s(c,B)},$$slots:{default:!0}})};$(De,t=>{e(F)&&t(Ze)})}var xe=l(De,2),Ee=o(xe);we(Ee,21,()=>Ye,$e,(t,c)=>{var k=kt();k.__click=()=>a(j,e(c).id,!0);var B=o(k);vt(B,()=>e(c).icon,(N,x)=>{x(N,{class:"h-4 w-4"})});var P=l(B);r(k),K(()=>{ut(k,1,`whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium flex items-center gap-2 ${e(j)===e(c).id?"border-primary text-primary":"border-transparent text-text-muted hover:border-border hover:text-text"}`),A(P,` ${e(c).label??""}`)}),s(t,k)}),r(Ee),r(xe);var et=l(xe,2);{var tt=t=>{var c=At(),k=h(c);Pe(k,{class:"mb-6",children:(x,R)=>{var z=Et(),q=l(h(z),2),g=o(q);ce(g,{type:"email",placeholder:"email@example.com",class:"flex-1",get value(){return e(U)},set value(b){a(U,b,!0)}});var m=l(g,2);ce(m,{type:"text",placeholder:"Reason (optional)",class:"flex-1",get value(){return e(Y)},set value(b){a(Y,b,!0)}});var D=l(m,2);{let b=J(()=>!e(U).trim()||e(Z));ve(D,{type:"primary",onclick:Je,get disabled(){return e(b)},children:(I,y)=>{var C=V(),w=h(C);{var E=i=>{var f=me("Adding...");s(i,f)},u=i=>{var f=Dt(),L=h(f);je(L,{class:"mr-2 h-4 w-4"}),ne(),s(i,f)};$(w,i=>{e(Z)?i(E):i(u,!1)})}s(I,C)},$$slots:{default:!0}})}r(q),s(x,z)},$$slots:{default:!0}});var B=l(k,2);{var P=x=>{var R=Lt(),z=o(R);ze(z,{}),r(R),s(x,R)},N=x=>{var R=V(),z=h(R);{var q=m=>{Fe(m,{get icon(){return Me},title:"No suppressed emails",message:"Add email addresses that should never receive emails from this brand."})},g=m=>{var D=St(),b=h(D);{var I=E=>{var u=Bt(),i=o(u);Re(i,{placeholder:"Search suppressed emails...",get value(){return e(X)},set value(f){a(X,f,!0)}}),r(u),s(E,u)};$(b,E=>{e(W).length>5&&E(I)})}var y=l(b,2),C=o(y),w=l(o(C));we(w,21,()=>e(Oe),$e,(E,u)=>{var i=Ct(),f=o(i),L=o(f,!0);r(f);var v=l(f),p=o(v,!0);r(v);var _=l(v),Q=o(_);Ie(Q,{variant:"default",size:"sm",children:(T,ye)=>{ne();var H=me();K(()=>A(H,e(u).source)),s(T,H)},$$slots:{default:!0}}),r(_);var M=l(_),ge=o(M,!0);r(M);var O=l(M),be=o(O);ve(be,{type:"ghost",size:"sm",onclick:()=>Ke(e(u)),class:"text-text-muted hover:text-error",children:(T,ye)=>{Ue(T,{class:"h-4 w-4"})},$$slots:{default:!0}}),r(O),r(i),K(T=>{A(L,e(u).email),A(p,e(u).reason||"-"),A(ge,T)},[()=>new Date(e(u).created_at).toLocaleDateString()]),s(E,i)}),r(w),r(C),r(y),s(m,D)};$(z,m=>{e(W).length===0?m(q):m(g,!1)},!0)}s(x,R)};$(B,x=>{e(ue)?x(P):x(N,!1)})}s(t,c)},at=t=>{var c=V(),k=h(c);{var B=P=>{var N=jt(),x=h(N);Pe(x,{class:"mb-6",children:(g,m)=>{var D=Rt(),b=l(h(D),4),I=o(b);ce(I,{type:"text",placeholder:"example.com",class:"flex-1",get value(){return e(G)},set value(w){a(G,w,!0)}});var y=l(I,2);ce(y,{type:"text",placeholder:"Reason (optional)",class:"flex-1",get value(){return e(ae)},set value(w){a(ae,w,!0)}});var C=l(y,2);{let w=J(()=>!e(G).trim()||e(re));ve(C,{type:"primary",onclick:Ve,get disabled(){return e(w)},children:(E,u)=>{var i=V(),f=h(i);{var L=p=>{var _=me("Blocking...");s(p,_)},v=p=>{var _=Pt(),Q=h(_);je(Q,{class:"mr-2 h-4 w-4"}),ne(),s(p,_)};$(f,p=>{e(re)?p(L):p(v,!1)})}s(E,i)},$$slots:{default:!0}})}r(b),s(g,D)},$$slots:{default:!0}});var R=l(x,2);{var z=g=>{var m=Ft(),D=o(m);ze(D,{}),r(m),s(g,m)},q=g=>{var m=V(),D=h(m);{var b=y=>{Fe(y,{get icon(){return Te},title:"No blocked domains",message:"Block domains to prevent all emails from those addresses."})},I=y=>{var C=Tt(),w=h(C);{var E=L=>{var v=zt(),p=o(v);Re(p,{placeholder:"Search blocked domains...",get value(){return e(te)},set value(_){a(te,_,!0)}}),r(v),s(L,v)};$(w,L=>{e(ee).length>5&&L(E)})}var u=l(w,2),i=o(u),f=l(o(i));we(f,21,()=>e(He),$e,(L,v)=>{var p=Mt(),_=o(p),Q=o(_,!0);r(_);var M=l(_),ge=o(M,!0);r(M);var O=l(M),be=o(O);{var T=S=>{Ie(S,{variant:"warning",size:"sm",children:(de,Nt)=>{ne();var Ce=me();K(()=>A(Ce,e(v).block_attempts)),s(de,Ce)},$$slots:{default:!0}})},ye=S=>{var de=It();s(S,de)};$(be,S=>{e(v).block_attempts>0?S(T):S(ye,!1)})}r(O);var H=l(O),st=o(H,!0);r(H);var Be=l(H),ot=o(Be);ve(ot,{type:"ghost",size:"sm",onclick:()=>We(e(v)),class:"text-text-muted hover:text-error",children:(S,de)=>{Ue(S,{class:"h-4 w-4"})},$$slots:{default:!0}}),r(Be),r(p),K(S=>{A(Q,e(v).domain),A(ge,e(v).reason||"-"),A(st,S)},[()=>new Date(e(v).created_at).toLocaleDateString()]),s(L,p)}),r(f),r(i),r(u),s(y,C)};$(D,y=>{e(ee).length===0?y(b):y(I,!1)},!0)}s(g,m)};$(R,g=>{e(fe)?g(z):g(q,!1)})}s(P,N)};$(k,P=>{e(j)==="domains"&&P(B)},!0)}s(t,c)};$(et,t=>{e(j)==="emails"?t(tt):t(at,!1)})}r(he);var Le=l(he,2);{let t=J(()=>`Remove ${e(oe)?.email||""} from the suppression list?`);Ae(Le,{title:"Remove Suppressed Email",get description(){return e(t)},actionLabel:"Remove",actionType:"danger",onAction:Qe,onCancel:()=>a(se,!1),get open(){return e(se)},set open(c){a(se,c,!0)}})}var rt=l(Le,2);{let t=J(()=>`Unblock domain ${e(ie)?.domain||""}?`);Ae(rt,{title:"Unblock Domain",get description(){return e(t)},actionLabel:"Unblock",actionType:"danger",onAction:Xe,onCancel:()=>a(le,!1),get open(){return e(le)},set open(c){a(le,c,!0)}})}s(Ge,ke),dt(),qe()}ct(["click"]);export{ia as component};
