import"../chunks/Bzak7iHL.js";import{p as Rt,d as M,j as Ut,u as Gt,b as g,a as Ht,h as Jt,s as d,c as r,f as O,g as t,e as P,$ as Wt,n as at,r as s,t as _}from"../chunks/Ip2DykXx.js";import{d as Xt,s as v}from"../chunks/DhOIAuLg.js";import{f as c,a as i,c as pt,t as Yt}from"../chunks/BPgbRZ5o.js";import{i as b}from"../chunks/BeCi3WIf.js";import{e as mt,i as _t}from"../chunks/-0-Kn73z.js";import{h as Zt}from"../chunks/vHZS38u2.js";import{a as te,s as ee}from"../chunks/CmyOW3uE.js";import{s as ae,a as se}from"../chunks/ur54L5C-.js";import{p as re}from"../chunks/BUZmhiZ9.js";import{g as V}from"../chunks/CDoCV2GU.js";import{y as le,z as oe}from"../chunks/CtwFYI68.js";import{B as xt,A as ne,S as ie,D as de}from"../chunks/Bphptf_a.js";import{E as ce,a as ve,S as ue}from"../chunks/iYJsf80Y.js";import{L as fe}from"../chunks/sFH_xjRy.js";import{B as pe}from"../chunks/CK6k7lQK.js";import{P as ht}from"../chunks/C0D2ZjIj.js";import{S as me}from"../chunks/Bm5FNAdL.js";import{C as _e}from"../chunks/lw_OzKkh.js";import{C as xe}from"../chunks/C65kbecp.js";import{T as he}from"../chunks/Boqopfmd.js";var be=c("<!> New Campaign",1),ge=c("<p> </p>"),ye=c('<div class="flex justify-center py-12"><!></div>'),$e=c("<!> Create Campaign",1),we=c('<span class="campaigns-tab-count svelte-qafybn"> </span>'),qe=c("<button> <!></button>"),Ce=c('<span class="text-xs text-text-muted"> </span>'),Se=c('<span class="text-xs text-text-muted"> </span>'),ke=c('<div class="flex flex-col items-end"><span class="font-medium text-text"> </span> <span class="text-xs text-text-muted"> </span></div>'),De=c('<span class="text-text-muted">-</span>'),Fe=c('<div class="flex flex-col items-end"><span class="font-medium text-text"> </span> <span class="text-xs text-text-muted"> </span></div>'),Pe=c('<span class="text-text-muted">-</span>'),Le=c('<tr class="svelte-qafybn"><td class="svelte-qafybn"><a class="block group"><div class="min-w-0"><span class="font-medium text-text group-hover:text-primary transition-colors block truncate"> </span> <span class="text-sm text-text-muted block truncate"> </span></div></a></td><td class="svelte-qafybn"><div class="flex flex-col gap-1"><!> <!></div></td><td class="text-right svelte-qafybn"><span class="font-medium text-text"> </span></td><td class="text-right svelte-qafybn"><!></td><td class="text-right svelte-qafybn"><!></td><td class="text-right svelte-qafybn"><!></td></tr>'),je=c('<div class="text-center py-8 text-text-muted"> </div>'),Ee=c('<div class="campaigns-tabs mb-4 svelte-qafybn"></div> <div class="mb-4"><!></div> <div class="campaigns-table svelte-qafybn"><table class="w-full"><thead class="svelte-qafybn"><tr><th class="text-left svelte-qafybn">Campaign</th><th class="text-left svelte-qafybn">Status</th><th class="text-right svelte-qafybn">Recipients</th><th class="text-right svelte-qafybn">Opened</th><th class="text-right svelte-qafybn">Clicked</th><th class="text-right w-10 svelte-qafybn"></th></tr></thead><tbody class="svelte-qafybn"></tbody></table></div> <!>',1),Be=c('<div class="p-6 max-w-6xl mx-auto"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6"><div><h1 class="text-2xl font-semibold text-text">Campaigns</h1> <p class="mt-1 text-sm text-text-muted">Send one-time email campaigns to your lists</p></div> <!></div> <!> <!></div>');function aa(bt,gt){Rt(gt,!0);const yt=()=>se(re,"$page",$t),[$t,wt]=ae();let G=M(!0),L=M(Ut([])),j=M(""),w=M(""),I=M("all"),q=P(()=>`/${yt().params.orgSlug}`);const qt=[{id:"all",label:"All"},{id:"draft",label:"Drafts"},{id:"scheduled",label:"Scheduled"},{id:"sending",label:"Sending"},{id:"sent",label:"Sent"}];let st=P(()=>()=>{let e=t(L);if(t(I)!=="all"&&(e=e.filter(n=>n.status===t(I))),t(w)){const n=t(w).toLowerCase();e=e.filter(p=>p.name.toLowerCase().includes(n)||p.subject.toLowerCase().includes(n))}return e}),rt=P(()=>()=>{const e={all:t(L).length};for(const n of t(L))e[n.status]=(e[n.status]||0)+1;return e});Gt(()=>{lt()});async function lt(){g(G,!0),g(j,"");try{const e=await le({});g(L,e.campaigns||[],!0)}catch(e){console.error("Failed to load campaigns:",e),g(j,"Failed to load campaigns")}finally{g(G,!1)}}async function Ct(e){if(confirm(`Delete "${e.name}"? This cannot be undone.`))try{await oe({},e.id),await lt()}catch(n){console.error("Failed to delete campaign:",n),g(j,n.message||"Failed to delete campaign",!0)}}function St(e){switch(e){case"draft":return"default";case"scheduled":return"info";case"sending":return"warning";case"sent":return"success";case"paused":return"error";case"cancelled":return"error";default:return"default"}}function ot(e){return e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""}function H(e){return e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}var J=Be();Zt("qafybn",e=>{Jt(()=>{Wt.title="Campaigns | Outlet"})});var W=r(J),kt=d(r(W),2);xt(kt,{type:"primary",onclick:()=>V(`${t(q)}/campaigns/new`),children:(e,n)=>{var p=be(),y=O(p);ht(y,{class:"mr-2 h-4 w-4"}),at(),i(e,p)},$$slots:{default:!0}}),s(W);var nt=d(W,2);{var Dt=e=>{ne(e,{type:"error",title:"Error",class:"mb-4",children:(n,p)=>{var y=ge(),X=r(y,!0);s(y),_(()=>v(X,t(j))),i(n,y)},$$slots:{default:!0}})};b(nt,e=>{t(j)&&e(Dt)})}var Ft=d(nt,2);{var Pt=e=>{var n=ye(),p=r(n);fe(p,{size:"large"}),s(n),i(e,n)},Lt=e=>{var n=pt(),p=O(n);{var y=C=>{ce(C,{get icon(){return me},title:"No campaigns yet",description:"Create your first campaign to send emails to your subscribers.",children:(K,Q)=>{xt(K,{type:"primary",onclick:()=>V(`${t(q)}/campaigns/new`),children:(E,it)=>{var S=$e(),R=O(S);ht(R,{class:"mr-2 h-4 w-4"}),at(),i(E,S)},$$slots:{default:!0}})},$$slots:{default:!0}})},X=C=>{var K=Ee(),Q=O(K);mt(Q,21,()=>qt,_t,(x,a)=>{var f=qe();f.__click=()=>g(I,t(a).id,!0);let k;var D=r(f),U=d(D);{var B=N=>{var F=we(),Y=r(F,!0);s(F),_(T=>v(Y,T),[()=>t(rt)()[t(a).id]]),i(N,F)};b(U,N=>{t(rt)()[t(a).id]&&N(B)})}s(f),_(()=>{k=te(f,1,"campaigns-tab svelte-qafybn",null,k,{active:t(I)===t(a).id}),v(D,`${t(a).label??""} `)}),i(x,f)}),s(Q);var E=d(Q,2),it=r(E);ie(it,{placeholder:"Search campaigns...",get value(){return t(w)},set value(x){g(w,x,!0)}}),s(E);var S=d(E,2),R=r(S),dt=d(r(R));mt(dt,21,()=>t(st)(),_t,(x,a)=>{var f=Le(),k=r(f),D=r(k),U=r(D),B=r(U),N=r(B,!0);s(B);var F=d(B,2),Y=r(F,!0);s(F),s(U),s(D),s(k);var T=d(k),ct=r(T),vt=r(ct);{let l=P(()=>St(t(a).status));pe(vt,{get variant(){return t(l)},size:"sm",children:(o,u)=>{at();var m=Yt();_(()=>v(m,t(a).status)),i(o,m)},$$slots:{default:!0}})}var Bt=d(vt,2);{var Nt=l=>{var o=Ce(),u=r(o,!0);s(o),_(m=>v(u,m),[()=>ot(t(a).scheduled_at)]),i(l,o)},Tt=l=>{var o=pt(),u=O(o);{var m=h=>{var $=Se(),z=r($,!0);s($),_(A=>v(z,A),[()=>ot(t(a).completed_at)]),i(h,$)};b(u,h=>{t(a).completed_at&&t(a).status==="sent"&&h(m)},!0)}i(l,o)};b(Bt,l=>{t(a).scheduled_at&&t(a).status==="scheduled"?l(Nt):l(Tt,!1)})}s(ct),s(T);var Z=d(T),ut=r(Z),zt=r(ut,!0);s(ut),s(Z);var tt=d(Z),At=r(tt);{var Mt=l=>{var o=ke(),u=r(o),m=r(u,!0);s(u);var h=d(u,2),$=r(h);s(h),s(o),_((z,A)=>{v(m,z),v($,`${A??""}%`)},[()=>H(t(a).opened_count),()=>(t(a).opened_count/t(a).sent_count*100).toFixed(1)]),i(l,o)},Ot=l=>{var o=De();i(l,o)};b(At,l=>{t(a).sent_count>0?l(Mt):l(Ot,!1)})}s(tt);var et=d(tt),Vt=r(et);{var It=l=>{var o=Fe(),u=r(o),m=r(u,!0);s(u);var h=d(u,2),$=r(h);s(h),s(o),_((z,A)=>{v(m,z),v($,`${A??""}%`)},[()=>H(t(a).clicked_count),()=>(t(a).clicked_count/t(a).sent_count*100).toFixed(1)]),i(l,o)},Kt=l=>{var o=Pe();i(l,o)};b(Vt,l=>{t(a).sent_count>0?l(It):l(Kt,!1)})}s(et);var ft=d(et),Qt=r(ft);{let l=P(()=>({icon:ve,class:"p-1.5 rounded-lg hover:bg-bg-secondary transition-colors text-text-muted hover:text-text"})),o=P(()=>[{label:"Edit",icon:ue,onclick:()=>V(`${t(q)}/campaigns/${t(a).id}`)},{label:"View stats",icon:_e,onclick:()=>V(`${t(q)}/campaigns/${t(a).id}/stats`)},{label:"Duplicate",icon:xe,onclick:()=>V(`${t(q)}/campaigns/new?duplicate=${t(a).id}`)},{divider:!0},{label:"Delete",icon:he,variant:"danger",onclick:()=>Ct(t(a))}]);de(Qt,{get trigger(){return t(l)},get items(){return t(o)}})}s(ft),s(f),_(l=>{ee(D,"href",`${t(q)??""}/campaigns/${t(a).id??""}`),v(N,t(a).name),v(Y,t(a).subject),v(zt,l)},[()=>H(t(a).recipients_count)]),i(x,f)}),s(dt),s(R),s(S);var jt=d(S,2);{var Et=x=>{var a=je(),f=r(a);s(a),_(()=>v(f,`No campaigns match "${t(w)??""}"`)),i(x,a)};b(jt,x=>{t(w)&&t(st)().length===0&&x(Et)})}i(C,K)};b(p,C=>{t(L).length===0?C(y):C(X,!1)},!0)}i(e,n)};b(Ft,e=>{t(G)?e(Pt):e(Lt,!1)})}s(J),i(bt,J),Ht(),wt()}Xt(["click"]);export{aa as component};
