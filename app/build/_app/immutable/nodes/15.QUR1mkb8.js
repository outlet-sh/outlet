import"../chunks/Bzak7iHL.js";import{p as _e,d as g,j as xe,u as he,b as a,f as B,a as ye,h as $e,s as n,c as s,$ as be,n as y,r,g as t,t as N,e as we}from"../chunks/Ip2DykXx.js";import{s as M}from"../chunks/DhOIAuLg.js";import{f as v,a as d,t as q,c as Se}from"../chunks/BPgbRZ5o.js";import{i as E}from"../chunks/BeCi3WIf.js";import{e as ke,i as Ce}from"../chunks/-0-Kn73z.js";import{h as Pe}from"../chunks/vHZS38u2.js";import{g as G}from"../chunks/CDoCV2GU.js";import{b as ze,c as Ie,d as Oe}from"../chunks/CtwFYI68.js";import{B as C,M as Ae,I as D,A as Be,C as Ne}from"../chunks/Bphptf_a.js";import{L as Me}from"../chunks/sFH_xjRy.js";import{B as je}from"../chunks/CK6k7lQK.js";import{P as Y}from"../chunks/C0D2ZjIj.js";import{B as Z}from"../chunks/D2CetaP7.js";import{C as Fe}from"../chunks/rz6TTqSb.js";var Le=v("<!> New Site",1),Ue=v("<p> </p>"),Re=v('<div class="mb-6"><!></div>'),qe=v("<!> New Site",1),Ee=v('<div class="text-center py-12"><!> <h3 class="mt-2 text-sm font-medium text-text">No sites yet</h3> <p class="mt-1 text-sm text-text-muted">Get started by adding your first client site.</p> <div class="mt-6"><!></div></div>'),Ge=v('<div class="flex items-center justify-between w-full"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center"><!></div> <div><div class="flex items-center gap-2"><span class="font-semibold text-text group-hover:text-primary transition-colors"> </span> <!></div></div></div> <!></div>'),De=v('<div class="space-y-3"></div>'),He=v('<div class="flex justify-end gap-3"><!> <!></div>'),Je=v('<div class="space-y-4"><div><label for="org-name" class="form-label">Site Name</label> <!></div> <div><label for="org-slug" class="form-label">Slug</label> <!> <p class="mt-1 text-xs text-text-muted">Used as a unique identifier for API calls</p></div> <div><label for="app-url" class="form-label">App URL</label> <!> <p class="mt-1 text-xs text-text-muted">Base URL of your application for confirmation links</p></div></div>'),Ke=v('<div class="py-6"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="mb-6 flex justify-between items-center"><div><h1 class="text-2xl font-semibold text-text">Sites</h1> <p class="mt-1 text-sm text-text-muted">Manage your client sites</p></div> <!></div> <!> <!></div></div> <!>',1);function dt(ee,te){_e(te,!0);let j=g(!0),F=g(xe([])),b=g("");async function re(e){if(localStorage.setItem("currentOrgId",e.id),localStorage.setItem("currentOrgName",e.name),localStorage.setItem("currentOrgSlug",e.slug),!localStorage.getItem(`orgSetupSkipped_${e.slug}`)&&!e.from_email){G(`/${e.slug}/welcome`);return}G(`/${e.slug}`)}let P=g(!1),w=g(!1),_=g(""),x=g(""),z=g("");he(()=>{ae()});async function ae(){if(!localStorage.getItem("setupSkipped"))try{if(!(await ze()).platform_configured){G("/setup");return}}catch(o){console.error("Failed to check setup status:",o)}H()}async function H(){a(j,!0),a(b,"");try{const e=await Ie();a(F,e.organizations||[],!0)}catch(e){console.error("Failed to load organizations:",e),a(b,"Failed to load organizations")}finally{a(j,!1)}}function J(){a(_,""),a(x,""),a(z,""),a(P,!0)}function K(){a(P,!1)}function se(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function oe(){a(x,se(t(_)),!0)}async function le(){if(!(!t(_)||!t(x))){a(w,!0);try{await Oe({name:t(_),slug:t(x),app_url:t(z)}),K(),await H()}catch(e){console.error("Failed to create organization:",e),a(b,e.message||"Failed to create organization",!0)}finally{a(w,!1)}}}var Q=Ke();Pe("ts7bst",e=>{$e(()=>{be.title="Sites - Outlet"})});var L=B(Q),T=s(L),U=s(T),ie=n(s(U),2);C(ie,{type:"primary",onclick:J,children:(e,o)=>{var p=Le(),u=B(p);Y(u,{class:"mr-2 h-4 w-4"}),y(),d(e,p)},$$slots:{default:!0}}),r(U);var V=n(U,2);{var ne=e=>{var o=Re(),p=s(o);Be(p,{type:"error",title:"Error",children:(u,f)=>{var l=Ue(),i=s(l,!0);r(l),N(()=>M(i,t(b))),d(u,l)},$$slots:{default:!0}}),r(o),d(e,o)};E(V,e=>{t(b)&&e(ne)})}var de=n(V,2);{var ce=e=>{Me(e,{size:"large"})},ue=e=>{var o=Se(),p=B(o);{var u=l=>{Ne(l,{children:(i,h)=>{var c=Ee(),$=s(c);Z($,{class:"mx-auto h-12 w-12 text-text-muted"});var m=n($,6),S=s(m);C(S,{type:"primary",onclick:J,children:(k,I)=>{var O=qe(),A=B(O);Y(A,{class:"mr-2 h-4 w-4"}),y(),d(k,O)},$$slots:{default:!0}}),r(m),r(c),d(i,c)},$$slots:{default:!0}})},f=l=>{var i=De();ke(i,21,()=>t(F),Ce,(h,c)=>{C(h,{type:"ghost",onclick:()=>re(t(c)),class:"w-full text-left bg-bg rounded-lg border border-border hover:border-primary hover:shadow-md transition-all p-4 group",children:($,m)=>{var S=Ge(),k=s(S),I=s(k),O=s(I);Z(O,{class:"w-5 h-5 text-primary"}),r(I);var A=n(I,2),W=s(A),R=s(W),ve=s(R,!0);r(R);var me=n(R,2);je(me,{variant:"default",size:"sm",children:(ge,Qe)=>{y();var X=q();N(()=>M(X,t(c).slug)),d(ge,X)},$$slots:{default:!0}}),r(W),r(A),r(k);var fe=n(k,2);Fe(fe,{class:"w-5 h-5 text-text-muted group-hover:text-primary transition-colors"}),r(S),N(()=>M(ve,t(c).name)),d($,S)},$$slots:{default:!0}})}),r(i),d(l,i)};E(p,l=>{t(F).length===0?l(u):l(f,!1)},!0)}d(e,o)};E(de,e=>{t(j)?e(ce):e(ue,!1)})}r(T),r(L);var pe=n(L,2);Ae(pe,{title:"Add Site",get show(){return t(P)},set show(o){a(P,o,!0)},footer:o=>{var p=He(),u=s(p);C(u,{type:"secondary",onclick:K,get disabled(){return t(w)},children:(l,i)=>{y();var h=q("Cancel");d(l,h)},$$slots:{default:!0}});var f=n(u,2);{let l=we(()=>!t(_)||!t(x)||t(w));C(f,{type:"primary",onclick:le,get disabled(){return t(l)},children:(i,h)=>{y();var c=q();N(()=>M(c,t(w)?"Creating...":"Create")),d(i,c)},$$slots:{default:!0}})}r(p),d(o,p)},children:(o,p)=>{var u=Je(),f=s(u),l=n(s(f),2);D(l,{id:"org-name",type:"text",oninput:oe,placeholder:"Acme Corp",get value(){return t(_)},set value(m){a(_,m,!0)}}),r(f);var i=n(f,2),h=n(s(i),2);D(h,{id:"org-slug",type:"text",placeholder:"acme-corp",get value(){return t(x)},set value(m){a(x,m,!0)}}),y(2),r(i);var c=n(i,2),$=n(s(c),2);D($,{id:"app-url",type:"text",placeholder:"https://yourapp.com",get value(){return t(z)},set value(m){a(z,m,!0)}}),y(2),r(c),r(u),d(o,u)},$$slots:{footer:!0,default:!0}}),d(ee,Q),ye()}export{dt as component};
