function o(){return typeof window>"u"?null:localStorage.getItem("auth_token")}function c(e){typeof window>"u"||localStorage.setItem("auth_token",e)}function u(){typeof window>"u"||localStorage.removeItem("auth_token")}function r(e){try{const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),a=decodeURIComponent(atob(t).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(a)}catch(n){return console.error("Failed to decode token:",n),null}}function s(){const e=o();return e?r(e):null}function l(){const e=o();if(!e)return!1;const n=r(e);if(!n||!n.exp)return!1;const t=Math.floor(Date.now()/1e3);return n.exp>t}function d(){const e=s();return(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="super_admin"}function f(){u(),typeof window<"u"&&(window.location.href="/auth/login")}export{d as a,o as b,r as d,s as g,l as i,f as l,u as r,c as s};
