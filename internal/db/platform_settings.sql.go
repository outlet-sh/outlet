// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: platform_settings.sql

package db

import (
	"context"
	"database/sql"
)

const deletePlatformSetting = `-- name: DeletePlatformSetting :exec
DELETE FROM platform_settings
WHERE key = ?1
`

func (q *Queries) DeletePlatformSetting(ctx context.Context, key string) error {
	_, err := q.db.ExecContext(ctx, deletePlatformSetting, key)
	return err
}

const getPlatformSetting = `-- name: GetPlatformSetting :one
SELECT "key", value_encrypted, value_text, description, category, is_sensitive, created_at, updated_at FROM platform_settings
WHERE key = ?1
LIMIT 1
`

func (q *Queries) GetPlatformSetting(ctx context.Context, key string) (PlatformSetting, error) {
	row := q.db.QueryRowContext(ctx, getPlatformSetting, key)
	var i PlatformSetting
	err := row.Scan(
		&i.Key,
		&i.ValueEncrypted,
		&i.ValueText,
		&i.Description,
		&i.Category,
		&i.IsSensitive,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getPlatformSettingValue = `-- name: GetPlatformSettingValue :one
SELECT key, value_encrypted, value_text, is_sensitive
FROM platform_settings
WHERE key = ?1
LIMIT 1
`

type GetPlatformSettingValueRow struct {
	Key            string         `json:"key"`
	ValueEncrypted sql.NullString `json:"value_encrypted"`
	ValueText      sql.NullString `json:"value_text"`
	IsSensitive    sql.NullInt64  `json:"is_sensitive"`
}

func (q *Queries) GetPlatformSettingValue(ctx context.Context, key string) (GetPlatformSettingValueRow, error) {
	row := q.db.QueryRowContext(ctx, getPlatformSettingValue, key)
	var i GetPlatformSettingValueRow
	err := row.Scan(
		&i.Key,
		&i.ValueEncrypted,
		&i.ValueText,
		&i.IsSensitive,
	)
	return i, err
}

const getPlatformSettingsByCategory = `-- name: GetPlatformSettingsByCategory :many
SELECT "key", value_encrypted, value_text, description, category, is_sensitive, created_at, updated_at FROM platform_settings
WHERE category = ?1
ORDER BY key
`

func (q *Queries) GetPlatformSettingsByCategory(ctx context.Context, category string) ([]PlatformSetting, error) {
	rows, err := q.db.QueryContext(ctx, getPlatformSettingsByCategory, category)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []PlatformSetting
	for rows.Next() {
		var i PlatformSetting
		if err := rows.Scan(
			&i.Key,
			&i.ValueEncrypted,
			&i.ValueText,
			&i.Description,
			&i.Category,
			&i.IsSensitive,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getPlatformSettingsValues = `-- name: GetPlatformSettingsValues :many
SELECT key, value_encrypted, value_text, is_sensitive
FROM platform_settings
WHERE category = ?1
ORDER BY key
`

type GetPlatformSettingsValuesRow struct {
	Key            string         `json:"key"`
	ValueEncrypted sql.NullString `json:"value_encrypted"`
	ValueText      sql.NullString `json:"value_text"`
	IsSensitive    sql.NullInt64  `json:"is_sensitive"`
}

func (q *Queries) GetPlatformSettingsValues(ctx context.Context, category string) ([]GetPlatformSettingsValuesRow, error) {
	rows, err := q.db.QueryContext(ctx, getPlatformSettingsValues, category)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetPlatformSettingsValuesRow
	for rows.Next() {
		var i GetPlatformSettingsValuesRow
		if err := rows.Scan(
			&i.Key,
			&i.ValueEncrypted,
			&i.ValueText,
			&i.IsSensitive,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listPlatformSettings = `-- name: ListPlatformSettings :many
SELECT "key", value_encrypted, value_text, description, category, is_sensitive, created_at, updated_at FROM platform_settings
ORDER BY category, key
`

func (q *Queries) ListPlatformSettings(ctx context.Context) ([]PlatformSetting, error) {
	rows, err := q.db.QueryContext(ctx, listPlatformSettings)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []PlatformSetting
	for rows.Next() {
		var i PlatformSetting
		if err := rows.Scan(
			&i.Key,
			&i.ValueEncrypted,
			&i.ValueText,
			&i.Description,
			&i.Category,
			&i.IsSensitive,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const upsertPlatformSetting = `-- name: UpsertPlatformSetting :one
INSERT INTO platform_settings (key, value_encrypted, value_text, description, category, is_sensitive, created_at, updated_at)
VALUES (?1, ?2, ?3, ?4, ?5, ?6, datetime('now'), datetime('now'))
ON CONFLICT (key) DO UPDATE SET
    value_encrypted = CASE WHEN excluded.value_encrypted IS NOT NULL THEN excluded.value_encrypted ELSE platform_settings.value_encrypted END,
    value_text = CASE WHEN excluded.value_text IS NOT NULL THEN excluded.value_text ELSE platform_settings.value_text END,
    description = COALESCE(excluded.description, platform_settings.description),
    updated_at = datetime('now')
RETURNING "key", value_encrypted, value_text, description, category, is_sensitive, created_at, updated_at
`

type UpsertPlatformSettingParams struct {
	Key            string         `json:"key"`
	ValueEncrypted sql.NullString `json:"value_encrypted"`
	ValueText      sql.NullString `json:"value_text"`
	Description    sql.NullString `json:"description"`
	Category       string         `json:"category"`
	IsSensitive    sql.NullInt64  `json:"is_sensitive"`
}

func (q *Queries) UpsertPlatformSetting(ctx context.Context, arg UpsertPlatformSettingParams) (PlatformSetting, error) {
	row := q.db.QueryRowContext(ctx, upsertPlatformSetting,
		arg.Key,
		arg.ValueEncrypted,
		arg.ValueText,
		arg.Description,
		arg.Category,
		arg.IsSensitive,
	)
	var i PlatformSetting
	err := row.Scan(
		&i.Key,
		&i.ValueEncrypted,
		&i.ValueText,
		&i.Description,
		&i.Category,
		&i.IsSensitive,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}
